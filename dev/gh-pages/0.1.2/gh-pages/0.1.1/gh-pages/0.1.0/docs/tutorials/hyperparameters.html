<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="generator" content="Publish.jl" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="keywords" content="" />
    <title>FluxTraining.jl</title>
    <link rel="stylesheet" href="..&#x2F;..&#x2F;normalize.css" />
    <link rel="stylesheet" href="..&#x2F;..&#x2F;tabulator_simple.min.css" />
    <link rel="stylesheet" href="..&#x2F;..&#x2F;lorenzo.css" />
    <script src="..&#x2F;..&#x2F;versions.js"></script>
    <script src="..&#x2F;..&#x2F;lunr.js"></script>
    <script src="..&#x2F;..&#x2F;highlight.min.js"></script>
    <script src="..&#x2F;..&#x2F;tabulator.min.js"></script>
    <script src="..&#x2F;..&#x2F;julia.min.js"></script>
    <script src="..&#x2F;..&#x2F;julia-repl.min.js"></script>
    <script src="..&#x2F;..&#x2F;publish.js"></script>
    
<link href="https://fonts.googleapis.com/css2?family=Source+Serif+Pro&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Lora:wght@700&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Lora:wght@500&display=swap" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Lora:ital@1&family=Source+Sans+Pro:wght@700&display=swap" rel="stylesheet">
    <!-- 
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css" integrity="sha384-AfEj0r4/OFrOo5t7NnNe46zW/tFgW6x/bCJG8FqQCEo3+Aro6EYUG4+cU+KJWu/X" crossorigin="anonymous">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.js" integrity="sha384-g7c+Jr9ZivxKLnZTDUhnkOnsh30B4H0rpLUpJ4jAIKs4fnJI+sEnkvrMWph2EDg4" crossorigin="anonymous"></script>
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/contrib/auto-render.min.js" integrity="sha384-mll67QQFJfxn0IYznZYonOWZ644AWYC+Pt2cHqMaRhXVrursRwvLnLaebdGIlYNa" crossorigin="anonymous"
        onload="renderMathInElement(document.body);"></script>
        -->

</head>
<body>
    <div class="menu">
        <svg id="menu-toggler" title="Contents" onclick="toggleIndexPage();" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M2 6C2 5.44772 2.44772 5 3 5H21C21.5523 5 22 5.44772 22 6C22 6.55228 21.5523 7 21 7H3C2.44772 7 2 6.55228 2 6Z" fill="currentColor" /><path d="M2 12.0322C2 11.4799 2.44772 11.0322 3 11.0322H21C21.5523 11.0322 22 11.4799 22 12.0322C22 12.5845 21.5523 13.0322 21 13.0322H3C2.44772 13.0322 2 12.5845 2 12.0322Z" fill="currentColor" /><path d="M3 17.0645C2.44772 17.0645 2 17.5122 2 18.0645C2 18.6167 2.44772 19.0645 3 19.0645H21C21.5523 19.0645 22 18.6167 22 18.0645C22 17.5122 21.5523 17.0645 21 17.0645H3Z" fill="currentColor" /></svg>
        <input id="search-input" placeholder="Search">
        <select id="version-selector"></select>
    </div>
    <main id="page"><article><h1 id="hyperparameter-scheduling"><a href="#hyperparameter-scheduling" class="anchor"></a>Hyperparameter scheduling</h1>
<p>When training neural networks, you often have to tune hyperparameters.</p>
<p>In <em>FluxTraining.jl</em> the following definition is used:</p>
<blockquote>
<p><em>A hyperparameter is any state that influences the training and is not a parameter of the model.</em></p>
</blockquote>
<p>Common hyperparameters to worry about are the learning rate, batch size and regularization strength.</p>
<p>In recent years, it has also become common practice to schedule some hyperparameters. The cyclical learning rate schedule introduced in <a href="https://arxiv.org/abs/1506.01186">L. Smith 2015</a>, for example, changes the learning rate every step to speed up convergence.</p>
<p><em>FluxTraining.jl</em> provides an extensible interface for hyperparameter scheduling that is not restricted to optimizer hyperparameters as in many other training frameworks. To use it, you have to create a <a href="../../docstrings/FluxTraining.Scheduler.html"><code>Scheduler</code></a>, a callback that can be passed to a <a href="../../docstrings/FluxTraining.Learner.html"><code>Learner</code></a>.</p>
<p><code>Scheduler</code>’s constructor takes pairs of hyperparameter types and associated schedules.</p>
<p>As an example</p>
<ul>
<li><a href="../../docstrings/FluxTraining.LearningRate.html"><code>LearningRate</code></a> is a hyperparameter type representing the optimizer’s step size; and</li>
<li><code>schedule = Schedule([0, 10], [0.01, 0.001])</code> represents a linear scheduling over 10 epochs from <code>0.01</code> to <code>0.001</code></li>
</ul>
<p>We can create the callback scheduling the learning rate according to <code>Scheduler(LearningRate =&gt; schedule)</code>.</p>
<p><code>Schedule</code>s are built around <a href="https://jkrumbiegel.github.io/Animations.jl/dev/"><em>Animations.jl</em></a>. See that package’s documentation or <a href="../../docstrings/FluxTraining.Schedule.html"><code>Schedule</code></a>’s for more details on how to construct them.</p>
<h3 id="one-cycle-learning-rate"><a href="#one-cycle-learning-rate" class="anchor"></a>One-cycle learning rate</h3>
<p>Let’s define a <code>Schedule</code> that follows the above-mentioned cyclical learning rate schedule.</p>
<p>The idea is to start with a small learning rate, gradually increase it, and then slowly decrease it again.</p>
<p>For example, we could start with a learning rate of 0.01, increase it to 0.1 over 3 epochs, and then down to 0.001 over 7 epochs. Let’s also use cosine annealing, a common practice that makes sure the values are interpolated more smoothly.</p>
<p>In code, that looks like this:</p>
<pre><code class="language-julia">using Animations: sineio  # for cosine annealing

schedule = Schedule(
    [0, 3, 10],          # the time steps (in epochs)
    [0.01, 0.1, 0.001],  # the valus at the time steps
    sineio(),            # the annealing function
)

learner = model(model, data, opt, lossfn, Scheduler(LearningRate =&gt; schedule))
</code></pre>
<p>For convenience, you can also use the <a href="../../docstrings/FluxTraining.onecycle.html"><code>onecycle</code></a> helper to create this <code>Schedule</code>.</p>
<h2 id="extending"><a href="#extending" class="anchor"></a>Extending</h2>
<p>You can create and schedule your own hyperparameters.</p>
<p>To do this, you will need to define</p>
<ul>
<li>a type for your hyperparameter, e.g. <code>abstract type MyParam &lt;: HyperParameter end</code>,</li>
<li>how to set the hyperparameter by implementing <a href="../../docstrings/FluxTraining.sethyperparameter!.html"><code>sethyperparameter!</code></a><code>(learner, ::Type{MyParam}, value)</code></li>
<li>what state needs to be accessed to set the hyperparameter by implementing <a href="../../docstrings/FluxTraining.stateaccess.html"><code>stateaccess</code></a><code>(::Type{MyParam})</code>. See <a href="../callbacks/custom.html">custom callbacks</a> for more info on why this is needed.</li>
</ul>
<div class="admonition info"><p class="admonition-title">Kinds of hyperparameters</p>
<p>Hyperparameters don’t need to belong to the optimizer! For example, you could create a hyperparameter for batch size. That is not implemented here because this package is agnostic of the data iterators and the implementation would differ for every type of iterator.</p>
</div></article>
        <div id="page-navigation">
            <a id="previous-page" title="Previous" href="mnist.html"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M16.2426 6.34317L14.8284 4.92896L7.75739 12L14.8285 19.0711L16.2427 17.6569L10.5858 12L16.2426 6.34317Z" fill="currentColor" /></svg></a>
            <a id="next-page" title="Next" href="..&#x2F;status.html"><svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M10.5858 6.34317L12 4.92896L19.0711 12L12 19.0711L10.5858 17.6569L16.2427 12L10.5858 6.34317Z" fill="currentColor" /></svg></a>
        </div>
    </main>
    <nav id="toc"><p><a href="../../README.html">README</a></p>
<h3 id="start-here"><a href="../../#start-here" class="anchor"></a>Start here</h3>
<ul>
<li><a href="../../docs/getting_started.html">Getting started</a></li>
<li><a href="../../docs/overview.html">User guide</a></li>
<li><a href="../../docs/features.html">Features</a></li>
</ul>
<h3 id="library"><a href="../../#library" class="anchor"></a>Library</h3>
<ul>
<li><a href="../../docs/training/basics.html">Training loop</a></li>
<li>Callbacks
<ul>
<li><a href="../../docs/callbacks/usage.html">Using callbacks</a></li>
<li><a href="../../docs/callbacks/reference.html">Callback reference</a></li>
<li><a href="../../docs/callbacks/custom.html">Custom callbacks</a></li>
<li><a href="../../docs/callbacks/tipstricks.html">Tips &amp; tricks</a></li>
</ul>
</li>
<li><a href="../../docstrings.html">Docstrings</a></li>
</ul>
<h3 id="tutorials"><a href="../../#tutorials" class="anchor"></a>Tutorials</h3>
<ul>
<li><a href="../../docs/tutorials/mnist.html">MNIST training</a></li>
<li><a href="../../docs/tutorials/hyperparameters.html">Hyperparameter scheduling</a></li>
</ul>
<h3 id="other"><a href="../../#other" class="anchor"></a>Other</h3>
<ul>
<li><a href="../../docs/status.html">Project status</a></li>
<li><a href="../../docs/ecosystem.html">Ecosystem</a></li>
</ul>
</nav>
    <footer>
        Built with <a target="_blank" href="https://github.com/MichaelHatherly/Publish.jl">Publish.jl</a> and the <a target="_blank" href="https://julialang.org">Julia Language.</a>
    </footer>
    <script>hljs.initHighlightingOnLoad();</script>
</body>
</html>
