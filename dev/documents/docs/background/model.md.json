{"attributes":{"backlinks":[{"tag":"document","title":"Data iterators","docid":"documents/docs/background/dataiterator.md"},{"tag":"document","title":"Loss functions","docid":"documents/docs/background/lossfunction.md"},{"tag":"document","title":"Optimizers","docid":"documents/docs/background/optimizer.md"},{"tag":"document","title":"Getting started","docid":"documents/docs/getting_started.md"}],"path":"/home/runner/.julia/packages/FluxTraining/LFydD/docs/background/model.md","title":"Models"},"tag":"document","children":[{"attributes":{},"tag":"h1","children":[{"mimes":{"text/plain":"Models"}}]},{"attributes":{},"tag":"p","children":[{"mimes":{"text/plain":"FluxTraining"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":"jl works with all "}},{"attributes":{"href":"https://github.com/FluxML/Flux.jl","title":""},"tag":"a","children":[{"mimes":{"text/plain":"Flux"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":"jl"}}]},{"mimes":{"text/plain":"-"}},{"mimes":{"text/plain":"compatible models"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":" Unless you are using a "}},{"attributes":{"reftype":"document","href":"/documents/docs/tutorials/training.md","title":"","document_id":"documents/docs/tutorials/training.md"},"tag":"reference","children":[{"mimes":{"text/plain":"custom training loop"}}]},{"mimes":{"text/plain":", a "}},{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"model"}}]},{"mimes":{"text/plain":" is expected to take a single input "}},{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"xs"}}]},{"mimes":{"text/plain":", which corresponds to the encoded inputs returned by your "}},{"attributes":{"reftype":"document","href":"/documents/docs/background/dataiterator.md","title":"","document_id":"documents/docs/background/dataiterator.md"},"tag":"reference","children":[{"mimes":{"text/plain":"data iterator"}}]},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":" This means the following has to work:"}}]},{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_tuple","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"xs"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"ys"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"= "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"first"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"dataiter"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")\n"}}]}]}]}]},{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"ŷs"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"= "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"model"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"xs"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")"}}]}]}]}]}]},{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"code","children":[{"mimes":{"text/plain":"model"}}]},{"mimes":{"text/plain":" also has to be differentiable"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":" If you"}},{"mimes":{"text/plain":"’"}},{"mimes":{"text/plain":"re composing Flux"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":"jl layers, this is likely the case"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":" You can always make sure by testing:"}}]},{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_using","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_KEYWORD","children":[{"mimes":{"text/plain":"using"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"Flux"}}]}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"Zygote"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":"\n\n"}}]}]}]}]}]},{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_tuple","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"xs"}}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"ys"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"= "}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"first"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"dataiter"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")\n"}}]}]}]}]},{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"lossfn"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"= "}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"Flux"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"."}}]},{"attributes":{},"tag":"CST_quotenode","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"mse"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":"\n"}}]}]}]}]}]}]},{"attributes":{},"tag":"CST_DEFINITION","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"grads"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":" "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"= "}}]},{"attributes":{},"tag":"CST_do","children":[{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"Zygote"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"."}}]},{"attributes":{},"tag":"CST_quotenode","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"gradient"}}]}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"Flux"}}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"mimes":{"text/plain":"."}}]},{"attributes":{},"tag":"CST_quotenode","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"params"}}]}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"model"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")"}}]}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":") "}}]}]},{"attributes":{},"tag":"CST_span","children":[{"attributes":{},"tag":"CST_KEYWORD","children":[{"mimes":{"text/plain":"do"}}]},{"attributes":{},"tag":"CST_whitespace","children":[{"mimes":{"text/plain":"\n    "}}]}]},{"attributes":{},"tag":"CST_OPERATOR","children":[{"attributes":{},"tag":"CST_tuple","children":[{"mimes":{"text/plain":""}}]},{"attributes":{},"tag":"CST_block","children":[{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"lossfn"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_call","children":[{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"model"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":"("}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"xs"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")"}}]}]},{"attributes":{},"tag":"CST_PUNCTUATION","children":[{"mimes":{"text/plain":", "}}]},{"attributes":{},"tag":"CST_IDENTIFIER","children":[{"mimes":{"text/plain":"ys"}}]},{"attributes":{},"tag":"CST_BRACKET","children":[{"mimes":{"text/plain":")\n"}}]}]}]}]},{"attributes":{},"tag":"CST_KEYWORD","children":[{"mimes":{"text/plain":"end"}}]}]}]}]}]},{"attributes":{},"tag":"h2","children":[{"mimes":{"text/plain":"Creating models"}}]},{"attributes":{},"tag":"p","children":[{"mimes":{"text/plain":"The simplest way to create a Flux"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":"jl"}},{"mimes":{"text/plain":"-"}},{"mimes":{"text/plain":"compatible model is to use layers from Flux"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":"jl"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":""}},{"attributes":{},"tag":"br","children":[]},{"mimes":{"text/plain":"A good entrypoint is "}},{"attributes":{"href":"https://fluxml.ai/Flux.jl/stable/models/basics/","title":""},"tag":"a","children":[{"mimes":{"text/plain":"this tutorial"}}]},{"mimes":{"text/plain":"in Flux"}},{"mimes":{"text/plain":"’"}},{"mimes":{"text/plain":"s documentation"}},{"mimes":{"text/plain":"."}}]},{"attributes":{},"tag":"p","children":[{"mimes":{"text/plain":"There is also a large number of packages that provide complete model architectures or domain"}},{"mimes":{"text/plain":"-"}},{"mimes":{"text/plain":"specific layers"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":" Below is a non"}},{"mimes":{"text/plain":"-"}},{"mimes":{"text/plain":"exhaustive list:"}}]},{"attributes":{},"tag":"ul","children":[{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{"href":"https://github.com/FluxML/Metalhead.jl","title":""},"tag":"a","children":[{"mimes":{"text/plain":"Metalhead"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":"jl"}}]},{"mimes":{"text/plain":" implements common model architectures for computer vision,"}}]}]},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{"href":"https://github.com/CarloLucibello/GraphNeuralNetworks.jl","title":""},"tag":"a","children":[{"mimes":{"text/plain":"GraphNeuralNetworks"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":"jl"}}]},{"mimes":{"text/plain":" provides layers and utilities for graph neural networks,"}}]}]},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":[{"attributes":{"href":"https://github.com/chengchingwen/Transformers.jl","title":""},"tag":"a","children":[{"mimes":{"text/plain":"Transformers"}},{"mimes":{"text/plain":"."}},{"mimes":{"text/plain":"jl"}}]},{"mimes":{"text/plain":" implements transformer models including pretrained language models"}}]}]}]}]}