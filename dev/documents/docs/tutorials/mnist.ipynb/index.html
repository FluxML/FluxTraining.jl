<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <!--     <link rel="icon" href="/favicon.png" /> -->
    <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta http-equiv="content-security-policy" content=""><title>FluxTraining.jl</title>
	<link rel="stylesheet" href="/FluxTraining.jl/internal/assets/pages/__layout.svelte-5b348943.css">
	<link rel="stylesheet" href="/FluxTraining.jl/internal/assets/documentloader-c3b38c78.css">
	<link rel="modulepreload" href="/FluxTraining.jl/internal/start-af5d4ead.js">
	<link rel="modulepreload" href="/FluxTraining.jl/internal/chunks/vendor-82c3ebfd.js">
	<link rel="modulepreload" href="/FluxTraining.jl/internal/chunks/paths-4b3c6e7e.js">
	<link rel="modulepreload" href="/FluxTraining.jl/internal/pages/__layout.svelte-4bac7188.js">
	<link rel="modulepreload" href="/FluxTraining.jl/internal/pages/_version_/_...documentId_.svelte-7aaa8049.js">
	<link rel="modulepreload" href="/FluxTraining.jl/internal/chunks/documentloader-1ca571c2.js">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fira+Mono:wght@400;500&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;600&display=swap');
    </style>
</head>

<body>
    <div id="svelte">




<div class="flex lg:flex-row flex-col lg:sticky lg:h-full"><div class="gutter">



<div class="header border-gray-200 flex flex-col w-full border-b-[1px] lg:sticky lg:top-0 lg:w-72 lg:[min-width:18rem;] lg:max-h-screen lg:min-h-screen lg:h-screen lg:border-b-0 lg:border-r-[1px]"><div class="title flex flex-row items-center p-3"><span class="name content-center text-xl flex-grow font-bold"><a href="/FluxTraining.jl/dev/documents/README.md">FluxTraining.jl</a></span>
		<span class="openmenu cursor-pointer flex lg:hidden">
<svg data-carbon-icon="Menu24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24" preserveAspectRatio="xMidYMid meet" aria-hidden focusable="false"><path d="M3 18H21V19.5H3zM3 13.5H21V15H3zM3 9H21V10.5H3zM3 4.5H21V6H3z"></path>
    
  </svg></span></div>

	<div class="menu p-3 flex-col hidden [box-shadow:inset_0_0_8px_rgba(0,0,0,.1)] border-t-[1px] lg:flex lg:[box-shadow:none] lg:border-t-0 "><div class="group svelte-1spyzn"><div class="grouptitle svelte-1spyzn">Search</div>
			<div class="searchwidget svelte-1lm1fh6" style="width: 100%; flex-grow: 3">
	<div class="searchfield svelte-1lm1fh6">
<svg data-carbon-icon="Search20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" fill="currentColor" width="20" height="20" preserveAspectRatio="xMidYMid meet" style="fill:gray; display:inline" aria-hidden focusable="false"><path d="M29,27.5859l-7.5521-7.5521a11.0177,11.0177,0,1,0-1.4141,1.4141L27.5859,29ZM4,13a9,9,0,1,1,9,9A9.01,9.01,0,0,1,4,13Z"></path>
    
  </svg>
		<input type="text" placeholder="Search for text or code" style="margin-left: 4px; flex-grow: 2; outline:none; background: inherit;" class="svelte-1lm1fh6" value="">

			
			</div>
	
</div></div>

		<div class="group svelte-1spyzn"><div class="grouptitle svelte-1spyzn">Pages</div>
			<div class="ml-1 mr-1"><div class=""><a class="link svelte-1uqp1tf" href="/FluxTraining.jl/dev/documents/README.md">Overview</a></div><div class=""><a class="link svelte-1uqp1tf" href="/FluxTraining.jl/dev/documents/docs/getting_started.md">Getting started</a></div><div class=""><a class="link svelte-1uqp1tf" href="/FluxTraining.jl/dev/documents/docs/features.md">Features</a></div><div class="groupcontainer svelte-1uqp1tf"><div class="groupname svelte-1uqp1tf">
<svg data-carbon-icon="CaretDownGlyph" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 4" fill="currentColor" width="8" height="4" preserveAspectRatio="xMidYMid meet" style="display:inline; width: 8px" aria-hidden focusable="false"><path d="M8 0L4 4 0 0z"></path>
    
  </svg>
					<span class="pl-1">Tutorials</span></div>
				<div class="group svelte-1uqp1tf"><div class=""><a class="link svelte-1uqp1tf" href="/FluxTraining.jl/dev/documents/docs/tutorials/mnist.ipynb">Train an image classifier</a></div><div class=""><a class="link svelte-1uqp1tf" href="/FluxTraining.jl/dev/documents/docs/callbacks/custom.md">Write a custom callback</a></div>
					</div>
			</div><div class="groupcontainer svelte-1uqp1tf"><div class="groupname svelte-1uqp1tf">
<svg data-carbon-icon="CaretDownGlyph" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 4" fill="currentColor" width="8" height="4" preserveAspectRatio="xMidYMid meet" style="display:inline; width: 8px" aria-hidden focusable="false"><path d="M8 0L4 4 0 0z"></path>
    
  </svg>
					<span class="pl-1">How to</span></div>
				<div class="group svelte-1uqp1tf"><div class=""><a class="link svelte-1uqp1tf" href="/FluxTraining.jl/dev/documents/docs/callbacks/usage.md">Use callbacks</a></div><div class=""><a class="link svelte-1uqp1tf" href="/FluxTraining.jl/dev/documents/docs/callbacks/tipstricks.md">Tips &amp; Tricks</a></div>
					</div>
			</div><div class="groupcontainer svelte-1uqp1tf"><div class="groupname svelte-1uqp1tf">
<svg data-carbon-icon="CaretDownGlyph" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 4" fill="currentColor" width="8" height="4" preserveAspectRatio="xMidYMid meet" style="display:inline; width: 8px" aria-hidden focusable="false"><path d="M8 0L4 4 0 0z"></path>
    
  </svg>
					<span class="pl-1">Reference</span></div>
				<div class="group svelte-1uqp1tf"><div class=""><a class="link svelte-1uqp1tf" href="/FluxTraining.jl/dev/references/FluxTraining">Module</a></div><div class=""><a class="link svelte-1uqp1tf" href="/FluxTraining.jl/dev/documents/docs/callbacks/reference.md">List of callbacks</a></div><div class=""><a class="link svelte-1uqp1tf" href="/FluxTraining.jl/dev/documents/docs/reference/training.md">Training loop API</a></div>
					</div>
			</div><div class="groupcontainer svelte-1uqp1tf"><div class="groupname svelte-1uqp1tf">
<svg data-carbon-icon="CaretDownGlyph" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 4" fill="currentColor" width="8" height="4" preserveAspectRatio="xMidYMid meet" style="display:inline; width: 8px" aria-hidden focusable="false"><path d="M8 0L4 4 0 0z"></path>
    
  </svg>
					<span class="pl-1">Backround</span></div>
				<div class="group svelte-1uqp1tf"><div class=""><a class="link svelte-1uqp1tf" href="/FluxTraining.jl/dev/documents/docs/tutorials/hyperparameters.md">Hyperparameter scheduling</a></div><div class=""><a class="link svelte-1uqp1tf" href="/FluxTraining.jl/dev/documents/docs/tutorials/training.md">Custom training loops</a></div>
					</div>
			</div></div></div>

		
		

		
		<div class="flex-col hidden md:flex group svelte-1spyzn"><div class="grouptitle svelte-1spyzn">This page</div>
				<a class="linktointeractive svelte-1spyzn" href="/FluxTraining.jl/dev/i?id=documents/docs/tutorials/mnist.ipynb">Open in interactive viewer</a></div>
		<div class="group svelte-1spyzn"><div class="grouptitle svelte-1spyzn">Links</div>
			<a href="https://github.com/FluxML/FluxTraining.jl" class="text-gray-600 hover:text-gray-900">
<svg data-carbon-icon="LogoGithub24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" fill="currentColor" width="24" height="24" preserveAspectRatio="xMidYMid meet" aria-hidden focusable="false"><path fill-rule="evenodd" d="M16,2a14,14,0,0,0-4.43,27.28c.7.13,1-.3,1-.67s0-1.21,0-2.38c-3.89.84-4.71-1.88-4.71-1.88A3.71,3.71,0,0,0,6.24,22.3c-1.27-.86.1-.85.1-.85A2.94,2.94,0,0,1,8.48,22.9a3,3,0,0,0,4.08,1.16,2.93,2.93,0,0,1,.88-1.87c-3.1-.36-6.37-1.56-6.37-6.92a5.4,5.4,0,0,1,1.44-3.76,5,5,0,0,1,.14-3.7s1.17-.38,3.85,1.43a13.3,13.3,0,0,1,7,0c2.67-1.81,3.84-1.43,3.84-1.43a5,5,0,0,1,.14,3.7,5.4,5.4,0,0,1,1.44,3.76c0,5.38-3.27,6.56-6.39,6.91a3.33,3.33,0,0,1,.95,2.59c0,1.87,0,3.38,0,3.84s.25.81,1,.67A14,14,0,0,0,16,2Z"></path>
    
  </svg></a></div></div>
</div></div>
		<div class="content h-max p-4 sm:w-full md:max-w-2xl"><div class="document document"><div class="markdown">
			<span class="jupyter ">
			<div class="md ">
			<h1 class="">
			Training an image classifier</h1></div>
			<div class="md ">
			<p class="">
			Let’s put 
			<em class="">
			FluxTraining
			.
			jl</em>
			 to train a model on the MNIST dataset.</p>
			<p class="">
			MNIST is simple enough that we can focus on the part where 
			<em class="">
			FluxTraining
			.
			jl</em>
			 comes in, the training. If you want to see examples of using FluxTraining.jl on larger datasets, see the documentation of 
			<span class="linkexternal"><a href="https://github.com/FluxML/FastAI.jl" class="svelte-1jfpqr">
			FastAI
			.
			jl
		
<svg data-carbon-icon="Link16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" fill="currentColor" width="16" height="16" preserveAspectRatio="xMidYMid meet" style="display:inline; transform: translate(-1px,-2px)" aria-hidden focusable="false"><path d="M29.25,6.76a6,6,0,0,0-8.5,0l1.42,1.42a4,4,0,1,1,5.67,5.67l-8,8a4,4,0,1,1-5.67-5.66l1.41-1.42-1.41-1.42-1.42,1.42a6,6,0,0,0,0,8.5A6,6,0,0,0,17,25a6,6,0,0,0,4.27-1.76l8-8A6,6,0,0,0,29.25,6.76Z"></path><path d="M4.19,24.82a4,4,0,0,1,0-5.67l8-8a4,4,0,0,1,5.67,0A3.94,3.94,0,0,1,19,14a4,4,0,0,1-1.17,2.85L15.71,19l1.42,1.42,2.12-2.12a6,6,0,0,0-8.51-8.51l-8,8a6,6,0,0,0,0,8.51A6,6,0,0,0,7,28a6.07,6.07,0,0,0,4.28-1.76L9.86,24.82A4,4,0,0,1,4.19,24.82Z"></path>
    
  </svg></a>
</span>
			.</p></div>
			<div class="md ">
			<h2 class="">
			Setup</h2></div>
			<div class="md ">
			<p class="">
			<em class="">
			If you want to run this tutorial yourself, you can find the notebook file 
			<span class="linkexternal"><a href="https://github.com/lorenzoh/FluxTraining.jl/blob/master/docs/tutorials/mnist.ipynb" class="svelte-1jfpqr">
			here
		
<svg data-carbon-icon="Link16" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" fill="currentColor" width="16" height="16" preserveAspectRatio="xMidYMid meet" style="display:inline; transform: translate(-1px,-2px)" aria-hidden focusable="false"><path d="M29.25,6.76a6,6,0,0,0-8.5,0l1.42,1.42a4,4,0,1,1,5.67,5.67l-8,8a4,4,0,1,1-5.67-5.66l1.41-1.42-1.41-1.42-1.42,1.42a6,6,0,0,0,0,8.5A6,6,0,0,0,17,25a6,6,0,0,0,4.27-1.76l8-8A6,6,0,0,0,29.25,6.76Z"></path><path d="M4.19,24.82a4,4,0,0,1,0-5.67l8-8a4,4,0,0,1,5.67,0A3.94,3.94,0,0,1,19,14a4,4,0,0,1-1.17,2.85L15.71,19l1.42,1.42,2.12-2.12a6,6,0,0,0-8.51-8.51l-8,8a6,6,0,0,0,0,8.51A6,6,0,0,0,7,28a6.07,6.07,0,0,0,4.28-1.76L9.86,24.82A4,4,0,0,1,4.19,24.82Z"></path>
    
  </svg></a>
</span></em>
			.</p></div>
			<div class="md ">
			<p class="">
			To make data loading and batching a bit easier, we’ll install some additional dependencies:</p></div>
			<div class="md ">
			<pre class="codeblock codeblock svelte-vj8ryq"><code class="svelte-vj8ryq">
			<span class="julia ">
			<span class="TOPLEVEL ">
			<span class="USING ">
			<span class="USING ">
			using</span>
			<span class="DOT ">
			<span class="WHITESPACE ">
			 </span>
			<span class="IDENTIFIER ">
			Pkg</span></span></span>
			<span class="SEMICOLON ">
			;</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="CALL ">
			<span class="DOT ">
			<span class="IDENTIFIER ">
			Pkg</span>
			<span class="DOT ">
			.</span>
			<span class="QUOTE ">
			<span class="IDENTIFIER ">
			add</span></span></span>
			<span class="LPAREN ">
			(</span>
			<span class="VECT ">
			<span class="LSQUARE ">
			[</span>
			<span class="DQUOTE ">
			&quot;</span>
			<span class="STRING ">
			MLDataPattern</span>
			<span class="DQUOTE ">
			&quot;</span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="DQUOTE ">
			&quot;</span>
			<span class="STRING ">
			DataLoaders</span>
			<span class="DQUOTE ">
			&quot;</span>
			<span class="RSQUARE ">
			]</span></span>
			<span class="RPAREN ">
			)</span></span></span></span></code></pre></div>
			<div class="md ">
			<p class="">
			Now we can import everything we’ll need.</p></div>
			<div class="codecell ">
			<div class="codeinput ">
			<pre class="codeblock codeblock svelte-vj8ryq"><code class="svelte-vj8ryq">
			<span class="julia ">
			<span class="USING ">
			<span class="COLON ">
			<span class="USING ">
			using</span>
			<span class="DOT ">
			<span class="WHITESPACE ">
			 </span>
			<span class="IDENTIFIER ">
			DataLoaders</span></span>
			<span class="COLON ">
			:</span>
			<span class="DOT ">
			<span class="WHITESPACE ">
			 </span>
			<span class="IDENTIFIER ">
			DataLoader</span></span></span></span>
			<span class="NEWLINE_WS ">
			
</span>
			<span class="USING ">
			<span class="COLON ">
			<span class="USING ">
			using</span>
			<span class="DOT ">
			<span class="WHITESPACE ">
			 </span>
			<span class="IDENTIFIER ">
			MLDataPattern</span></span>
			<span class="COLON ">
			:</span>
			<span class="DOT ">
			<span class="WHITESPACE ">
			 </span>
			<span class="IDENTIFIER ">
			splitobs</span></span></span></span>
			<span class="NEWLINE_WS ">
			
</span>
			<span class="USING ">
			<span class="USING ">
			using</span>
			<span class="DOT ">
			<span class="WHITESPACE ">
			 </span>
			<span class="IDENTIFIER ">
			Flux</span></span></span>
			<span class="NEWLINE_WS ">
			
</span>
			<span class="USING ">
			<span class="USING ">
			using</span>
			<span class="DOT ">
			<span class="WHITESPACE ">
			 </span>
			


<a href="/FluxTraining.jl/dev/references/FluxTraining" class="reference symbol ">
			FluxTraining</a>
	</span></span></span></code></pre></div></div>
			<div class="md ">
			<h2 class="">
			Overview</h2></div>
			<div class="md ">
			<p class="">
			There are 4 pieces that you always need to construct and train a 
			


<a href="/FluxTraining.jl/dev/references/FluxTraining.Learner" class="reference symbol ">
			<span class="code"><code class="codeinline ">
			Learner</code></span></a>
	
			:</p>
			<ul class="">
			<li class="">
			<p class="">
			a model</p></li>
			<li class="">
			<p class="">
			data</p></li>
			<li class="">
			<p class="">
			an optimizer; and</p></li>
			<li class="">
			<p class="">
			a loss function</p></li></ul></div>
			<div class="md ">
			<h2 class="">
			Building a 
			<span class="code"><code class="codeinline ">
			Learner</code></span></h2></div>
			<div class="md ">
			<p class="">
			Let’s look at the 
			<strong class="">
			data</strong>
			 first.</p>
			<p class="">
			<em class="">
			FluxTraining
			.
			jl</em>
			 is agnostic of the data source. The only requirements are:</p>
			<ul class="">
			<li class="">
			<p class="">
			it is iterable and each iteration returns a tuple 
			<span class="code"><code class="codeinline ">
			(xs, ys)</code></span></p></li>
			<li class="">
			<p class="">
			the model can take in 
			<span class="code"><code class="codeinline ">
			xs</code></span>
			, i.e. 
			<span class="code"><code class="codeinline ">
			model(xs)</code></span>
			 works; and</p></li>
			<li class="">
			<p class="">
			the loss function can take model outputs and 
			<span class="code"><code class="codeinline ">
			ys</code></span>
			, i.e. 
			<span class="code"><code class="codeinline ">
			lossfn(model(xs), ys)</code></span>
			 returns a scalar</p></li></ul></div>
			<div class="md ">
			<p class="">
			Glossing over the details as it’s not the focus of this tutorial, here’s the code for getting a data iterator of the MNIST dataset. We use 
			<span class="code"><code class="codeinline ">
			DataLoaders.DataLoader</code></span>
			 to create an iterator of batches from our dataset.</p></div>
			<div class="codecell ">
			<div class="codeinput ">
			<pre class="codeblock codeblock svelte-vj8ryq"><code class="svelte-vj8ryq">
			<span class="julia ">
			<span class="EQ ">
			<span class="TUPLE ">
			<span class="IDENTIFIER ">
			xs</span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="IDENTIFIER ">
			ys</span></span>
			<span class="WHITESPACE ">
			 </span>
			<span class="EQ ">
			=</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="TUPLE ">
			<span class="LPAREN ">
			(</span>
			<span class="NEWLINE_WS ">
			
    </span>
			<span class="COMMENT ">
			# convert each image into h*w*1 array of floats </span>
			<span class="NEWLINE_WS ">
			
    </span>
			<span class="COMPREHENSION ">
			<span class="LSQUARE ">
			[</span>
			<span class="GENERATOR ">
			<span class="DOT ">
			<span class="IDENTIFIER ">
			Float32</span>
			<span class="DOT ">
			.</span>
			<span class="TUPLE ">
			<span class="LPAREN ">
			(</span>
			<span class="CALL ">
			<span class="IDENTIFIER ">
			reshape</span>
			<span class="LPAREN ">
			(</span>
			<span class="IDENTIFIER ">
			img</span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="INTEGER ">
			28</span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="INTEGER ">
			28</span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="INTEGER ">
			1</span>
			<span class="RPAREN ">
			)</span></span>
			<span class="RPAREN ">
			)</span></span></span>
			<span class="WHITESPACE ">
			 </span>
			<span class="FOR ">
			for</span>
			<span class="EQ ">
			<span class="WHITESPACE ">
			 </span>
			<span class="IDENTIFIER ">
			img</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="IN ">
			in</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="CALL ">
			<span class="DOT ">
			<span class="DOT ">
			<span class="DOT ">
			<span class="IDENTIFIER ">
			Flux</span>
			<span class="DOT ">
			.</span>
			<span class="QUOTE ">
			<span class="IDENTIFIER ">
			Data</span></span></span>
			<span class="DOT ">
			.</span>
			<span class="QUOTE ">
			<span class="IDENTIFIER ">
			MNIST</span></span></span>
			<span class="DOT ">
			.</span>
			<span class="QUOTE ">
			<span class="IDENTIFIER ">
			images</span></span></span>
			<span class="LPAREN ">
			(</span>
			<span class="RPAREN ">
			)</span></span></span></span>
			<span class="RSQUARE ">
			]</span></span>
			<span class="COMMA ">
			,</span>
			<span class="NEWLINE_WS ">
			
    </span>
			<span class="COMMENT ">
			# one-hot encode the labels</span>
			<span class="NEWLINE_WS ">
			
    </span>
			<span class="COMPREHENSION ">
			<span class="LSQUARE ">
			[</span>
			<span class="GENERATOR ">
			<span class="DOT ">
			<span class="IDENTIFIER ">
			Float32</span>
			<span class="DOT ">
			.</span>
			<span class="TUPLE ">
			<span class="LPAREN ">
			(</span>
			<span class="CALL ">
			<span class="DOT ">
			<span class="IDENTIFIER ">
			Flux</span>
			<span class="DOT ">
			.</span>
			<span class="QUOTE ">
			<span class="IDENTIFIER ">
			onehot</span></span></span>
			<span class="LPAREN ">
			(</span>
			<span class="IDENTIFIER ">
			y</span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="CALL ">
			<span class="INTEGER ">
			0</span>
			<span class="COLON ">
			:</span>
			<span class="INTEGER ">
			9</span></span>
			<span class="RPAREN ">
			)</span></span>
			<span class="RPAREN ">
			)</span></span></span>
			<span class="WHITESPACE ">
			 </span>
			<span class="FOR ">
			for</span>
			<span class="EQ ">
			<span class="WHITESPACE ">
			 </span>
			<span class="IDENTIFIER ">
			y</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="IN ">
			in</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="CALL ">
			<span class="DOT ">
			<span class="DOT ">
			<span class="DOT ">
			<span class="IDENTIFIER ">
			Flux</span>
			<span class="DOT ">
			.</span>
			<span class="QUOTE ">
			<span class="IDENTIFIER ">
			Data</span></span></span>
			<span class="DOT ">
			.</span>
			<span class="QUOTE ">
			<span class="IDENTIFIER ">
			MNIST</span></span></span>
			<span class="DOT ">
			.</span>
			<span class="QUOTE ">
			<span class="IDENTIFIER ">
			labels</span></span></span>
			<span class="LPAREN ">
			(</span>
			<span class="RPAREN ">
			)</span></span></span></span>
			<span class="RSQUARE ">
			]</span></span>
			<span class="COMMA ">
			,</span>
			<span class="NEWLINE_WS ">
			
</span>
			<span class="RPAREN ">
			)</span></span></span>
			<span class="NEWLINE_WS ">
			
</span>
			<span class="NEWLINE_WS ">
			
</span>
			<span class="COMMENT ">
			# split into training and validation sets</span>
			<span class="NEWLINE_WS ">
			
</span>
			<span class="EQ ">
			<span class="TUPLE ">
			<span class="IDENTIFIER ">
			traindata</span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="IDENTIFIER ">
			valdata</span></span>
			<span class="WHITESPACE ">
			 </span>
			<span class="EQ ">
			=</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="CALL ">
			<span class="IDENTIFIER ">
			splitobs</span>
			<span class="LPAREN ">
			(</span>
			<span class="TUPLE ">
			<span class="LPAREN ">
			(</span>
			<span class="IDENTIFIER ">
			xs</span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="IDENTIFIER ">
			ys</span>
			<span class="RPAREN ">
			)</span></span>
			<span class="RPAREN ">
			)</span></span></span>
			<span class="TOPLEVEL ">
			<span class="NEWLINE_WS ">
			
</span>
			<span class="NEWLINE_WS ">
			
</span>
			<span class="COMMENT ">
			# create iterators</span>
			<span class="NEWLINE_WS ">
			
</span>
			<span class="EQ ">
			<span class="TUPLE ">
			<span class="IDENTIFIER ">
			trainiter</span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="IDENTIFIER ">
			valiter</span></span>
			<span class="WHITESPACE ">
			 </span>
			<span class="EQ ">
			=</span>
			<span class="TUPLE ">
			<span class="WHITESPACE ">
			 </span>
			<span class="CALL ">
			<span class="IDENTIFIER ">
			DataLoader</span>
			<span class="LPAREN ">
			(</span>
			<span class="IDENTIFIER ">
			traindata</span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="INTEGER ">
			128</span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="KW ">
			<span class="IDENTIFIER ">
			buffered</span>
			<span class="EQ ">
			=</span>
			<span class="FALSE ">
			false</span></span>
			<span class="RPAREN ">
			)</span></span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="CALL ">
			<span class="IDENTIFIER ">
			DataLoader</span>
			<span class="LPAREN ">
			(</span>
			<span class="IDENTIFIER ">
			valdata</span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="INTEGER ">
			256</span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="KW ">
			<span class="IDENTIFIER ">
			buffered</span>
			<span class="EQ ">
			=</span>
			<span class="FALSE ">
			false</span></span>
			<span class="RPAREN ">
			)</span></span></span></span>
			<span class="SEMICOLON ">
			;</span></span></span></code></pre></div></div>
			<div class="md ">
			<p class="">
			Next, let’s create a simple 
			<em class="">
			Flux
			.
			jl</em>
			 
			<strong class="">
			model</strong>
			 that we’ll train to classify the MNIST digits.</p></div>
			<div class="codecell ">
			<div class="codeinput ">
			<pre class="codeblock codeblock svelte-vj8ryq"><code class="svelte-vj8ryq">
			<span class="julia ">
			<span class="EQ ">
			<span class="IDENTIFIER ">
			model</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="EQ ">
			=</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="CALL ">
			<span class="IDENTIFIER ">
			Chain</span>
			<span class="LPAREN ">
			(</span>
			<span class="NEWLINE_WS ">
			
    </span>
			<span class="CALL ">
			<span class="IDENTIFIER ">
			Conv</span>
			<span class="LPAREN ">
			(</span>
			<span class="TUPLE ">
			<span class="LPAREN ">
			(</span>
			<span class="INTEGER ">
			3</span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="INTEGER ">
			3</span>
			<span class="RPAREN ">
			)</span></span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="CALL ">
			<span class="INTEGER ">
			1</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="PAIR_ARROW ">
			=&gt;</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="INTEGER ">
			16</span></span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="IDENTIFIER ">
			relu</span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="KW ">
			<span class="IDENTIFIER ">
			pad</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="EQ ">
			=</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="INTEGER ">
			1</span></span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="KW ">
			<span class="IDENTIFIER ">
			stride</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="EQ ">
			=</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="INTEGER ">
			2</span></span>
			<span class="RPAREN ">
			)</span></span>
			<span class="COMMA ">
			,</span>
			<span class="NEWLINE_WS ">
			
    </span>
			<span class="CALL ">
			<span class="IDENTIFIER ">
			Conv</span>
			<span class="LPAREN ">
			(</span>
			<span class="TUPLE ">
			<span class="LPAREN ">
			(</span>
			<span class="INTEGER ">
			3</span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="INTEGER ">
			3</span>
			<span class="RPAREN ">
			)</span></span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="CALL ">
			<span class="INTEGER ">
			16</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="PAIR_ARROW ">
			=&gt;</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="INTEGER ">
			32</span></span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="IDENTIFIER ">
			relu</span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="KW ">
			<span class="IDENTIFIER ">
			pad</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="EQ ">
			=</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="INTEGER ">
			1</span></span>
			<span class="RPAREN ">
			)</span></span>
			<span class="COMMA ">
			,</span>
			<span class="NEWLINE_WS ">
			
    </span>
			<span class="CALL ">
			<span class="IDENTIFIER ">
			GlobalMeanPool</span>
			<span class="LPAREN ">
			(</span>
			<span class="RPAREN ">
			)</span></span>
			<span class="COMMA ">
			,</span>
			<span class="NEWLINE_WS ">
			
    </span>
			<span class="DOT ">
			<span class="IDENTIFIER ">
			Flux</span>
			<span class="DOT ">
			.</span>
			<span class="QUOTE ">
			<span class="IDENTIFIER ">
			flatten</span></span></span>
			<span class="COMMA ">
			,</span>
			<span class="NEWLINE_WS ">
			
    </span>
			<span class="CALL ">
			<span class="IDENTIFIER ">
			Dense</span>
			<span class="LPAREN ">
			(</span>
			<span class="INTEGER ">
			32</span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="INTEGER ">
			10</span>
			<span class="RPAREN ">
			)</span></span>
			<span class="COMMA ">
			,</span>
			<span class="NEWLINE_WS ">
			
</span>
			<span class="RPAREN ">
			)</span></span></span></span></code></pre></div>
			<div class="coderesult ">
			<pre class="codeblock codeblock svelte-vj8ryq"><code class="svelte-vj8ryq">
			<!-- HTML_TAG_START -->Chain(Conv((3, 3), 1=&gt;16, relu), Conv((3, 3), 16=&gt;32, relu), GlobalMeanPool(), flatten, Dense(32, 10))<!-- HTML_TAG_END --></code></pre></div></div>
			<div class="md ">
			<p class="">
			We’ll use 
			<em class="">
			categorical cross entropy</em>
			 as a 
			<strong class="">
			loss function</strong>
			 and 
			<em class="">
			ADAM</em>
			 as an 
			<strong class="">
			optimizer</strong>
			.</p></div>
			<div class="codecell ">
			<div class="codeinput ">
			<pre class="codeblock codeblock svelte-vj8ryq"><code class="svelte-vj8ryq">
			<span class="julia ">
			<span class="EQ ">
			<span class="IDENTIFIER ">
			lossfn</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="EQ ">
			=</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="DOT ">
			<span class="DOT ">
			<span class="IDENTIFIER ">
			Flux</span>
			<span class="DOT ">
			.</span>
			<span class="QUOTE ">
			<span class="IDENTIFIER ">
			Losses</span></span></span>
			<span class="DOT ">
			.</span>
			<span class="QUOTE ">
			<span class="IDENTIFIER ">
			logitcrossentropy</span></span></span></span>
			<span class="TOPLEVEL ">
			<span class="NEWLINE_WS ">
			
</span>
			<span class="EQ ">
			<span class="IDENTIFIER ">
			optimizer</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="EQ ">
			=</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="CALL ">
			<span class="DOT ">
			<span class="IDENTIFIER ">
			Flux</span>
			<span class="DOT ">
			.</span>
			<span class="QUOTE ">
			<span class="IDENTIFIER ">
			ADAM</span></span></span>
			<span class="LPAREN ">
			(</span>
			<span class="RPAREN ">
			)</span></span></span>
			<span class="SEMICOLON ">
			;</span></span></span></code></pre></div></div>
			<div class="md ">
			<p class="">
			Now we’re ready to create a 
			


<a href="/FluxTraining.jl/dev/references/FluxTraining.Learner" class="reference symbol ">
			<span class="code"><code class="codeinline ">
			Learner</code></span></a>
	
			. At this point you can also add any callbacks, like 
			


<a href="/FluxTraining.jl/dev/references/FluxTraining.ToGPU" class="reference symbol ">
			<span class="code"><code class="codeinline ">
			ToGPU</code></span></a>
	
			 to run the training on your GPU if you have one available. Some callbacks are also 
			


<a href="/FluxTraining.jl/dev/documents/docs/callbacks/reference.md" class="reference document ">
			included by default</a>
	
			.</p>
			<p class="">
			Since we’re classifying digits, we also use the 
			


<a href="/FluxTraining.jl/dev/references/FluxTraining.Metrics" class="reference symbol ">
			<span class="code"><code class="codeinline ">
			Metrics</code></span></a>
	
			 callback to track the accuracy of the model’s predictions:</p></div>
			<div class="codecell ">
			<div class="codeinput ">
			<pre class="codeblock codeblock svelte-vj8ryq"><code class="svelte-vj8ryq">
			<span class="julia ">
			<span class="EQ ">
			<span class="IDENTIFIER ">
			learner</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="EQ ">
			=</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="CALL ">
			


<a href="/FluxTraining.jl/dev/references/FluxTraining.Learner" class="reference symbol ">
			Learner</a>
	
			<span class="LPAREN ">
			(</span>
			<span class="IDENTIFIER ">
			model</span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="IDENTIFIER ">
			lossfn</span>
			<span class="PARAMETERS ">
			<span class="SEMICOLON ">
			;</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="KW ">
			<span class="IDENTIFIER ">
			callbacks</span>
			<span class="EQ ">
			=</span>
			<span class="VECT ">
			<span class="LSQUARE ">
			[</span>
			<span class="CALL ">
			


<a href="/FluxTraining.jl/dev/references/FluxTraining.Metrics" class="reference symbol ">
			Metrics</a>
	
			<span class="LPAREN ">
			(</span>
			


<a href="/FluxTraining.jl/dev/references/FluxTraining.accuracy" class="reference symbol ">
			accuracy</a>
	
			<span class="RPAREN ">
			)</span></span>
			<span class="RSQUARE ">
			]</span></span></span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="IDENTIFIER ">
			optimizer</span>
			<span class="RPAREN ">
			)</span></span></span></span></span></code></pre></div>
			<div class="coderesult ">
			<pre class="codeblock codeblock svelte-vj8ryq"><code class="svelte-vj8ryq">
			<!-- HTML_TAG_START -->Learner()<!-- HTML_TAG_END --></code></pre></div></div>
			<div class="md ">
			<h2 class="">
			Training</h2></div>
			<div class="md ">
			<p class="">
			With a 
			<span class="code"><code class="codeinline ">
			Learner</code></span>
			 inplace, training is as simple as calling 
			


<a href="/FluxTraining.jl/dev/references/FluxTraining.fit!" class="reference symbol ">
			<span class="code"><code class="codeinline ">
			fit!</code></span></a>
	
			<span class="code"><code class="codeinline ">
			(learner, nepochs, dataiters)</code></span>
			.</p></div>
			<div class="codecell ">
			<div class="codeinput ">
			<pre class="codeblock codeblock svelte-vj8ryq"><code class="svelte-vj8ryq">
			<span class="julia ">
			<span class="CALL ">
			<span class="DOT ">
			


<a href="/FluxTraining.jl/dev/references/FluxTraining" class="reference symbol ">
			FluxTraining</a>
	
			<span class="DOT ">
			.</span>
			<span class="QUOTE ">
			


<a href="/FluxTraining.jl/dev/references/FluxTraining.fit!" class="reference symbol ">
			fit!</a>
	</span></span>
			<span class="LPAREN ">
			(</span>
			<span class="IDENTIFIER ">
			learner</span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="INTEGER ">
			10</span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="TUPLE ">
			<span class="LPAREN ">
			(</span>
			<span class="IDENTIFIER ">
			trainiter</span>
			<span class="COMMA ">
			,</span>
			<span class="WHITESPACE ">
			 </span>
			<span class="IDENTIFIER ">
			validiter</span>
			<span class="RPAREN ">
			)</span></span>
			<span class="RPAREN ">
			)</span></span></span></code></pre></div>
			<div class="codeoutput ">
			<pre class="codeblock codeblock svelte-vj8ryq"><code class="svelte-vj8ryq">
			<!-- HTML_TAG_START --><span class="sgr32">Epoch 1 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:46</span>
┌───────────────┬───────┬─────────┬──────────┐
│<span class="sgr1">         Phase </span>│<span class="sgr1"> Epoch </span>│<span class="sgr1">    Loss </span>│<span class="sgr1"> Accuracy </span>│
├───────────────┼───────┼─────────┼──────────┤
│ TrainingPhase │   1.0 │ 2.04939 │  0.25204 │
└───────────────┴───────┴─────────┴──────────┘
<span class="sgr32">Epoch 1 ValidationPhase(): 100%|████████████████████████| Time: 0:00:02</span>
┌─────────────────┬───────┬─────────┬──────────┐
│<span class="sgr1">           Phase </span>│<span class="sgr1"> Epoch </span>│<span class="sgr1">    Loss </span>│<span class="sgr1"> Accuracy </span>│
├─────────────────┼───────┼─────────┼──────────┤
│ ValidationPhase │   1.0 │ 1.70353 │   0.3821 │
└─────────────────┴───────┴─────────┴──────────┘
<span class="sgr32">Epoch 2 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:19</span>
┌───────────────┬───────┬─────────┬──────────┐
│<span class="sgr1">         Phase </span>│<span class="sgr1"> Epoch </span>│<span class="sgr1">    Loss </span>│<span class="sgr1"> Accuracy </span>│
├───────────────┼───────┼─────────┼──────────┤
│ TrainingPhase │   2.0 │ 1.58615 │  0.44849 │
└───────────────┴───────┴─────────┴──────────┘
<span class="sgr32">Epoch 2 ValidationPhase(): 100%|████████████████████████| Time: 0:00:02</span>
┌─────────────────┬───────┬─────────┬──────────┐
│<span class="sgr1">           Phase </span>│<span class="sgr1"> Epoch </span>│<span class="sgr1">    Loss </span>│<span class="sgr1"> Accuracy </span>│
├─────────────────┼───────┼─────────┼──────────┤
│ ValidationPhase │   2.0 │ 1.44792 │  0.50544 │
└─────────────────┴───────┴─────────┴──────────┘
<span class="sgr32">Epoch 3 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:18</span>
┌───────────────┬───────┬─────────┬──────────┐
│<span class="sgr1">         Phase </span>│<span class="sgr1"> Epoch </span>│<span class="sgr1">    Loss </span>│<span class="sgr1"> Accuracy </span>│
├───────────────┼───────┼─────────┼──────────┤
│ TrainingPhase │   3.0 │ 1.36495 │  0.57273 │
└───────────────┴───────┴─────────┴──────────┘
<span class="sgr32">Epoch 3 ValidationPhase(): 100%|████████████████████████| Time: 0:00:02</span>
┌─────────────────┬───────┬─────────┬──────────┐
│<span class="sgr1">           Phase </span>│<span class="sgr1"> Epoch </span>│<span class="sgr1">    Loss </span>│<span class="sgr1"> Accuracy </span>│
├─────────────────┼───────┼─────────┼──────────┤
│ ValidationPhase │   3.0 │ 1.25941 │  0.59525 │
└─────────────────┴───────┴─────────┴──────────┘
<span class="sgr32">Epoch 4 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:20</span>
┌───────────────┬───────┬─────────┬──────────┐
│<span class="sgr1">         Phase </span>│<span class="sgr1"> Epoch </span>│<span class="sgr1">    Loss </span>│<span class="sgr1"> Accuracy </span>│
├───────────────┼───────┼─────────┼──────────┤
│ TrainingPhase │   4.0 │ 1.18935 │  0.64891 │
└───────────────┴───────┴─────────┴──────────┘
<span class="sgr32">Epoch 4 ValidationPhase(): 100%|████████████████████████| Time: 0:00:02</span>
┌─────────────────┬───────┬────────┬──────────┐
│<span class="sgr1">           Phase </span>│<span class="sgr1"> Epoch </span>│<span class="sgr1">   Loss </span>│<span class="sgr1"> Accuracy </span>│
├─────────────────┼───────┼────────┼──────────┤
│ ValidationPhase │   4.0 │ 1.1076 │  0.66347 │
└─────────────────┴───────┴────────┴──────────┘
<span class="sgr32">Epoch 5 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:19</span>
┌───────────────┬───────┬─────────┬──────────┐
│<span class="sgr1">         Phase </span>│<span class="sgr1"> Epoch </span>│<span class="sgr1">    Loss </span>│<span class="sgr1"> Accuracy </span>│
├───────────────┼───────┼─────────┼──────────┤
│ TrainingPhase │   5.0 │ 1.05506 │  0.69386 │
└───────────────┴───────┴─────────┴──────────┘
<span class="sgr32">Epoch 5 ValidationPhase(): 100%|████████████████████████| Time: 0:00:02</span>
┌─────────────────┬───────┬─────────┬──────────┐
│<span class="sgr1">           Phase </span>│<span class="sgr1"> Epoch </span>│<span class="sgr1">    Loss </span>│<span class="sgr1"> Accuracy </span>│
├─────────────────┼───────┼─────────┼──────────┤
│ ValidationPhase │   5.0 │ 0.99203 │  0.70275 │
└─────────────────┴───────┴─────────┴──────────┘
<span class="sgr32">Epoch 6 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:18</span>
┌───────────────┬───────┬─────────┬──────────┐
│<span class="sgr1">         Phase </span>│<span class="sgr1"> Epoch </span>│<span class="sgr1">    Loss </span>│<span class="sgr1"> Accuracy </span>│
├───────────────┼───────┼─────────┼──────────┤
│ TrainingPhase │   6.0 │ 0.95282 │  0.72533 │
└───────────────┴───────┴─────────┴──────────┘
<span class="sgr32">Epoch 6 ValidationPhase(): 100%|████████████████████████| Time: 0:00:02</span>
┌─────────────────┬───────┬─────────┬──────────┐
│<span class="sgr1">           Phase </span>│<span class="sgr1"> Epoch </span>│<span class="sgr1">    Loss </span>│<span class="sgr1"> Accuracy </span>│
├─────────────────┼───────┼─────────┼──────────┤
│ ValidationPhase │   6.0 │ 0.90209 │  0.73058 │
└─────────────────┴───────┴─────────┴──────────┘
<span class="sgr32">Epoch 7 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:19</span>
┌───────────────┬───────┬─────────┬──────────┐
│<span class="sgr1">         Phase </span>│<span class="sgr1"> Epoch </span>│<span class="sgr1">    Loss </span>│<span class="sgr1"> Accuracy </span>│
├───────────────┼───────┼─────────┼──────────┤
│ TrainingPhase │   7.0 │ 0.87621 │  0.74563 │
└───────────────┴───────┴─────────┴──────────┘
<span class="sgr32">Epoch 7 ValidationPhase(): 100%|████████████████████████| Time: 0:00:02</span>
┌─────────────────┬───────┬─────────┬──────────┐
│<span class="sgr1">           Phase </span>│<span class="sgr1"> Epoch </span>│<span class="sgr1">    Loss </span>│<span class="sgr1"> Accuracy </span>│
├─────────────────┼───────┼─────────┼──────────┤
│ ValidationPhase │   7.0 │ 0.83402 │  0.74781 │
└─────────────────┴───────┴─────────┴──────────┘
<span class="sgr32">Epoch 8 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:18</span>
┌───────────────┬───────┬─────────┬──────────┐
│<span class="sgr1">         Phase </span>│<span class="sgr1"> Epoch </span>│<span class="sgr1">    Loss </span>│<span class="sgr1"> Accuracy </span>│
├───────────────┼───────┼─────────┼──────────┤
│ TrainingPhase │   8.0 │ 0.81399 │  0.76282 │
└───────────────┴───────┴─────────┴──────────┘
<span class="sgr32">Epoch 8 ValidationPhase(): 100%|████████████████████████| Time: 0:00:02</span>
┌─────────────────┬───────┬─────────┬──────────┐
│<span class="sgr1">           Phase </span>│<span class="sgr1"> Epoch </span>│<span class="sgr1">    Loss </span>│<span class="sgr1"> Accuracy </span>│
├─────────────────┼───────┼─────────┼──────────┤
│ ValidationPhase │   8.0 │ 0.77623 │  0.76568 │
└─────────────────┴───────┴─────────┴──────────┘
<span class="sgr32">Epoch 9 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:18</span>
┌───────────────┬───────┬─────────┬──────────┐
│<span class="sgr1">         Phase </span>│<span class="sgr1"> Epoch </span>│<span class="sgr1">    Loss </span>│<span class="sgr1"> Accuracy </span>│
├───────────────┼───────┼─────────┼──────────┤
│ TrainingPhase │   9.0 │ 0.76236 │  0.77835 │
└───────────────┴───────┴─────────┴──────────┘
<span class="sgr32">Epoch 9 ValidationPhase(): 100%|████████████████████████| Time: 0:00:02</span>
┌─────────────────┬───────┬─────────┬──────────┐
│<span class="sgr1">           Phase </span>│<span class="sgr1"> Epoch </span>│<span class="sgr1">    Loss </span>│<span class="sgr1"> Accuracy </span>│
├─────────────────┼───────┼─────────┼──────────┤
│ ValidationPhase │   9.0 │ 0.72606 │  0.78079 │
└─────────────────┴───────┴─────────┴──────────┘
<span class="sgr32">Epoch 10 TrainingPhase(): 100%|█████████████████████████| Time: 0:00:18</span>
┌───────────────┬───────┬─────────┬──────────┐
│<span class="sgr1">         Phase </span>│<span class="sgr1"> Epoch </span>│<span class="sgr1">    Loss </span>│<span class="sgr1"> Accuracy </span>│
├───────────────┼───────┼─────────┼──────────┤
│ TrainingPhase │  10.0 │ 0.71684 │  0.79175 │
└───────────────┴───────┴─────────┴──────────┘
<span class="sgr32">Epoch 10 ValidationPhase(): 100%|███████████████████████| Time: 0:00:02</span>
┌─────────────────┬───────┬─────────┬──────────┐
│<span class="sgr1">           Phase </span>│<span class="sgr1"> Epoch </span>│<span class="sgr1">    Loss </span>│<span class="sgr1"> Accuracy </span>│
├─────────────────┼───────┼─────────┼──────────┤
│ ValidationPhase │  10.0 │ 0.68353 │  0.79449 │
└─────────────────┴───────┴─────────┴──────────┘
<!-- HTML_TAG_END --></code></pre></div>
			<div class="coderesult ">
			<pre class="codeblock codeblock svelte-vj8ryq"><code class="svelte-vj8ryq">
			<!-- HTML_TAG_START -->Learner()<!-- HTML_TAG_END --></code></pre></div></div></span></div>

<div class="more"><div class="admonition"><div class="admonitiontitle">
<svg data-carbon-icon="Link20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" fill="currentColor" width="20" height="20" class="icon" preserveAspectRatio="xMidYMid meet" aria-hidden focusable="false"><path d="M29.25,6.76a6,6,0,0,0-8.5,0l1.42,1.42a4,4,0,1,1,5.67,5.67l-8,8a4,4,0,1,1-5.67-5.66l1.41-1.42-1.41-1.42-1.42,1.42a6,6,0,0,0,0,8.5A6,6,0,0,0,17,25a6,6,0,0,0,4.27-1.76l8-8A6,6,0,0,0,29.25,6.76Z"></path><path d="M4.19,24.82a4,4,0,0,1,0-5.67l8-8a4,4,0,0,1,5.67,0A3.94,3.94,0,0,1,19,14a4,4,0,0,1-1.17,2.85L15.71,19l1.42,1.42,2.12-2.12a6,6,0,0,0-8.51-8.51l-8,8a6,6,0,0,0,0,8.51A6,6,0,0,0,7,28a6.07,6.07,0,0,0,4.28-1.76L9.86,24.82A4,4,0,0,1,4.19,24.82Z"></path>
    
  </svg> Backlinks</div>
	<div class="admonitionbody"><div class="backlinks svelte-ytmwmt"><p>The following pages link back here:</p>
				<p><a href="/FluxTraining.jl/dev/documents/docs/background/dataiterator.md" class="reference document ">Data iterators</a>
	, <a href="/FluxTraining.jl/dev/documents/README.md" class="reference document ">FluxTraining.jl</a>
	, <a href="/FluxTraining.jl/dev/documents/docs/overview.md" class="reference document ">Getting started</a>
	</p>
				<p></p>
				<p></p></div></div>
</div></div></div></div></div>


		<script type="module" data-hydrate="sk257m">
		import { start } from "/FluxTraining.jl/internal/start-af5d4ead.js";
		start({
			target: document.querySelector('[data-hydrate="sk257m"]').parentNode,
			paths: {"base":"/FluxTraining.jl","assets":"/FluxTraining.jl"},
			session: {},
			route: false,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/FluxTraining.jl/internal/pages/__layout.svelte-4bac7188.js"),
						import("/FluxTraining.jl/internal/pages/_version_/_...documentId_.svelte-7aaa8049.js")
				],
				url: new URL("http://sveltekit-prerender/FluxTraining.jl/dev/documents/docs/tutorials/mnist.ipynb"),
				params: {version:"dev",documentId:"documents\u002Fdocs\u002Ftutorials\u002Fmnist.ipynb"}
			}
		});
	</script><script type="application/json" data-type="svelte-data" data-url="/FluxTraining.jl/data/dev/attributes.json">{"status":200,"statusText":"","headers":{"content-type":"application/json"},"body":"{\"documents\u002FCHANGELOG.md\":{\"tag\":\"document\",\"title\":\"News\"},\"references\u002FFluxTraining.HyperParameter\":{\"tag\":\"documentation\",\"title\":\"HyperParameter\"},\"sourcefiles\u002FFluxTraining\u002Fsrc\u002Fcallbacks\u002Fscheduler.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining\u002Fsrc\u002Fcallbacks\u002Fscheduler.jl\"},\"references\u002FFluxTraining.savemodel\":{\"tag\":\"documentation\",\"title\":\"savemodel\"},\"references\u002FFluxTraining.CheckModelLossStep\":{\"tag\":\"documentation\",\"title\":\"CheckModelLossStep\"},\"references\u002FFluxTraining.CancelStepException\":{\"tag\":\"documentation\",\"title\":\"CancelStepException\"},\"references\u002FFluxTraining.ConflictResolution\":{\"tag\":\"documentation\",\"title\":\"ConflictResolution\"},\"references\u002FFluxTraining.replacecallback!\":{\"tag\":\"documentation\",\"title\":\"replacecallback!\"},\"documents\u002Fdocs\u002Ftutorials\u002Fhyperparameters.md\":{\"tag\":\"document\",\"title\":\"Hyperparameter scheduling\"},\"sourcefiles\u002FFluxTraining\u002Fsrc\u002Fcallbacks\u002Fmetrics.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining\u002Fsrc\u002Fcallbacks\u002Fmetrics.jl\"},\"references\u002FFluxTraining.##InlineTest-01b48f5c342f65df7fcd07f28f0d2cacbb09f0a0.tests\":{\"tag\":\"documentation\",\"title\":\"tests\"},\"references\u002FFluxTraining.print_epoch_table\":{\"tag\":\"documentation\",\"title\":\"print_epoch_table\"},\"references\u002FFluxTraining.log_to\":{\"tag\":\"documentation\",\"title\":\"log_to\"},\"references\u002FFluxTraining.@pack_History!\":{\"tag\":\"documentation\",\"title\":\"@pack_History!\"},\"references\u002FFluxTraining.AbstractCallback\":{\"tag\":\"documentation\",\"title\":\"AbstractCallback\"},\"references\u002FFluxTraining.getindexperm\":{\"tag\":\"documentation\",\"title\":\"getindexperm\"},\"sourcefiles\u002FFluxTraining\u002Fsrc\u002Fcallbacks\u002Fcustom.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining\u002Fsrc\u002Fcallbacks\u002Fcustom.jl\"},\"references\u002FFluxTraining.Phases.ValidationPhase\":{\"tag\":\"documentation\",\"title\":\"ValidationPhase\"},\"references\u002FFluxTraining.iterpairs\":{\"tag\":\"documentation\",\"title\":\"iterpairs\"},\"references\u002FFluxTraining.Callback\":{\"tag\":\"documentation\",\"title\":\"Callback\"},\"references\u002FFluxTraining.StopOnNaNLoss\":{\"tag\":\"documentation\",\"title\":\"StopOnNaNLoss\"},\"references\u002FFluxTraining.Protected\":{\"tag\":\"documentation\",\"title\":\"Protected\"},\"references\u002FFluxTraining.Events.StepBegin\":{\"tag\":\"documentation\",\"title\":\"StepBegin\"},\"documents\u002FLICENSE.md\":{\"tag\":\"document\",\"title\":\"LICENSE\"},\"references\u002FFluxTraining.AbstractMetric\":{\"tag\":\"documentation\",\"title\":\"AbstractMetric\"},\"documents\u002Fdocs\u002Ftutorials\u002Fmnist.ipynb\":{\"tag\":\"document\",\"title\":\"Training an image classifier\"},\"references\u002FFluxTraining.@pack_History\":{\"tag\":\"documentation\",\"title\":\"@pack_History\"},\"references\u002FFluxTraining.edgesrunafter\":{\"tag\":\"documentation\",\"title\":\"edgesrunafter\"},\"references\u002FFluxTraining.LinearRunner\":{\"tag\":\"documentation\",\"title\":\"LinearRunner\"},\"references\u002FFluxTraining.protect\":{\"tag\":\"documentation\",\"title\":\"protect\"},\"references\u002FFluxTraining.formataccess\":{\"tag\":\"documentation\",\"title\":\"formataccess\"},\"references\u002FFluxTraining.resolveconflict\":{\"tag\":\"documentation\",\"title\":\"resolveconflict\"},\"documents\u002Fdocs\u002Fcallbacks\u002Freference.md\":{\"tag\":\"document\",\"title\":\"Callback reference\"},\"references\u002FFluxTraining.Loggables\":{\"tag\":\"documentation\",\"title\":\"Loggables\"},\"references\u002FFluxTraining.setlearningrate!\":{\"tag\":\"documentation\",\"title\":\"setlearningrate!\"},\"references\u002FFluxTraining.stepvalue\":{\"tag\":\"documentation\",\"title\":\"stepvalue\"},\"sourcefiles\u002FFluxTraining\u002Fsrc\u002Ftraining.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining\u002Fsrc\u002Ftraining.jl\"},\"sourcefiles\u002FFluxTraining\u002Fsrc\u002Fcallbacks\u002Fhyperparameters.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining\u002Fsrc\u002Fcallbacks\u002Fhyperparameters.jl\"},\"references\u002FFluxTraining.@unpack_History\":{\"tag\":\"documentation\",\"title\":\"@unpack_History\"},\"references\u002FFluxTraining.ProtectedException\":{\"tag\":\"documentation\",\"title\":\"ProtectedException\"},\"references\u002FFluxTraining.FrequencyThrottle\":{\"tag\":\"documentation\",\"title\":\"FrequencyThrottle\"},\"references\u002FFluxTraining.RunFirst\":{\"tag\":\"documentation\",\"title\":\"RunFirst\"},\"references\u002FFluxTraining.Events.StepEnd\":{\"tag\":\"documentation\",\"title\":\"StepEnd\"},\"references\u002FFluxTraining.SanityCheck\":{\"tag\":\"documentation\",\"title\":\"SanityCheck\"},\"references\u002FFluxTraining.ToDevice\":{\"tag\":\"documentation\",\"title\":\"ToDevice\"},\"references\u002FFluxTraining._on\":{\"tag\":\"documentation\",\"title\":\"_on\"},\"references\u002FFluxTraining.Loggables.Audio\":{\"tag\":\"documentation\",\"title\":\"Audio\"},\"documents\u002Fdocs\u002Fimagenette_demo.ipynb\":{\"tag\":\"document\",\"title\":\"imagenette_demo\"},\"sourcefiles\u002FFluxTraining\u002Fsrc\u002Fcallbacks\u002Fprotect.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining\u002Fsrc\u002Fcallbacks\u002Fprotect.jl\"},\"references\u002FFluxTraining.Loggables.Image\":{\"tag\":\"documentation\",\"title\":\"Image\"},\"references\u002FFluxTraining.CustomCallback\":{\"tag\":\"documentation\",\"title\":\"CustomCallback\"},\"sourcefiles\u002FFluxTraining\u002Fsrc\u002Fcallbacks\u002Flogging\u002Flogger.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining\u002Fsrc\u002Fcallbacks\u002Flogging\u002Flogger.jl\"},\"references\u002FFluxTraining._dataiters\":{\"tag\":\"documentation\",\"title\":\"_dataiters\"},\"references\u002FFluxTraining.ToGPU\":{\"tag\":\"documentation\",\"title\":\"ToGPU\"},\"sourcefiles\u002FFluxTraining\u002Fsrc\u002Ffunctional\u002Fmetrics.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining\u002Fsrc\u002Ffunctional\u002Fmetrics.jl\"},\"references\u002FFluxTraining.##InlineTest-01b48f5c342f65df7fcd07f28f0d2cacbb09f0a0.TESTSET_MACROS\":{\"tag\":\"documentation\",\"title\":\"TESTSET_MACROS\"},\"references\u002FFluxTraining.on\":{\"tag\":\"documentation\",\"title\":\"on\"},\"references\u002FFluxTraining.accuracy\":{\"tag\":\"documentation\",\"title\":\"accuracy\"},\"sourcefiles\u002FFluxTraining\u002Fsrc\u002Fcallbackutils.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining\u002Fsrc\u002Fcallbackutils.jl\"},\"references\u002FFluxTraining.Check\":{\"tag\":\"documentation\",\"title\":\"Check\"},\"references\u002FFluxTraining.throttle\":{\"tag\":\"documentation\",\"title\":\"throttle\"},\"references\u002FFluxTraining.Callbacks\":{\"tag\":\"documentation\",\"title\":\"Callbacks\"},\"references\u002FFluxTraining.LearningRate\":{\"tag\":\"documentation\",\"title\":\"LearningRate\"},\"references\u002FFluxTraining.Metric\":{\"tag\":\"documentation\",\"title\":\"Metric\"},\"references\u002FFluxTraining.FitException\":{\"tag\":\"documentation\",\"title\":\"FitException\"},\"sourcefiles\u002FFluxTraining\u002Fsrc\u002Fcallbacks\u002Fgraph.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining\u002Fsrc\u002Fcallbacks\u002Fgraph.jl\"},\"documents\u002Fdocs\u002Fbackground\u002Flossfunction.md\":{\"tag\":\"document\",\"title\":\"Loss functions\"},\"sourcefiles\u002FFluxTraining\u002Fsrc\u002FFluxTraining.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining\u002Fsrc\u002FFluxTraining.jl\"},\"sourcefiles\u002FFluxTraining\u002Fsrc\u002Fcallbacks\u002Fexecution.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining\u002Fsrc\u002Fcallbacks\u002Fexecution.jl\"},\"references\u002FFluxTraining.setupoptimstate\":{\"tag\":\"documentation\",\"title\":\"setupoptimstate\"},\"references\u002FFluxTraining._combinename\":{\"tag\":\"documentation\",\"title\":\"_combinename\"},\"references\u002FFluxTraining.testbatch\":{\"tag\":\"documentation\",\"title\":\"testbatch\"},\"references\u002FFluxTraining.Phases.AbstractTrainingPhase\":{\"tag\":\"documentation\",\"title\":\"AbstractTrainingPhase\"},\"references\u002FFluxTraining.stateaccess\":{\"tag\":\"documentation\",\"title\":\"stateaccess\"},\"documents\u002FREADME.md\":{\"tag\":\"document\",\"title\":\"FluxTraining.jl\"},\"references\u002FFluxTraining.GarbageCollect\":{\"tag\":\"documentation\",\"title\":\"GarbageCollect\"},\"sourcefiles\u002FFluxTraining\u002Fsrc\u002Fcallbacks\u002Flogging\u002FLoggables.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining\u002Fsrc\u002Fcallbacks\u002Flogging\u002FLoggables.jl\"},\"references\u002FFluxTraining.runtests\":{\"tag\":\"documentation\",\"title\":\"runtests\"},\"references\u002FFluxTraining.Loggables.Graph\":{\"tag\":\"documentation\",\"title\":\"Graph\"},\"references\u002FFluxTraining.LogVisualization\":{\"tag\":\"documentation\",\"title\":\"LogVisualization\"},\"references\u002FFluxTraining.Events\":{\"tag\":\"documentation\",\"title\":\"Events\"},\"references\u002FFluxTraining.NoConflict\":{\"tag\":\"documentation\",\"title\":\"NoConflict\"},\"references\u002FFluxTraining.defaultcallbacks\":{\"tag\":\"documentation\",\"title\":\"defaultcallbacks\"},\"references\u002FFluxTraining.Events.Event\":{\"tag\":\"documentation\",\"title\":\"Event\"},\"references\u002FFluxTraining.Learner\":{\"tag\":\"documentation\",\"title\":\"Learner\"},\"references\u002FFluxTraining.setindexperm!\":{\"tag\":\"documentation\",\"title\":\"setindexperm!\"},\"references\u002FFluxTraining.CancelFittingException\":{\"tag\":\"documentation\",\"title\":\"CancelFittingException\"},\"references\u002FFluxTraining.metricname\":{\"tag\":\"documentation\",\"title\":\"metricname\"},\"references\u002FFluxTraining.ES\":{\"tag\":\"documentation\",\"title\":\"ES\"},\"references\u002FFluxTraining.runafter\":{\"tag\":\"documentation\",\"title\":\"runafter\"},\"references\u002FFluxTraining.MetricsPrinter\":{\"tag\":\"documentation\",\"title\":\"MetricsPrinter\"},\"references\u002FFluxTraining.hasconflict\":{\"tag\":\"documentation\",\"title\":\"hasconflict\"},\"references\u002FFluxTraining._update!\":{\"tag\":\"documentation\",\"title\":\"_update!\"},\"references\u002FFluxTraining.runchecks\":{\"tag\":\"documentation\",\"title\":\"runchecks\"},\"references\u002FFluxTraining.TimeThrottle\":{\"tag\":\"documentation\",\"title\":\"TimeThrottle\"},\"sourcefiles\u002FFluxTraining\u002Fsrc\u002Fcallbacks\u002Fsanitycheck.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining\u002Fsrc\u002Fcallbacks\u002Fsanitycheck.jl\"},\"references\u002FFluxTraining.ConditionalCallback\":{\"tag\":\"documentation\",\"title\":\"ConditionalCallback\"},\"references\u002FFluxTraining.LogHyperParams\":{\"tag\":\"documentation\",\"title\":\"LogHyperParams\"},\"references\u002FFluxTraining.History\":{\"tag\":\"documentation\",\"title\":\"History\"},\"references\u002FFluxTraining.Scheduler\":{\"tag\":\"documentation\",\"title\":\"Scheduler\"},\"references\u002FFluxTraining.Phases.TrainingPhase\":{\"tag\":\"documentation\",\"title\":\"TrainingPhase\"},\"documents\u002Fdocs\u002Fbackground\u002Fmodel.md\":{\"tag\":\"document\",\"title\":\"Models\"},\"references\u002FFluxTraining.Checkpointer\":{\"tag\":\"documentation\",\"title\":\"Checkpointer\"},\"references\u002FFluxTraining.Events.BackwardEnd\":{\"tag\":\"documentation\",\"title\":\"BackwardEnd\"},\"references\u002FFluxTraining.Loggables.Histogram\":{\"tag\":\"documentation\",\"title\":\"Histogram\"},\"references\u002FFluxTraining.CheckIteratesTuples\":{\"tag\":\"documentation\",\"title\":\"CheckIteratesTuples\"},\"references\u002FFluxTraining.phasedataiter\":{\"tag\":\"documentation\",\"title\":\"phasedataiter\"},\"references\u002FFluxTraining.EarlyStopping\":{\"tag\":\"documentation\",\"title\":\"EarlyStopping\"},\"references\u002FFluxTraining.sethyperparameter!\":{\"tag\":\"documentation\",\"title\":\"sethyperparameter!\"},\"references\u002FFluxTraining.Write\":{\"tag\":\"documentation\",\"title\":\"Write\"},\"references\u002FFluxTraining.Events.EpochEnd\":{\"tag\":\"documentation\",\"title\":\"EpochEnd\"},\"references\u002FFluxTraining.callbackgraph\":{\"tag\":\"documentation\",\"title\":\"callbackgraph\"},\"references\u002FFluxTraining.Phases\":{\"tag\":\"documentation\",\"title\":\"Phases\"},\"references\u002FFluxTraining.TensorBoardBackend\":{\"tag\":\"documentation\",\"title\":\"TensorBoardBackend\"},\"documents\u002Fdocs\u002Fbackground\u002Foptimizer.md\":{\"tag\":\"document\",\"title\":\"Optimizers\"},\"references\u002FFluxTraining.testlearner\":{\"tag\":\"documentation\",\"title\":\"testlearner\"},\"references\u002FFluxTraining.epochvalue\":{\"tag\":\"documentation\",\"title\":\"epochvalue\"},\"documents\u002Fdocs\u002Fgetting_started.md\":{\"tag\":\"document\",\"title\":\"Getting started\"},\"references\u002FFluxTraining.garbagecollect\":{\"tag\":\"documentation\",\"title\":\"garbagecollect\"},\"documents\u002Fdocs\u002Fcustom_training.ipynb\":{\"tag\":\"document\",\"title\":\"Custom training loops\"},\"references\u002FFluxTraining.epoch!\":{\"tag\":\"documentation\",\"title\":\"epoch!\"},\"references\u002FFluxTraining.SmoothLoss\":{\"tag\":\"documentation\",\"title\":\"SmoothLoss\"},\"references\u002FFluxTraining.Phases.Phase\":{\"tag\":\"documentation\",\"title\":\"Phase\"},\"references\u002FFluxTraining.setcallbacks!\":{\"tag\":\"documentation\",\"title\":\"setcallbacks!\"},\"references\u002FFluxTraining.Unresolvable\":{\"tag\":\"documentation\",\"title\":\"Unresolvable\"},\"references\u002FFluxTraining\":{\"tag\":\"documentation\",\"title\":\"FluxTraining\"},\"references\u002FFluxTraining.testbatches\":{\"tag\":\"documentation\",\"title\":\"testbatches\"},\"documents\u002Fdocs\u002Foverview.md\":{\"tag\":\"document\",\"title\":\"Getting started\"},\"references\u002FFluxTraining.accesses\":{\"tag\":\"documentation\",\"title\":\"accesses\"},\"documents\u002Fdocs\u002Fcallbacks\u002Ftipstricks.md\":{\"tag\":\"document\",\"title\":\"Tips & tricks\"},\"references\u002FFluxTraining.Phases.AbstractValidationPhase\":{\"tag\":\"documentation\",\"title\":\"AbstractValidationPhase\"},\"sourcefiles\u002FFluxTraining\u002Fsrc\u002Fcallbacks\u002Frecorder.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining\u002Fsrc\u002Fcallbacks\u002Frecorder.jl\"},\"references\u002FFluxTraining.NotDefined\":{\"tag\":\"documentation\",\"title\":\"NotDefined\"},\"references\u002FFluxTraining.findconflicts\":{\"tag\":\"documentation\",\"title\":\"findconflicts\"},\"references\u002FFluxTraining.Loggables.Text\":{\"tag\":\"documentation\",\"title\":\"Text\"},\"references\u002FFluxTraining.PropDict\":{\"tag\":\"documentation\",\"title\":\"PropDict\"},\"documents\u002Fdocs\u002Fcallbacks\u002Fusage.md\":{\"tag\":\"document\",\"title\":\"How to use callbacks\"},\"references\u002FFluxTraining.Events.LossBegin\":{\"tag\":\"documentation\",\"title\":\"LossBegin\"},\"references\u002FFluxTraining.Recorder\":{\"tag\":\"documentation\",\"title\":\"Recorder\"},\"references\u002FFluxTraining.LogMetrics\":{\"tag\":\"documentation\",\"title\":\"LogMetrics\"},\"references\u002FFluxTraining.fit!\":{\"tag\":\"documentation\",\"title\":\"fit!\"},\"references\u002FFluxTraining.SanityCheckException\":{\"tag\":\"documentation\",\"title\":\"SanityCheckException\"},\"references\u002FFluxTraining.UnsafeCallback\":{\"tag\":\"documentation\",\"title\":\"UnsafeCallback\"},\"sourcefiles\u002FFluxTraining\u002Fsrc\u002Fcallbacks\u002Fcallbacks.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining\u002Fsrc\u002Fcallbacks\u002Fcallbacks.jl\"},\"references\u002FFluxTraining.CancelEpochException\":{\"tag\":\"documentation\",\"title\":\"CancelEpochException\"},\"references\u002FFluxTraining.Permission\":{\"tag\":\"documentation\",\"title\":\"Permission\"},\"sourcefiles\u002FFluxTraining\u002Fsrc\u002Ftestutils.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining\u002Fsrc\u002Ftestutils.jl\"},\"references\u002FFluxTraining.runstep\":{\"tag\":\"documentation\",\"title\":\"runstep\"},\"references\u002FFluxTraining.removecallback!\":{\"tag\":\"documentation\",\"title\":\"removecallback!\"},\"references\u002FFluxTraining.CallbackRunner\":{\"tag\":\"documentation\",\"title\":\"CallbackRunner\"},\"references\u002FFluxTraining.addcallback!\":{\"tag\":\"documentation\",\"title\":\"addcallback!\"},\"references\u002FFluxTraining._gradient\":{\"tag\":\"documentation\",\"title\":\"_gradient\"},\"references\u002FFluxTraining.CheckDataIteratorTrain\":{\"tag\":\"documentation\",\"title\":\"CheckDataIteratorTrain\"},\"references\u002FFluxTraining.reset!\":{\"tag\":\"documentation\",\"title\":\"reset!\"},\"sourcefiles\u002FFluxTraining\u002Fsrc\u002Fcallbacks\u002Fcallback.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining\u002Fsrc\u002Fcallbacks\u002Fcallback.jl\"},\"references\u002FFluxTraining.Events.BackwardBegin\":{\"tag\":\"documentation\",\"title\":\"BackwardBegin\"},\"sourcefiles\u002FFluxTraining\u002Fsrc\u002Flearner.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining\u002Fsrc\u002Flearner.jl\"},\"references\u002FFluxTraining.Loss\":{\"tag\":\"documentation\",\"title\":\"Loss\"},\"sourcefiles\u002FFluxTraining\u002Fsrc\u002Fcallbacks\u002Fphases.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining\u002Fsrc\u002Fcallbacks\u002Fphases.jl\"},\"references\u002FFluxTraining.runepoch\":{\"tag\":\"documentation\",\"title\":\"runepoch\"},\"sourcefiles\u002FFluxTraining\u002Fsrc\u002Fcallbacks\u002Fconditional.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining\u002Fsrc\u002Fcallbacks\u002Fconditional.jl\"},\"documents\u002Fdocs\u002Ffeatures.md\":{\"tag\":\"document\",\"title\":\"Features\"},\"references\u002FFluxTraining.LogHistograms\":{\"tag\":\"documentation\",\"title\":\"LogHistograms\"},\"references\u002FFluxTraining.shouldrun\":{\"tag\":\"documentation\",\"title\":\"shouldrun\"},\"sourcefiles\u002FFluxTraining\u002Fsrc\u002Fcallbacks\u002Fevents.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining\u002Fsrc\u002Fcallbacks\u002Fevents.jl\"},\"references\u002FFluxTraining.init!\":{\"tag\":\"documentation\",\"title\":\"init!\"},\"references\u002FFluxTraining.##InlineTest-01b48f5c342f65df7fcd07f28f0d2cacbb09f0a0.__init__\":{\"tag\":\"documentation\",\"title\":\"__init__\"},\"references\u002FFluxTraining.setfieldperm!\":{\"tag\":\"documentation\",\"title\":\"setfieldperm!\"},\"references\u002FFluxTraining.getfieldperm\":{\"tag\":\"documentation\",\"title\":\"getfieldperm\"},\"references\u002FFluxTraining.CHECKS\":{\"tag\":\"documentation\",\"title\":\"CHECKS\"},\"documents\u002Fdocs\u002Freference\u002Ftraining.md\":{\"tag\":\"document\",\"title\":\"Training loop API reference\"},\"references\u002FFluxTraining.Loggables.File\":{\"tag\":\"documentation\",\"title\":\"File\"},\"references\u002FFluxTraining.Metrics\":{\"tag\":\"documentation\",\"title\":\"Metrics\"},\"references\u002FFluxTraining.log_parameters\":{\"tag\":\"documentation\",\"title\":\"log_parameters\"},\"references\u002FFluxTraining.model!\":{\"tag\":\"documentation\",\"title\":\"model!\"},\"references\u002FFluxTraining.Events.EpochBegin\":{\"tag\":\"documentation\",\"title\":\"EpochBegin\"},\"references\u002FFluxTraining.CallbackCondition\":{\"tag\":\"documentation\",\"title\":\"CallbackCondition\"},\"sourcefiles\u002FFluxTraining\u002Fsrc\u002Fcallbacks\u002Flogging\u002Fcheckpointer.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining\u002Fsrc\u002Fcallbacks\u002Flogging\u002Fcheckpointer.jl\"},\"references\u002FFluxTraining.onecycle\":{\"tag\":\"documentation\",\"title\":\"onecycle\"},\"references\u002FFluxTraining.loadmodel\":{\"tag\":\"documentation\",\"title\":\"loadmodel\"},\"sourcefiles\u002FFluxTraining\u002Fsrc\u002Fcallbacks\u002Fearlystopping.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining\u002Fsrc\u002Fcallbacks\u002Fearlystopping.jl\"},\"references\u002FFluxTraining.Loggables.Loggable\":{\"tag\":\"documentation\",\"title\":\"Loggable\"},\"references\u002FFluxTraining.Read\":{\"tag\":\"documentation\",\"title\":\"Read\"},\"references\u002FFluxTraining.step!\":{\"tag\":\"documentation\",\"title\":\"step!\"},\"references\u002FFluxTraining.ProgressPrinter\":{\"tag\":\"documentation\",\"title\":\"ProgressPrinter\"},\"references\u002FFluxTraining.getcallback\":{\"tag\":\"documentation\",\"title\":\"getcallback\"},\"references\u002FFluxTraining.handle\":{\"tag\":\"documentation\",\"title\":\"handle\"},\"documents\u002Fdocs\u002Ftutorials\u002Ftraining.md\":{\"tag\":\"document\",\"title\":\"Training loop\"},\"references\u002FFluxTraining._resolveconflict\":{\"tag\":\"documentation\",\"title\":\"_resolveconflict\"},\"references\u002FFluxTraining.SafeCallback\":{\"tag\":\"documentation\",\"title\":\"SafeCallback\"},\"documents\u002Fdocs\u002Fcallbacks\u002Fcustom.md\":{\"tag\":\"document\",\"title\":\"Custom callbacks\"},\"sourcefiles\u002FFluxTraining\u002Fsrc\u002Fcallbacks\u002Flogging\u002Ftensorboard.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining\u002Fsrc\u002Fcallbacks\u002Flogging\u002Ftensorboard.jl\"},\"references\u002FFluxTraining.CheckDataIteratorValid\":{\"tag\":\"documentation\",\"title\":\"CheckDataIteratorValid\"},\"references\u002FFluxTraining.errorwriteconflict\":{\"tag\":\"documentation\",\"title\":\"errorwriteconflict\"},\"references\u002FFluxTraining.Loggables.Value\":{\"tag\":\"documentation\",\"title\":\"Value\"},\"references\u002FFluxTraining.TestModel\":{\"tag\":\"documentation\",\"title\":\"TestModel\"},\"references\u002FFluxTraining.LoggerBackend\":{\"tag\":\"documentation\",\"title\":\"LoggerBackend\"},\"documents\u002Fdocs\u002Fbackground\u002Fdataiterator.md\":{\"tag\":\"document\",\"title\":\"Data iterators\"}}"}</script>
	<script type="application/json" data-type="svelte-data" data-url="/FluxTraining.jl/data/dev/config.json">{"status":200,"statusText":"","headers":{"content-type":"application/json"},"body":"{\"linktree\":{\"Overview\":\"documents\u002FREADME.md\",\"Getting started\":\"documents\u002Fdocs\u002Fgetting_started.md\",\"Features\":\"documents\u002Fdocs\u002Ffeatures.md\",\"Tutorials\":{\"Train an image classifier\":\"documents\u002Fdocs\u002Ftutorials\u002Fmnist.ipynb\",\"Write a custom callback\":\"documents\u002Fdocs\u002Fcallbacks\u002Fcustom.md\"},\"How to\":{\"Use callbacks\":\"documents\u002Fdocs\u002Fcallbacks\u002Fusage.md\",\"Tips & Tricks\":\"documents\u002Fdocs\u002Fcallbacks\u002Ftipstricks.md\"},\"Reference\":{\"Module\":\"references\u002FFluxTraining\",\"List of callbacks\":\"documents\u002Fdocs\u002Fcallbacks\u002Freference.md\",\"Training loop API\":\"documents\u002Fdocs\u002Freference\u002Ftraining.md\"},\"Backround\":{\"Hyperparameter scheduling\":\"documents\u002Fdocs\u002Ftutorials\u002Fhyperparameters.md\",\"Custom training loops\":\"documents\u002Fdocs\u002Ftutorials\u002Ftraining.md\"}},\"columnWidth\":650,\"title\":\"FluxTraining.jl\",\"url\":\"https:\u002F\u002Fgithub.com\u002FFluxML\u002FFluxTraining.jl\",\"defaultDocument\":\"documents\u002FREADME.md\"}"}</script>
	<script type="application/json" data-type="svelte-data" data-url="/FluxTraining.jl/data/dev/documents/docs/tutorials/mnist.ipynb.json">{"status":200,"statusText":"","headers":{"content-type":"application/json"},"body":"{\"attributes\":{\"backlinks\":[{\"tag\":\"document\",\"title\":\"Getting started\",\"docid\":\"documents\u002Fdocs\u002Foverview.md\"},{\"tag\":\"document\",\"title\":\"FluxTraining.jl\",\"docid\":\"documents\u002FREADME.md\"},{\"tag\":\"document\",\"title\":\"Data iterators\",\"docid\":\"documents\u002Fdocs\u002Fbackground\u002Fdataiterator.md\"}],\"path\":\"\u002Fhome\u002Frunner\u002F.julia\u002Fpackages\u002FFluxTraining\u002FKmMoR\u002Fdocs\u002Ftutorials\u002Fmnist.ipynb\",\"title\":\"Training an image classifier\"},\"tag\":\"document\",\"children\":[{\"attributes\":{\"nbformat\":[4,4],\"kernelspec\":{\"display_name\":\"Julia 1.6.0\",\"language\":\"julia\",\"name\":\"julia-1.6\"},\"language_info\":{\"file_extension\":\".jl\",\"mimetype\":\"application\u002Fjulia\",\"name\":\"julia\",\"version\":\"1.6.0\"}},\"tag\":\"jupyter\",\"children\":[{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"h1\",\"children\":[\"Training an image classifier\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"Let’s put \",{\"attributes\":{},\"tag\":\"em\",\"children\":[\"FluxTraining\",\".\",\"jl\"],\"type\":\"node\"},\" to train a model on the MNIST dataset.\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[\"MNIST is simple enough that we can focus on the part where \",{\"attributes\":{},\"tag\":\"em\",\"children\":[\"FluxTraining\",\".\",\"jl\"],\"type\":\"node\"},\" comes in, the training. If you want to see examples of using FluxTraining.jl on larger datasets, see the documentation of \",{\"attributes\":{\"href\":\"https:\u002F\u002Fgithub.com\u002FFluxML\u002FFastAI.jl\",\"title\":\"\"},\"tag\":\"a\",\"children\":[\"FastAI\",\".\",\"jl\"],\"type\":\"node\"},\".\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"h2\",\"children\":[\"Setup\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[{\"attributes\":{},\"tag\":\"em\",\"children\":[\"If you want to run this tutorial yourself, you can find the notebook file \",{\"attributes\":{\"href\":\"https:\u002F\u002Fgithub.com\u002Florenzoh\u002FFluxTraining.jl\u002Fblob\u002Fmaster\u002Fdocs\u002Ftutorials\u002Fmnist.ipynb\",\"title\":\"\"},\"tag\":\"a\",\"children\":[\"here\"],\"type\":\"node\"}],\"type\":\"node\"},\".\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"To make data loading and batching a bit easier, we’ll install some additional dependencies:\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{\"lang\":\"julia\"},\"tag\":\"codeblock\",\"children\":[{\"attributes\":{},\"tag\":\"julia\",\"children\":[{\"attributes\":{},\"tag\":\"TOPLEVEL\",\"children\":[{\"attributes\":{},\"tag\":\"USING\",\"children\":[{\"attributes\":{},\"tag\":\"USING\",\"children\":[\"using\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"Pkg\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"SEMICOLON\",\"children\":[\";\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"Pkg\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"add\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"VECT\",\"children\":[{\"attributes\":{},\"tag\":\"LSQUARE\",\"children\":[\"[\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DQUOTE\",\"children\":[\"\\\"\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"STRING\",\"children\":[\"MLDataPattern\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DQUOTE\",\"children\":[\"\\\"\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DQUOTE\",\"children\":[\"\\\"\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"STRING\",\"children\":[\"DataLoaders\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DQUOTE\",\"children\":[\"\\\"\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RSQUARE\",\"children\":[\"]\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"Now we can import everything we’ll need.\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null,\"execution_count\":1},\"tag\":\"codecell\",\"children\":[{\"attributes\":{},\"tag\":\"codeinput\",\"children\":[{\"attributes\":{\"lang\":\"julia\"},\"tag\":\"codeblock\",\"children\":[{\"attributes\":{},\"tag\":\"julia\",\"children\":[{\"attributes\":{},\"tag\":\"USING\",\"children\":[{\"attributes\":{},\"tag\":\"COLON\",\"children\":[{\"attributes\":{},\"tag\":\"USING\",\"children\":[\"using\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"DataLoaders\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COLON\",\"children\":[\":\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"DataLoader\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"USING\",\"children\":[{\"attributes\":{},\"tag\":\"COLON\",\"children\":[{\"attributes\":{},\"tag\":\"USING\",\"children\":[\"using\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"MLDataPattern\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COLON\",\"children\":[\":\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"splitobs\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"USING\",\"children\":[{\"attributes\":{},\"tag\":\"USING\",\"children\":[\"using\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"Flux\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"USING\",\"children\":[{\"attributes\":{},\"tag\":\"USING\",\"children\":[\"using\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references\u002FFluxTraining\"},\"tag\":\"reference\",\"children\":[\"FluxTraining\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"h2\",\"children\":[\"Overview\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"There are 4 pieces that you always need to construct and train a \",{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references\u002FFluxTraining.Learner\"},\"tag\":\"reference\",\"children\":[{\"attributes\":{},\"tag\":\"code\",\"children\":[\"Learner\"],\"type\":\"node\"}],\"type\":\"node\"},\":\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"ul\",\"children\":[{\"attributes\":{},\"tag\":\"li\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"a model\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"li\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"data\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"li\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"an optimizer; and\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"li\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"a loss function\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"h2\",\"children\":[\"Building a \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"Learner\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"Let’s look at the \",{\"attributes\":{},\"tag\":\"strong\",\"children\":[\"data\"],\"type\":\"node\"},\" first.\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[{\"attributes\":{},\"tag\":\"em\",\"children\":[\"FluxTraining\",\".\",\"jl\"],\"type\":\"node\"},\" is agnostic of the data source. The only requirements are:\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"ul\",\"children\":[{\"attributes\":{},\"tag\":\"li\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"it is iterable and each iteration returns a tuple \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"(xs, ys)\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"li\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"the model can take in \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"xs\"],\"type\":\"node\"},\", i.e. \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"model(xs)\"],\"type\":\"node\"},\" works; and\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"li\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"the loss function can take model outputs and \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"ys\"],\"type\":\"node\"},\", i.e. \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"lossfn(model(xs), ys)\"],\"type\":\"node\"},\" returns a scalar\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"Glossing over the details as it’s not the focus of this tutorial, here’s the code for getting a data iterator of the MNIST dataset. We use \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"DataLoaders.DataLoader\"],\"type\":\"node\"},\" to create an iterator of batches from our dataset.\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null,\"execution_count\":2},\"tag\":\"codecell\",\"children\":[{\"attributes\":{},\"tag\":\"codeinput\",\"children\":[{\"attributes\":{\"lang\":\"julia\"},\"tag\":\"codeblock\",\"children\":[{\"attributes\":{},\"tag\":\"julia\",\"children\":[{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMENT\",\"children\":[\"# convert each image into h*w*1 array of floats \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMPREHENSION\",\"children\":[{\"attributes\":{},\"tag\":\"LSQUARE\",\"children\":[\"[\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"GENERATOR\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"Float32\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"reshape\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"img\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"INTEGER\",\"children\":[\"28\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"INTEGER\",\"children\":[\"28\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"INTEGER\",\"children\":[\"1\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"FOR\",\"children\":[\"for\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"img\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IN\",\"children\":[\"in\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"Flux\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"Data\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"MNIST\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"images\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RSQUARE\",\"children\":[\"]\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMENT\",\"children\":[\"# one-hot encode the labels\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMPREHENSION\",\"children\":[{\"attributes\":{},\"tag\":\"LSQUARE\",\"children\":[\"[\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"GENERATOR\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"Float32\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"Flux\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"onehot\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"y\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"INTEGER\",\"children\":[\"0\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COLON\",\"children\":[\":\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"INTEGER\",\"children\":[\"9\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"FOR\",\"children\":[\"for\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"y\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IN\",\"children\":[\"in\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"Flux\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"Data\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"MNIST\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"labels\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RSQUARE\",\"children\":[\"]\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMENT\",\"children\":[\"# split into training and validation sets\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"traindata\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"valdata\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"splitobs\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"TOPLEVEL\",\"children\":[{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMENT\",\"children\":[\"# create iterators\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"trainiter\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"valiter\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"DataLoader\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"traindata\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"INTEGER\",\"children\":[\"128\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"KW\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"buffered\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"FALSE\",\"children\":[\"false\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"DataLoader\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"valdata\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"INTEGER\",\"children\":[\"256\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"KW\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"buffered\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"FALSE\",\"children\":[\"false\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"SEMICOLON\",\"children\":[\";\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"Next, let’s create a simple \",{\"attributes\":{},\"tag\":\"em\",\"children\":[\"Flux\",\".\",\"jl\"],\"type\":\"node\"},\" \",{\"attributes\":{},\"tag\":\"strong\",\"children\":[\"model\"],\"type\":\"node\"},\" that we’ll train to classify the MNIST digits.\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null,\"execution_count\":3},\"tag\":\"codecell\",\"children\":[{\"attributes\":{},\"tag\":\"codeinput\",\"children\":[{\"attributes\":{\"lang\":\"julia\"},\"tag\":\"codeblock\",\"children\":[{\"attributes\":{},\"tag\":\"julia\",\"children\":[{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"model\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"Chain\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"Conv\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"INTEGER\",\"children\":[\"3\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"INTEGER\",\"children\":[\"3\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"INTEGER\",\"children\":[\"1\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"PAIR_ARROW\",\"children\":[\"=\u003E\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"INTEGER\",\"children\":[\"16\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"relu\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"KW\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"pad\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"INTEGER\",\"children\":[\"1\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"KW\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"stride\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"INTEGER\",\"children\":[\"2\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"Conv\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"INTEGER\",\"children\":[\"3\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"INTEGER\",\"children\":[\"3\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"INTEGER\",\"children\":[\"16\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"PAIR_ARROW\",\"children\":[\"=\u003E\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"INTEGER\",\"children\":[\"32\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"relu\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"KW\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"pad\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"INTEGER\",\"children\":[\"1\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"GlobalMeanPool\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"Flux\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"flatten\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"Dense\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"INTEGER\",\"children\":[\"32\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"INTEGER\",\"children\":[\"10\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"coderesult\",\"children\":[{\"attributes\":{},\"tag\":\"codeblock\",\"children\":[{\"mimes\":{\"text\u002Fhtml\":\"Chain(Conv((3, 3), 1=&gt;16, relu), Conv((3, 3), 16=&gt;32, relu), GlobalMeanPool(), flatten, Dense(32, 10))\"},\"type\":\"leaf\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"We’ll use \",{\"attributes\":{},\"tag\":\"em\",\"children\":[\"categorical cross entropy\"],\"type\":\"node\"},\" as a \",{\"attributes\":{},\"tag\":\"strong\",\"children\":[\"loss function\"],\"type\":\"node\"},\" and \",{\"attributes\":{},\"tag\":\"em\",\"children\":[\"ADAM\"],\"type\":\"node\"},\" as an \",{\"attributes\":{},\"tag\":\"strong\",\"children\":[\"optimizer\"],\"type\":\"node\"},\".\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null,\"execution_count\":4},\"tag\":\"codecell\",\"children\":[{\"attributes\":{},\"tag\":\"codeinput\",\"children\":[{\"attributes\":{\"lang\":\"julia\"},\"tag\":\"codeblock\",\"children\":[{\"attributes\":{},\"tag\":\"julia\",\"children\":[{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"lossfn\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"Flux\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"Losses\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"logitcrossentropy\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"TOPLEVEL\",\"children\":[{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"optimizer\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"Flux\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ADAM\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"SEMICOLON\",\"children\":[\";\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"Now we’re ready to create a \",{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references\u002FFluxTraining.Learner\"},\"tag\":\"reference\",\"children\":[{\"attributes\":{},\"tag\":\"code\",\"children\":[\"Learner\"],\"type\":\"node\"}],\"type\":\"node\"},\". At this point you can also add any callbacks, like \",{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references\u002FFluxTraining.ToGPU\"},\"tag\":\"reference\",\"children\":[{\"attributes\":{},\"tag\":\"code\",\"children\":[\"ToGPU\"],\"type\":\"node\"}],\"type\":\"node\"},\" to run the training on your GPU if you have one available. Some callbacks are also \",{\"attributes\":{\"reftype\":\"document\",\"href\":\"..\u002Fcallbacks\u002Freference.md\",\"title\":\"\",\"document_id\":\"documents\u002Fdocs\u002Fcallbacks\u002Freference.md\"},\"tag\":\"reference\",\"children\":[\"included by default\"],\"type\":\"node\"},\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[\"Since we’re classifying digits, we also use the \",{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references\u002FFluxTraining.Metrics\"},\"tag\":\"reference\",\"children\":[{\"attributes\":{},\"tag\":\"code\",\"children\":[\"Metrics\"],\"type\":\"node\"}],\"type\":\"node\"},\" callback to track the accuracy of the model’s predictions:\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null,\"execution_count\":7},\"tag\":\"codecell\",\"children\":[{\"attributes\":{},\"tag\":\"codeinput\",\"children\":[{\"attributes\":{\"lang\":\"julia\"},\"tag\":\"codeblock\",\"children\":[{\"attributes\":{},\"tag\":\"julia\",\"children\":[{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references\u002FFluxTraining.Learner\"},\"tag\":\"reference\",\"children\":[\"Learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"model\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"lossfn\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"PARAMETERS\",\"children\":[{\"attributes\":{},\"tag\":\"SEMICOLON\",\"children\":[\";\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"KW\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"callbacks\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"VECT\",\"children\":[{\"attributes\":{},\"tag\":\"LSQUARE\",\"children\":[\"[\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references\u002FFluxTraining.Metrics\"},\"tag\":\"reference\",\"children\":[\"Metrics\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references\u002FFluxTraining.accuracy\"},\"tag\":\"reference\",\"children\":[\"accuracy\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RSQUARE\",\"children\":[\"]\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"optimizer\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"coderesult\",\"children\":[{\"attributes\":{},\"tag\":\"codeblock\",\"children\":[{\"mimes\":{\"text\u002Fhtml\":\"Learner()\"},\"type\":\"leaf\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"h2\",\"children\":[\"Training\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"With a \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"Learner\"],\"type\":\"node\"},\" inplace, training is as simple as calling \",{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references\u002FFluxTraining.fit!\"},\"tag\":\"reference\",\"children\":[{\"attributes\":{},\"tag\":\"code\",\"children\":[\"fit!\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"code\",\"children\":[\"(learner, nepochs, dataiters)\"],\"type\":\"node\"},\".\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{\"id\":null,\"execution_count\":8},\"tag\":\"codecell\",\"children\":[{\"attributes\":{},\"tag\":\"codeinput\",\"children\":[{\"attributes\":{\"lang\":\"julia\"},\"tag\":\"codeblock\",\"children\":[{\"attributes\":{},\"tag\":\"julia\",\"children\":[{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references\u002FFluxTraining\"},\"tag\":\"reference\",\"children\":[\"FluxTraining\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references\u002FFluxTraining.fit!\"},\"tag\":\"reference\",\"children\":[\"fit!\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"INTEGER\",\"children\":[\"10\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"trainiter\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"validiter\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"codeoutput\",\"children\":[{\"attributes\":{},\"tag\":\"codeblock\",\"children\":[{\"mimes\":{\"text\u002Fhtml\":\"\u003Cspan class=\\\"sgr32\\\"\u003EEpoch 1 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:46\u003C\u002Fspan\u003E\\n┌───────────────┬───────┬─────────┬──────────┐\\n│\u003Cspan class=\\\"sgr1\\\"\u003E         Phase \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Epoch \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E    Loss \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Accuracy \u003C\u002Fspan\u003E│\\n├───────────────┼───────┼─────────┼──────────┤\\n│ TrainingPhase │   1.0 │ 2.04939 │  0.25204 │\\n└───────────────┴───────┴─────────┴──────────┘\\n\u003Cspan class=\\\"sgr32\\\"\u003EEpoch 1 ValidationPhase(): 100%|████████████████████████| Time: 0:00:02\u003C\u002Fspan\u003E\\n┌─────────────────┬───────┬─────────┬──────────┐\\n│\u003Cspan class=\\\"sgr1\\\"\u003E           Phase \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Epoch \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E    Loss \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Accuracy \u003C\u002Fspan\u003E│\\n├─────────────────┼───────┼─────────┼──────────┤\\n│ ValidationPhase │   1.0 │ 1.70353 │   0.3821 │\\n└─────────────────┴───────┴─────────┴──────────┘\\n\u003Cspan class=\\\"sgr32\\\"\u003EEpoch 2 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:19\u003C\u002Fspan\u003E\\n┌───────────────┬───────┬─────────┬──────────┐\\n│\u003Cspan class=\\\"sgr1\\\"\u003E         Phase \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Epoch \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E    Loss \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Accuracy \u003C\u002Fspan\u003E│\\n├───────────────┼───────┼─────────┼──────────┤\\n│ TrainingPhase │   2.0 │ 1.58615 │  0.44849 │\\n└───────────────┴───────┴─────────┴──────────┘\\n\u003Cspan class=\\\"sgr32\\\"\u003EEpoch 2 ValidationPhase(): 100%|████████████████████████| Time: 0:00:02\u003C\u002Fspan\u003E\\n┌─────────────────┬───────┬─────────┬──────────┐\\n│\u003Cspan class=\\\"sgr1\\\"\u003E           Phase \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Epoch \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E    Loss \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Accuracy \u003C\u002Fspan\u003E│\\n├─────────────────┼───────┼─────────┼──────────┤\\n│ ValidationPhase │   2.0 │ 1.44792 │  0.50544 │\\n└─────────────────┴───────┴─────────┴──────────┘\\n\u003Cspan class=\\\"sgr32\\\"\u003EEpoch 3 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:18\u003C\u002Fspan\u003E\\n┌───────────────┬───────┬─────────┬──────────┐\\n│\u003Cspan class=\\\"sgr1\\\"\u003E         Phase \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Epoch \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E    Loss \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Accuracy \u003C\u002Fspan\u003E│\\n├───────────────┼───────┼─────────┼──────────┤\\n│ TrainingPhase │   3.0 │ 1.36495 │  0.57273 │\\n└───────────────┴───────┴─────────┴──────────┘\\n\u003Cspan class=\\\"sgr32\\\"\u003EEpoch 3 ValidationPhase(): 100%|████████████████████████| Time: 0:00:02\u003C\u002Fspan\u003E\\n┌─────────────────┬───────┬─────────┬──────────┐\\n│\u003Cspan class=\\\"sgr1\\\"\u003E           Phase \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Epoch \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E    Loss \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Accuracy \u003C\u002Fspan\u003E│\\n├─────────────────┼───────┼─────────┼──────────┤\\n│ ValidationPhase │   3.0 │ 1.25941 │  0.59525 │\\n└─────────────────┴───────┴─────────┴──────────┘\\n\u003Cspan class=\\\"sgr32\\\"\u003EEpoch 4 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:20\u003C\u002Fspan\u003E\\n┌───────────────┬───────┬─────────┬──────────┐\\n│\u003Cspan class=\\\"sgr1\\\"\u003E         Phase \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Epoch \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E    Loss \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Accuracy \u003C\u002Fspan\u003E│\\n├───────────────┼───────┼─────────┼──────────┤\\n│ TrainingPhase │   4.0 │ 1.18935 │  0.64891 │\\n└───────────────┴───────┴─────────┴──────────┘\\n\u003Cspan class=\\\"sgr32\\\"\u003EEpoch 4 ValidationPhase(): 100%|████████████████████████| Time: 0:00:02\u003C\u002Fspan\u003E\\n┌─────────────────┬───────┬────────┬──────────┐\\n│\u003Cspan class=\\\"sgr1\\\"\u003E           Phase \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Epoch \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E   Loss \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Accuracy \u003C\u002Fspan\u003E│\\n├─────────────────┼───────┼────────┼──────────┤\\n│ ValidationPhase │   4.0 │ 1.1076 │  0.66347 │\\n└─────────────────┴───────┴────────┴──────────┘\\n\u003Cspan class=\\\"sgr32\\\"\u003EEpoch 5 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:19\u003C\u002Fspan\u003E\\n┌───────────────┬───────┬─────────┬──────────┐\\n│\u003Cspan class=\\\"sgr1\\\"\u003E         Phase \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Epoch \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E    Loss \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Accuracy \u003C\u002Fspan\u003E│\\n├───────────────┼───────┼─────────┼──────────┤\\n│ TrainingPhase │   5.0 │ 1.05506 │  0.69386 │\\n└───────────────┴───────┴─────────┴──────────┘\\n\u003Cspan class=\\\"sgr32\\\"\u003EEpoch 5 ValidationPhase(): 100%|████████████████████████| Time: 0:00:02\u003C\u002Fspan\u003E\\n┌─────────────────┬───────┬─────────┬──────────┐\\n│\u003Cspan class=\\\"sgr1\\\"\u003E           Phase \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Epoch \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E    Loss \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Accuracy \u003C\u002Fspan\u003E│\\n├─────────────────┼───────┼─────────┼──────────┤\\n│ ValidationPhase │   5.0 │ 0.99203 │  0.70275 │\\n└─────────────────┴───────┴─────────┴──────────┘\\n\u003Cspan class=\\\"sgr32\\\"\u003EEpoch 6 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:18\u003C\u002Fspan\u003E\\n┌───────────────┬───────┬─────────┬──────────┐\\n│\u003Cspan class=\\\"sgr1\\\"\u003E         Phase \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Epoch \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E    Loss \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Accuracy \u003C\u002Fspan\u003E│\\n├───────────────┼───────┼─────────┼──────────┤\\n│ TrainingPhase │   6.0 │ 0.95282 │  0.72533 │\\n└───────────────┴───────┴─────────┴──────────┘\\n\u003Cspan class=\\\"sgr32\\\"\u003EEpoch 6 ValidationPhase(): 100%|████████████████████████| Time: 0:00:02\u003C\u002Fspan\u003E\\n┌─────────────────┬───────┬─────────┬──────────┐\\n│\u003Cspan class=\\\"sgr1\\\"\u003E           Phase \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Epoch \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E    Loss \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Accuracy \u003C\u002Fspan\u003E│\\n├─────────────────┼───────┼─────────┼──────────┤\\n│ ValidationPhase │   6.0 │ 0.90209 │  0.73058 │\\n└─────────────────┴───────┴─────────┴──────────┘\\n\u003Cspan class=\\\"sgr32\\\"\u003EEpoch 7 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:19\u003C\u002Fspan\u003E\\n┌───────────────┬───────┬─────────┬──────────┐\\n│\u003Cspan class=\\\"sgr1\\\"\u003E         Phase \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Epoch \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E    Loss \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Accuracy \u003C\u002Fspan\u003E│\\n├───────────────┼───────┼─────────┼──────────┤\\n│ TrainingPhase │   7.0 │ 0.87621 │  0.74563 │\\n└───────────────┴───────┴─────────┴──────────┘\\n\u003Cspan class=\\\"sgr32\\\"\u003EEpoch 7 ValidationPhase(): 100%|████████████████████████| Time: 0:00:02\u003C\u002Fspan\u003E\\n┌─────────────────┬───────┬─────────┬──────────┐\\n│\u003Cspan class=\\\"sgr1\\\"\u003E           Phase \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Epoch \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E    Loss \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Accuracy \u003C\u002Fspan\u003E│\\n├─────────────────┼───────┼─────────┼──────────┤\\n│ ValidationPhase │   7.0 │ 0.83402 │  0.74781 │\\n└─────────────────┴───────┴─────────┴──────────┘\\n\u003Cspan class=\\\"sgr32\\\"\u003EEpoch 8 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:18\u003C\u002Fspan\u003E\\n┌───────────────┬───────┬─────────┬──────────┐\\n│\u003Cspan class=\\\"sgr1\\\"\u003E         Phase \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Epoch \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E    Loss \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Accuracy \u003C\u002Fspan\u003E│\\n├───────────────┼───────┼─────────┼──────────┤\\n│ TrainingPhase │   8.0 │ 0.81399 │  0.76282 │\\n└───────────────┴───────┴─────────┴──────────┘\\n\u003Cspan class=\\\"sgr32\\\"\u003EEpoch 8 ValidationPhase(): 100%|████████████████████████| Time: 0:00:02\u003C\u002Fspan\u003E\\n┌─────────────────┬───────┬─────────┬──────────┐\\n│\u003Cspan class=\\\"sgr1\\\"\u003E           Phase \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Epoch \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E    Loss \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Accuracy \u003C\u002Fspan\u003E│\\n├─────────────────┼───────┼─────────┼──────────┤\\n│ ValidationPhase │   8.0 │ 0.77623 │  0.76568 │\\n└─────────────────┴───────┴─────────┴──────────┘\\n\u003Cspan class=\\\"sgr32\\\"\u003EEpoch 9 TrainingPhase(): 100%|██████████████████████████| Time: 0:00:18\u003C\u002Fspan\u003E\\n┌───────────────┬───────┬─────────┬──────────┐\\n│\u003Cspan class=\\\"sgr1\\\"\u003E         Phase \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Epoch \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E    Loss \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Accuracy \u003C\u002Fspan\u003E│\\n├───────────────┼───────┼─────────┼──────────┤\\n│ TrainingPhase │   9.0 │ 0.76236 │  0.77835 │\\n└───────────────┴───────┴─────────┴──────────┘\\n\u003Cspan class=\\\"sgr32\\\"\u003EEpoch 9 ValidationPhase(): 100%|████████████████████████| Time: 0:00:02\u003C\u002Fspan\u003E\\n┌─────────────────┬───────┬─────────┬──────────┐\\n│\u003Cspan class=\\\"sgr1\\\"\u003E           Phase \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Epoch \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E    Loss \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Accuracy \u003C\u002Fspan\u003E│\\n├─────────────────┼───────┼─────────┼──────────┤\\n│ ValidationPhase │   9.0 │ 0.72606 │  0.78079 │\\n└─────────────────┴───────┴─────────┴──────────┘\\n\u003Cspan class=\\\"sgr32\\\"\u003EEpoch 10 TrainingPhase(): 100%|█████████████████████████| Time: 0:00:18\u003C\u002Fspan\u003E\\n┌───────────────┬───────┬─────────┬──────────┐\\n│\u003Cspan class=\\\"sgr1\\\"\u003E         Phase \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Epoch \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E    Loss \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Accuracy \u003C\u002Fspan\u003E│\\n├───────────────┼───────┼─────────┼──────────┤\\n│ TrainingPhase │  10.0 │ 0.71684 │  0.79175 │\\n└───────────────┴───────┴─────────┴──────────┘\\n\u003Cspan class=\\\"sgr32\\\"\u003EEpoch 10 ValidationPhase(): 100%|███████████████████████| Time: 0:00:02\u003C\u002Fspan\u003E\\n┌─────────────────┬───────┬─────────┬──────────┐\\n│\u003Cspan class=\\\"sgr1\\\"\u003E           Phase \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Epoch \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E    Loss \u003C\u002Fspan\u003E│\u003Cspan class=\\\"sgr1\\\"\u003E Accuracy \u003C\u002Fspan\u003E│\\n├─────────────────┼───────┼─────────┼──────────┤\\n│ ValidationPhase │  10.0 │ 0.68353 │  0.79449 │\\n└─────────────────┴───────┴─────────┴──────────┘\\n\"},\"type\":\"leaf\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"coderesult\",\"children\":[{\"attributes\":{},\"tag\":\"codeblock\",\"children\":[{\"mimes\":{\"text\u002Fhtml\":\"Learner()\"},\"type\":\"leaf\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}"}</script></div>
</body>

</html>