<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <!--     <link rel="icon" href="/favicon.png" /> -->
    <meta name="viewport" content="width=device-width, initial-scale=1" /> <meta http-equiv="content-security-policy" content="">
	<link rel="stylesheet" href="/FluxTraining.jl/internal/assets/pages/__layout.svelte-0fd2b479.css">
	<link rel="stylesheet" href="/FluxTraining.jl/internal/assets/pages/_version_/_...documentId_.svelte-5a01dd42.css">
	<link rel="modulepreload" href="/FluxTraining.jl/internal/start-3a3c726e.js">
	<link rel="modulepreload" href="/FluxTraining.jl/internal/chunks/index-832d6c3c.js">
	<link rel="modulepreload" href="/FluxTraining.jl/internal/chunks/singletons-83e66bf9.js">
	<link rel="modulepreload" href="/FluxTraining.jl/internal/chunks/paths-396f020f.js">
	<link rel="modulepreload" href="/FluxTraining.jl/internal/pages/__layout.svelte-5aa6b4c2.js">
	<link rel="modulepreload" href="/FluxTraining.jl/internal/pages/_version_/_...documentId_.svelte-62a99b76.js">
	<link rel="modulepreload" href="/FluxTraining.jl/internal/chunks/navigation-d32ded51.js">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fira+Mono:wght@400;500&display=swap');
        @import url('https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;600&display=swap');
    </style>
</head>

<body>
    <div id="svelte">




<div class="flex flex-col lg:flex-row max-w-full" style="height: 100vh; width: 100%;">
	



<div class="header border-gray-200 flex flex-col w-full border-b-[1px] lg:sticky lg:top-0 lg:w-72 lg:[min-width:18rem;] lg:max-h-screen lg:min-h-screen lg:h-screen lg:border-b-0 lg:border-r-[1px]"><div class="title flex flex-row items-center p-3"><span class="name content-center text-xl flex-grow font-bold"><a href="/FluxTraining.jl/dev/documents/README.md">FluxTraining.jl</a></span>
		<span class="openmenu cursor-pointer flex lg:hidden">
<svg data-carbon-icon="Menu24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" width="24" height="24" preserveAspectRatio="xMidYMid meet" aria-hidden focusable="false"><path d="M3 18H21V19.5H3zM3 13.5H21V15H3zM3 9H21V10.5H3zM3 4.5H21V6H3z"></path>
    
  </svg></span></div>

	<div class="menu p-3 flex-col hidden [box-shadow:inset_0_0_8px_rgba(0,0,0,.1)] border-t-[1px] lg:flex lg:[box-shadow:none] lg:border-t-0 "><div class="group svelte-16loc5n"><div class="grouptitle svelte-16loc5n">Search</div>
			<div class="searchwidget svelte-1lm1fh6" style="width: 100%; flex-grow: 3">
	<div class="searchfield svelte-1lm1fh6">
<svg data-carbon-icon="Search20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" fill="currentColor" width="20" height="20" preserveAspectRatio="xMidYMid meet" style="fill:gray; display:inline" aria-hidden focusable="false"><path d="M29,27.5859l-7.5521-7.5521a11.0177,11.0177,0,1,0-1.4141,1.4141L27.5859,29ZM4,13a9,9,0,1,1,9,9A9.01,9.01,0,0,1,4,13Z"></path>
    
  </svg>
		<input type="text" placeholder="Search for text or code" style="margin-left: 4px; flex-grow: 2; outline:none; background: inherit;" class="svelte-1lm1fh6" value="">

			
			</div>
	
</div></div>
		<div class="group svelte-16loc5n"><div class="grouptitle svelte-16loc5n">Pages</div>
			<div class="ml-1 mr-1">
	<div><a class="link svelte-1uqp1tf" href="/FluxTraining.jl/dev/documents/README.md">Overview</a></div>
	<div><a class="link svelte-1uqp1tf" href="/FluxTraining.jl/dev/documents/docs/getting_started.md">Getting started</a></div>
	<div><a class="link svelte-1uqp1tf" href="/FluxTraining.jl/dev/documents/docs/features.md">Features</a></div><div class="groupcontainer svelte-1uqp1tf"><div class="groupname svelte-1uqp1tf">
<svg data-carbon-icon="CaretDownGlyph" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 4" fill="currentColor" width="8" height="4" preserveAspectRatio="xMidYMid meet" style="display:inline; width: 8px" aria-hidden focusable="false"><path d="M8 0L4 4 0 0z"></path>
    
  </svg>
					<span class="pl-1">Tutorials</span></div>
				<div class="group svelte-1uqp1tf">
	<div><a class="link svelte-1uqp1tf" href="/FluxTraining.jl/dev/documents/docs/tutorials/mnist.ipynb">Train an image classifier</a></div>
	<div><a class="link svelte-1uqp1tf" href="/FluxTraining.jl/dev/documents/docs/callbacks/custom.md">Write a custom callback</a></div>
					</div>
			</div><div class="groupcontainer svelte-1uqp1tf"><div class="groupname svelte-1uqp1tf">
<svg data-carbon-icon="CaretDownGlyph" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 4" fill="currentColor" width="8" height="4" preserveAspectRatio="xMidYMid meet" style="display:inline; width: 8px" aria-hidden focusable="false"><path d="M8 0L4 4 0 0z"></path>
    
  </svg>
					<span class="pl-1">How to</span></div>
				<div class="group svelte-1uqp1tf">
	<div><a class="link svelte-1uqp1tf" href="/FluxTraining.jl/dev/documents/docs/callbacks/usage.md">Use callbacks</a></div>
	<div><a class="link svelte-1uqp1tf" href="/FluxTraining.jl/dev/documents/docs/callbacks/tipstricks.md">Tips &amp; Tricks</a></div>
					</div>
			</div><div class="groupcontainer svelte-1uqp1tf"><div class="groupname svelte-1uqp1tf">
<svg data-carbon-icon="CaretDownGlyph" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 4" fill="currentColor" width="8" height="4" preserveAspectRatio="xMidYMid meet" style="display:inline; width: 8px" aria-hidden focusable="false"><path d="M8 0L4 4 0 0z"></path>
    
  </svg>
					<span class="pl-1">Reference</span></div>
				<div class="group svelte-1uqp1tf">
	<div><a class="link svelte-1uqp1tf" href="/FluxTraining.jl/dev/references/FluxTraining">Module</a></div>
	<div><a class="link svelte-1uqp1tf" href="/FluxTraining.jl/dev/documents/docs/callbacks/reference.md">List of callbacks</a></div>
	<div><a class="link svelte-1uqp1tf" href="/FluxTraining.jl/dev/documents/docs/reference/training.md">Training loop API</a></div>
					</div>
			</div><div class="groupcontainer svelte-1uqp1tf"><div class="groupname svelte-1uqp1tf">
<svg data-carbon-icon="CaretDownGlyph" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 8 4" fill="currentColor" width="8" height="4" preserveAspectRatio="xMidYMid meet" style="display:inline; width: 8px" aria-hidden focusable="false"><path d="M8 0L4 4 0 0z"></path>
    
  </svg>
					<span class="pl-1">Backround</span></div>
				<div class="group svelte-1uqp1tf">
	<div><a class="link svelte-1uqp1tf" href="/FluxTraining.jl/dev/documents/docs/tutorials/hyperparameters.md">Hyperparameter scheduling</a></div>
	<div><a class="link svelte-1uqp1tf" href="/FluxTraining.jl/dev/documents/docs/tutorials/training.md">Custom training loops</a></div>
					</div>
			</div></div></div>

		
		

		
		
		<div class="group svelte-16loc5n"><div class="grouptitle svelte-16loc5n">Links</div>
			<a href="https://github.com/FluxML/FluxTraining.jl" class="text-gray-600 hover:text-gray-900">
<svg data-carbon-icon="LogoGithub24" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" fill="currentColor" width="24" height="24" preserveAspectRatio="xMidYMid meet" aria-hidden focusable="false"><path fill-rule="evenodd" d="M16,2a14,14,0,0,0-4.43,27.28c.7.13,1-.3,1-.67s0-1.21,0-2.38c-3.89.84-4.71-1.88-4.71-1.88A3.71,3.71,0,0,0,6.24,22.3c-1.27-.86.1-.85.1-.85A2.94,2.94,0,0,1,8.48,22.9a3,3,0,0,0,4.08,1.16,2.93,2.93,0,0,1,.88-1.87c-3.1-.36-6.37-1.56-6.37-6.92a5.4,5.4,0,0,1,1.44-3.76,5,5,0,0,1,.14-3.7s1.17-.38,3.85,1.43a13.3,13.3,0,0,1,7,0c2.67-1.81,3.84-1.43,3.84-1.43a5,5,0,0,1,.14,3.7,5.4,5.4,0,0,1,1.44,3.76c0,5.38-3.27,6.56-6.39,6.91a3.33,3.33,0,0,1,.95,2.59c0,1.87,0,3.38,0,3.84s.25.81,1,.67A14,14,0,0,0,16,2Z"></path>
    
  </svg></a></div></div>
</div>
	
	<div class="markdown overflow-scroll w-full lg:w-[700px] svelte-ee3m9d" style="height: 100vh;"><div class="markdown">
			<div class="md">
			<h1>
			Training loop</h1>
			<p>
			FluxTraining.jl comes with a training loop for standard supervised learning problems, but for different tasks like self-supervised learning, being able to write custom training logic is essential. The package’s training loop API requires little boilerplate to convert a regular Flux.jl training loop while making it compatible with existing callbacks.</p>
			<h2>
			Supervised training, step
			-
			by
			-
			step</h2>
			<p>
			We’ll explore the API step-by-step by converting a basic training loop and then discuss ways in which more complex training loops can be implemented using the same approach. The central piece of a training loop is the logic for a single training step, and in many cases, that will be all you need to implement. Below is the definition of a basic vanilla Flux.jl training step. It takes a batch of data, calculates the loss, gradients and finally updates the parameters of the model.</p>
			<pre class="codeblock codeblock svelte-vj8ryq"><code class="svelte-vj8ryq">
			<span class="julia">
			<span class="FUNCTION">
			<span class="FUNCTION">
			function</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.step!" class="reference symbol svelte-1weczaz">
			step!</a>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			model</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			batch</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			params</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			optimizer</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			lossfn</span>
			<span class="RPAREN">
			)</span></span>
			<span class="BLOCK">
			<span class="NEWLINE_WS">
			
    </span>
			<span class="EQ">
			<span class="TUPLE">
			<span class="IDENTIFIER">
			xs</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			ys</span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			batch</span></span>
			<span class="NEWLINE_WS">
			
    </span>
			<span class="EQ">
			<span class="IDENTIFIER">
			grads</span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="DO">
			<span class="CALL">
			<span class="IDENTIFIER">
			gradient</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			params</span>
			<span class="RPAREN">
			)</span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="DO">
			do</span>
			<span class="ANON_FUNC">
			<span class="TUPLE">
			<span class="NEWLINE_WS">
			
        </span></span>
			<span class="BLOCK">
			<span class="EQ">
			<span class="IDENTIFIER">
			ŷs</span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="IDENTIFIER">
			model</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			xs</span>
			<span class="RPAREN">
			)</span></span></span>
			<span class="NEWLINE_WS">
			
        </span>
			<span class="EQ">
			<span class="IDENTIFIER">
			loss</span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="IDENTIFIER">
			lossfn</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			ŷs</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			ys</span>
			<span class="RPAREN">
			)</span></span></span>
			<span class="NEWLINE_WS">
			
        </span>
			<span class="RETURN">
			<span class="RETURN">
			return</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			loss</span></span>
			<span class="NEWLINE_WS">
			
    </span></span>
			<span class="END">
			end</span></span></span></span>
			<span class="NEWLINE_WS">
			
    </span>
			<span class="CALL">
			<span class="IDENTIFIER">
			update!</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			optimizer</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			params</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			grads</span>
			<span class="RPAREN">
			)</span></span>
			<span class="NEWLINE_WS">
			
</span></span>
			<span class="END">
			end</span></span></span></code></pre>
			<p>
			To make a training step work with FluxTraining.jl and its callbacks, we need to</p>
			<ul>
			<li>
			<p>
			store data for a step so that callbacks can access it (e.g. 
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.Metrics" class="reference symbol svelte-1weczaz">
			<span class="code"><code class="codeinline ">
			Metrics</code></span></a>
			 uses 
			<span class="code"><code class="codeinline ">
			ys</code></span>
			 and 
			<span class="code"><code class="codeinline ">
			ŷs</code></span>
			 to evaluate metrics for each step); and</p></li>
			<li>
			<p>
			dispatch events so the callbacks are triggered</p></li></ul>
			<p>
			We first need to create a 
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.Phases.Phase" class="reference symbol svelte-1weczaz">
			<span class="code"><code class="codeinline ">
			Phase</code></span></a>
			 and implement a method for 
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.step!" class="reference symbol svelte-1weczaz">
			<span class="code"><code class="codeinline ">
			FluxTraining.step!</code></span></a>
			 that dispatches on the phase type. 
			<span class="code"><code class="codeinline ">
			Phase</code></span>
			s are used to define different training behaviors using the same API and to define callback functionality that is only run during certain phases. For example, 
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.Scheduler" class="reference symbol svelte-1weczaz">
			<span class="code"><code class="codeinline ">
			Scheduler</code></span></a>
			 only runs during 
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.Phases.AbstractTrainingPhase" class="reference symbol svelte-1weczaz">
			<span class="code"><code class="codeinline ">
			AbstractTrainingPhase</code></span></a>
			s but not during 
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.Phases.ValidationPhase" class="reference symbol svelte-1weczaz">
			<span class="code"><code class="codeinline ">
			ValidationPhase</code></span></a>
			. Let’s implement such a phase and method, moving the arguments inside a 
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.Learner" class="reference symbol svelte-1weczaz">
			<span class="code"><code class="codeinline ">
			Learner</code></span></a>
			 in the process.</p>
			<pre class="codeblock codeblock svelte-vj8ryq"><code class="svelte-vj8ryq">
			<span class="julia">
			struct MyTrainingPhase &lt;: FluxTraining.AbstractTrainingPhase

function FluxTraining.step!(learner, phase::MyTrainingPhase, batch)
    xs, ys = batch
    grads = gradient(learner.params) do
        ŷs = learner.model(xs)
        loss = learner.lossfn(ŷs, ys)
        return loss
    end
    update!(learner.optimizer, learner.params, grads)
end</span></code></pre>
			<p>
			Now we can already train a model using this implementation, for example using 
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.epoch!" class="reference symbol svelte-1weczaz">
			<span class="code"><code class="codeinline ">
			epoch!</code></span></a>
			<span class="code"><code class="codeinline ">
			(learner, MyTrainingPhase(), dataiter)</code></span>
			. However, no callbacks would be called, since we haven’t yet put in any logic that dispatches events or stores the step state. We can do both by using the helper function 
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.runstep" class="reference symbol svelte-1weczaz">
			<span class="code"><code class="codeinline ">
			runstep</code></span></a>
			 which takes care of runnning our step logic, dispatching a 
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.Events.StepBegin" class="reference symbol svelte-1weczaz">
			<span class="code"><code class="codeinline ">
			StepBegin</code></span></a>
			 and 
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.Events.StepEnd" class="reference symbol svelte-1weczaz">
			<span class="code"><code class="codeinline ">
			StepEnd</code></span></a>
			 event before and after and handling control flow exceptions like 
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.CancelStepException" class="reference symbol svelte-1weczaz">
			<span class="code"><code class="codeinline ">
			CancelStepException</code></span></a>
			. Additionally, 
			<span class="code"><code class="codeinline ">
			runstep</code></span>
			 gives us a function 
			<span class="code"><code class="codeinline ">
			handle</code></span>
			 which we can use to dispatch events inside the step, and 
			<span class="code"><code class="codeinline ">
			state</code></span>
			 a container for storing step state. Let’s use 
			<span class="code"><code class="codeinline ">
			runstep</code></span>
			 and store the variables of interest inside 
			<span class="code"><code class="codeinline ">
			state</code></span>
			:</p>
			<pre class="codeblock codeblock svelte-vj8ryq"><code class="svelte-vj8ryq">
			<span class="julia">
			<span class="FUNCTION">
			<span class="FUNCTION">
			function</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.step!" class="reference symbol svelte-1weczaz">
			step!</a>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			learner</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="DECLARATION">
			<span class="IDENTIFIER">
			phase</span>
			<span class="DECLARATION">
			::</span>
			<span class="IDENTIFIER">
			MyTrainingPhase</span></span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			batch</span>
			<span class="RPAREN">
			)</span></span>
			<span class="BLOCK">
			<span class="NEWLINE_WS">
			
    </span>
			<span class="EQ">
			<span class="TUPLE">
			<span class="IDENTIFIER">
			xs</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			ys</span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			batch</span></span>
			<span class="NEWLINE_WS">
			
    </span>
			<span class="DO">
			<span class="CALL">
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.runstep" class="reference symbol svelte-1weczaz">
			runstep</a>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			learner</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			phase</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="TUPLE">
			<span class="LPAREN">
			(</span>
			<span class="EQ">
			<span class="IDENTIFIER">
			xs</span>
			<span class="EQ">
			=</span>
			<span class="IDENTIFIER">
			xs</span></span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			<span class="IDENTIFIER">
			ys</span>
			<span class="EQ">
			=</span>
			<span class="IDENTIFIER">
			ys</span></span>
			<span class="RPAREN">
			)</span></span>
			<span class="RPAREN">
			)</span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="DO">
			do</span>
			<span class="ANON_FUNC">
			<span class="TUPLE">
			<span class="WHITESPACE">
			 </span>
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.handle" class="reference symbol svelte-1weczaz">
			handle</a>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			state</span></span>
			<span class="BLOCK">
			<span class="NEWLINE_WS">
			
        </span>
			<span class="EQ">
			<span class="DOT">
			<span class="IDENTIFIER">
			state</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			grads</span></span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="DO">
			<span class="CALL">
			<span class="IDENTIFIER">
			gradient</span>
			<span class="LPAREN">
			(</span>
			<span class="DOT">
			<span class="IDENTIFIER">
			learner</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			params</span></span></span>
			<span class="RPAREN">
			)</span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="DO">
			do</span>
			<span class="ANON_FUNC">
			<span class="TUPLE">
			<span class="NEWLINE_WS">
			
            </span></span>
			<span class="BLOCK">
			<span class="EQ">
			<span class="DOT">
			<span class="IDENTIFIER">
			state</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			ŷs</span></span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="DOT">
			<span class="IDENTIFIER">
			learner</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			model</span></span></span>
			<span class="LPAREN">
			(</span>
			<span class="DOT">
			<span class="IDENTIFIER">
			state</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			xs</span></span></span>
			<span class="RPAREN">
			)</span></span></span>
			<span class="NEWLINE_WS">
			
            </span>
			<span class="EQ">
			<span class="DOT">
			<span class="IDENTIFIER">
			state</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			loss</span></span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="DOT">
			<span class="IDENTIFIER">
			learner</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			lossfn</span></span></span>
			<span class="LPAREN">
			(</span>
			<span class="DOT">
			<span class="IDENTIFIER">
			state</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			ŷs</span></span></span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="DOT">
			<span class="IDENTIFIER">
			state</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			ys</span></span></span>
			<span class="RPAREN">
			)</span></span></span>
			<span class="NEWLINE_WS">
			
            </span>
			<span class="RETURN">
			<span class="RETURN">
			return</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			loss</span></span>
			<span class="NEWLINE_WS">
			
        </span></span>
			<span class="END">
			end</span></span></span></span>
			<span class="NEWLINE_WS">
			
        </span>
			<span class="CALL">
			<span class="IDENTIFIER">
			update!</span>
			<span class="LPAREN">
			(</span>
			<span class="DOT">
			<span class="IDENTIFIER">
			learner</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			optimizer</span></span></span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="DOT">
			<span class="IDENTIFIER">
			learner</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			params</span></span></span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			grads</span>
			<span class="RPAREN">
			)</span></span>
			<span class="NEWLINE_WS">
			
    </span></span>
			<span class="END">
			end</span></span></span>
			<span class="NEWLINE_WS">
			
</span></span>
			<span class="END">
			end</span></span></span></code></pre>
			<p>
			Now callbacks like 
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.Metrics" class="reference symbol svelte-1weczaz">
			<span class="code"><code class="codeinline ">
			Metrics</code></span></a>
			 can access variables like 
			<span class="code"><code class="codeinline ">
			ys</code></span>
			 through 
			<span class="code"><code class="codeinline ">
			learner.step</code></span>
			 (which is set to the last 
			<span class="code"><code class="codeinline ">
			state</code></span>
			). Finally, we can use 
			<span class="code"><code class="codeinline ">
			handle</code></span>
			 to dispatch additional events:</p>
			<pre class="codeblock codeblock svelte-vj8ryq"><code class="svelte-vj8ryq">
			<span class="julia">
			<span class="USING">
			<span class="COLON">
			<span class="USING">
			using</span>
			<span class="DOT">
			<span class="WHITESPACE">
			 </span>
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining" class="reference symbol svelte-1weczaz">
			FluxTraining</a>
			<span class="DOT">
			.</span>
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.Events" class="reference symbol svelte-1weczaz">
			Events</a></span>
			<span class="COLON">
			:</span>
			<span class="DOT">
			<span class="WHITESPACE">
			 </span>
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.Events.LossBegin" class="reference symbol svelte-1weczaz">
			LossBegin</a></span>
			<span class="COMMA">
			,</span>
			<span class="DOT">
			<span class="WHITESPACE">
			 </span>
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.Events.BackwardBegin" class="reference symbol svelte-1weczaz">
			BackwardBegin</a></span>
			<span class="COMMA">
			,</span>
			<span class="DOT">
			<span class="WHITESPACE">
			 </span>
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.Events.BackwardEnd" class="reference symbol svelte-1weczaz">
			BackwardEnd</a></span></span></span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="FUNCTION">
			<span class="FUNCTION">
			function</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.step!" class="reference symbol svelte-1weczaz">
			step!</a>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			learner</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="DECLARATION">
			<span class="IDENTIFIER">
			phase</span>
			<span class="DECLARATION">
			::</span>
			<span class="IDENTIFIER">
			MyTrainingPhase</span></span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			batch</span>
			<span class="RPAREN">
			)</span></span>
			<span class="BLOCK">
			<span class="NEWLINE_WS">
			
    </span>
			<span class="EQ">
			<span class="TUPLE">
			<span class="IDENTIFIER">
			xs</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			ys</span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			batch</span></span>
			<span class="NEWLINE_WS">
			
    </span>
			<span class="DO">
			<span class="CALL">
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.runstep" class="reference symbol svelte-1weczaz">
			runstep</a>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			learner</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			phase</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="TUPLE">
			<span class="LPAREN">
			(</span>
			<span class="EQ">
			<span class="IDENTIFIER">
			xs</span>
			<span class="EQ">
			=</span>
			<span class="IDENTIFIER">
			xs</span></span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			<span class="IDENTIFIER">
			ys</span>
			<span class="EQ">
			=</span>
			<span class="IDENTIFIER">
			ys</span></span>
			<span class="RPAREN">
			)</span></span>
			<span class="RPAREN">
			)</span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="DO">
			do</span>
			<span class="ANON_FUNC">
			<span class="TUPLE">
			<span class="WHITESPACE">
			 </span>
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.handle" class="reference symbol svelte-1weczaz">
			handle</a>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			state</span></span>
			<span class="BLOCK">
			<span class="NEWLINE_WS">
			
        </span>
			<span class="EQ">
			<span class="DOT">
			<span class="IDENTIFIER">
			state</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			grads</span></span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="DO">
			<span class="CALL">
			<span class="IDENTIFIER">
			gradient</span>
			<span class="LPAREN">
			(</span>
			<span class="DOT">
			<span class="IDENTIFIER">
			learner</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			params</span></span></span>
			<span class="RPAREN">
			)</span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="DO">
			do</span>
			<span class="ANON_FUNC">
			<span class="TUPLE">
			<span class="NEWLINE_WS">
			
            </span></span>
			<span class="BLOCK">
			<span class="EQ">
			<span class="DOT">
			<span class="IDENTIFIER">
			state</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			ŷs</span></span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="DOT">
			<span class="IDENTIFIER">
			learner</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			model</span></span></span>
			<span class="LPAREN">
			(</span>
			<span class="DOT">
			<span class="IDENTIFIER">
			state</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			xs</span></span></span>
			<span class="RPAREN">
			)</span></span></span>
			<span class="NEWLINE_WS">
			
            </span>
			<span class="CALL">
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.handle" class="reference symbol svelte-1weczaz">
			handle</a>
			<span class="LPAREN">
			(</span>
			<span class="CALL">
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.Events.LossBegin" class="reference symbol svelte-1weczaz">
			LossBegin</a>
			<span class="LPAREN">
			(</span>
			<span class="RPAREN">
			)</span></span>
			<span class="RPAREN">
			)</span></span>
			<span class="NEWLINE_WS">
			
            </span>
			<span class="EQ">
			<span class="DOT">
			<span class="IDENTIFIER">
			state</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			loss</span></span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="DOT">
			<span class="IDENTIFIER">
			learner</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			lossfn</span></span></span>
			<span class="LPAREN">
			(</span>
			<span class="DOT">
			<span class="IDENTIFIER">
			state</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			ŷs</span></span></span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="DOT">
			<span class="IDENTIFIER">
			state</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			ys</span></span></span>
			<span class="RPAREN">
			)</span></span></span>
			<span class="NEWLINE_WS">
			
            </span>
			<span class="CALL">
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.handle" class="reference symbol svelte-1weczaz">
			handle</a>
			<span class="LPAREN">
			(</span>
			<span class="CALL">
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.Events.BackwardBegin" class="reference symbol svelte-1weczaz">
			BackwardBegin</a>
			<span class="LPAREN">
			(</span>
			<span class="RPAREN">
			)</span></span>
			<span class="RPAREN">
			)</span></span>
			<span class="NEWLINE_WS">
			
            </span>
			<span class="RETURN">
			<span class="RETURN">
			return</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			loss</span></span>
			<span class="NEWLINE_WS">
			
        </span></span>
			<span class="END">
			end</span></span></span></span>
			<span class="NEWLINE_WS">
			
        </span>
			<span class="CALL">
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.handle" class="reference symbol svelte-1weczaz">
			handle</a>
			<span class="LPAREN">
			(</span>
			<span class="CALL">
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.Events.BackwardEnd" class="reference symbol svelte-1weczaz">
			BackwardEnd</a>
			<span class="LPAREN">
			(</span>
			<span class="RPAREN">
			)</span></span>
			<span class="RPAREN">
			)</span></span>
			<span class="NEWLINE_WS">
			
        </span>
			<span class="CALL">
			<span class="IDENTIFIER">
			update!</span>
			<span class="LPAREN">
			(</span>
			<span class="DOT">
			<span class="IDENTIFIER">
			learner</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			optimizer</span></span></span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="DOT">
			<span class="IDENTIFIER">
			learner</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			params</span></span></span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			grads</span>
			<span class="RPAREN">
			)</span></span>
			<span class="NEWLINE_WS">
			
    </span></span>
			<span class="END">
			end</span></span></span>
			<span class="NEWLINE_WS">
			
</span></span>
			<span class="END">
			end</span></span></span></code></pre>
			<p>
			The result is the full implementation of FluxTraining.jl’s own 
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.Phases.TrainingPhase" class="reference symbol svelte-1weczaz">
			<span class="code"><code class="codeinline ">
			TrainingPhase</code></span></a>
			! Now we can use 
			<span class="code"><code class="codeinline ">
			epoch!</code></span>
			 to train a 
			<span class="code"><code class="codeinline ">
			Learner</code></span>
			 with full support for 
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/documents/docs/callbacks/reference.md" class="reference document svelte-1weczaz">
			all callbacks</a>
			:</p>
			<pre class="codeblock codeblock svelte-vj8ryq"><code class="svelte-vj8ryq">
			<span class="julia">
			<span class="FOR">
			<span class="FOR">
			for</span>
			<span class="EQ">
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			i</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IN">
			in</span>
			<span class="CALL">
			<span class="WHITESPACE">
			 </span>
			<span class="INTEGER">
			1</span>
			<span class="COLON">
			:</span>
			<span class="INTEGER">
			10</span></span></span>
			<span class="BLOCK">
			<span class="NEWLINE_WS">
			
    </span>
			<span class="CALL">
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.epoch!" class="reference symbol svelte-1weczaz">
			epoch!</a>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			learner</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="IDENTIFIER">
			MyTrainingPhase</span>
			<span class="LPAREN">
			(</span>
			<span class="RPAREN">
			)</span></span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			dataiter</span>
			<span class="RPAREN">
			)</span></span>
			<span class="NEWLINE_WS">
			
</span></span>
			<span class="END">
			end</span></span></span></code></pre>
			<h2>
			Validation</h2>
			<p>
			The implementation of 
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.Phases.ValidationPhase" class="reference symbol svelte-1weczaz">
			<span class="code"><code class="codeinline ">
			ValidationPhase</code></span></a>
			 is even simpler; it runs the forward pass and stores variables so that callbacks like 
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.Metrics" class="reference symbol svelte-1weczaz">
			<span class="code"><code class="codeinline ">
			Metrics</code></span></a>
			 can access them.</p>
			<pre class="codeblock codeblock svelte-vj8ryq"><code class="svelte-vj8ryq">
			<span class="julia">
			<span class="STRUCT">
			<span class="FALSE">
			</span>
			<span class="STRUCT">
			struct</span>
			<span class="ISSUBTYPE">
			<span class="WHITESPACE">
			 </span>
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.Phases.ValidationPhase" class="reference symbol svelte-1weczaz">
			ValidationPhase</a>
			<span class="WHITESPACE">
			 </span>
			<span class="ISSUBTYPE">
			&lt;:</span>
			<span class="WHITESPACE">
			 </span>
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.Phases.AbstractValidationPhase" class="reference symbol svelte-1weczaz">
			AbstractValidationPhase</a></span>
			<span class="BLOCK">
			<span class="WHITESPACE">
			 </span></span>
			<span class="END">
			end</span></span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="FUNCTION">
			<span class="FUNCTION">
			function</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.step!" class="reference symbol svelte-1weczaz">
			step!</a>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			learner</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="DECLARATION">
			<span class="IDENTIFIER">
			phase</span>
			<span class="DECLARATION">
			::</span>
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.Phases.ValidationPhase" class="reference symbol svelte-1weczaz">
			ValidationPhase</a></span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			batch</span>
			<span class="RPAREN">
			)</span></span>
			<span class="BLOCK">
			<span class="NEWLINE_WS">
			
    </span>
			<span class="EQ">
			<span class="TUPLE">
			<span class="IDENTIFIER">
			xs</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			ys</span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			batch</span></span>
			<span class="NEWLINE_WS">
			
    </span>
			<span class="DO">
			<span class="CALL">
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.runstep" class="reference symbol svelte-1weczaz">
			runstep</a>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			learner</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			phase</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="TUPLE">
			<span class="LPAREN">
			(</span>
			<span class="EQ">
			<span class="IDENTIFIER">
			xs</span>
			<span class="EQ">
			=</span>
			<span class="IDENTIFIER">
			xs</span></span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			<span class="IDENTIFIER">
			ys</span>
			<span class="EQ">
			=</span>
			<span class="IDENTIFIER">
			ys</span></span>
			<span class="RPAREN">
			)</span></span>
			<span class="RPAREN">
			)</span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="DO">
			do</span>
			<span class="ANON_FUNC">
			<span class="TUPLE">
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			_</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			state</span></span>
			<span class="BLOCK">
			<span class="NEWLINE_WS">
			
        </span>
			<span class="EQ">
			<span class="DOT">
			<span class="IDENTIFIER">
			state</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			ŷs</span></span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="DOT">
			<span class="IDENTIFIER">
			learner</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			model</span></span></span>
			<span class="LPAREN">
			(</span>
			<span class="DOT">
			<span class="IDENTIFIER">
			state</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			xs</span></span></span>
			<span class="RPAREN">
			)</span></span></span>
			<span class="NEWLINE_WS">
			
        </span>
			<span class="EQ">
			<span class="DOT">
			<span class="IDENTIFIER">
			state</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			loss</span></span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="DOT">
			<span class="IDENTIFIER">
			learner</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			lossfn</span></span></span>
			<span class="LPAREN">
			(</span>
			<span class="DOT">
			<span class="IDENTIFIER">
			state</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			ŷs</span></span></span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="DOT">
			<span class="IDENTIFIER">
			state</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			ys</span></span></span>
			<span class="RPAREN">
			)</span></span></span>
			<span class="NEWLINE_WS">
			
    </span></span>
			<span class="END">
			end</span></span></span>
			<span class="NEWLINE_WS">
			
</span></span>
			<span class="END">
			end</span></span></span></code></pre>
			<h2>
			Epoch logic</h2>
			<p>
			We didn’t need to implement a custom 
			<span class="code"><code class="codeinline ">
			epoch!</code></span>
			 method for our phase since the default is fine here: it just iterates over every batch and calls 
			<span class="code"><code class="codeinline ">
			step!</code></span>
			. In fact, let’s have a look at how 
			<span class="code"><code class="codeinline ">
			epoch!</code></span>
			 is implemented:</p>
			<pre class="codeblock codeblock svelte-vj8ryq"><code class="svelte-vj8ryq">
			<span class="julia">
			<span class="FUNCTION">
			<span class="FUNCTION">
			function</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.epoch!" class="reference symbol svelte-1weczaz">
			epoch!</a>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			learner</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="DECLARATION">
			<span class="IDENTIFIER">
			phase</span>
			<span class="DECLARATION">
			::</span>
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.Phases.Phase" class="reference symbol svelte-1weczaz">
			Phase</a></span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			dataiter</span>
			<span class="RPAREN">
			)</span></span>
			<span class="BLOCK">
			<span class="NEWLINE_WS">
			
    </span>
			<span class="DO">
			<span class="CALL">
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.runepoch" class="reference symbol svelte-1weczaz">
			runepoch</a>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			learner</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			phase</span>
			<span class="RPAREN">
			)</span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="DO">
			do</span>
			<span class="ANON_FUNC">
			<span class="TUPLE">
			<span class="WHITESPACE">
			 </span>
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.handle" class="reference symbol svelte-1weczaz">
			handle</a></span>
			<span class="BLOCK">
			<span class="NEWLINE_WS">
			
        </span>
			<span class="FOR">
			<span class="FOR">
			for</span>
			<span class="EQ">
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			batch</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IN">
			in</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			dataiter</span></span>
			<span class="BLOCK">
			<span class="NEWLINE_WS">
			
            </span>
			<span class="CALL">
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.step!" class="reference symbol svelte-1weczaz">
			step!</a>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			learner</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			phase</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			batch</span>
			<span class="RPAREN">
			)</span></span>
			<span class="NEWLINE_WS">
			
        </span></span>
			<span class="END">
			end</span></span>
			<span class="NEWLINE_WS">
			
    </span></span>
			<span class="END">
			end</span></span></span>
			<span class="NEWLINE_WS">
			
</span></span>
			<span class="END">
			end</span></span></span></code></pre>
			<p>
			Here, 
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.runepoch" class="reference symbol svelte-1weczaz">
			<span class="code"><code class="codeinline ">
			runepoch</code></span></a>
			, similarly to 
			<span class="code"><code class="codeinline ">
			runstep</code></span>
			, takes care of epoch start/stop events and control flow. If you want more control over your training loop, you can use it to write training loops that directly use 
			<span class="code"><code class="codeinline ">
			step!</code></span>
			:</p>
			<pre class="codeblock codeblock svelte-vj8ryq"><code class="svelte-vj8ryq">
			<span class="julia">
			<span class="EQ">
			<span class="IDENTIFIER">
			phase</span>
			<span class="WHITESPACE">
			 </span>
			<span class="EQ">
			=</span>
			<span class="WHITESPACE">
			 </span>
			<span class="CALL">
			<span class="IDENTIFIER">
			MyTrainingPhase</span>
			<span class="LPAREN">
			(</span>
			<span class="RPAREN">
			)</span></span></span>
			<span class="NEWLINE_WS">
			
</span>
			<span class="DO">
			<span class="CALL">
			<span class="IDENTIFIER">
			withepoch</span>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			learner</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			phase</span>
			<span class="RPAREN">
			)</span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="DO">
			do</span>
			<span class="ANON_FUNC">
			<span class="TUPLE">
			<span class="WHITESPACE">
			 </span>
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.handle" class="reference symbol svelte-1weczaz">
			handle</a></span>
			<span class="BLOCK">
			<span class="NEWLINE_WS">
			
    </span>
			<span class="FOR">
			<span class="FOR">
			for</span>
			<span class="EQ">
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			batch</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IN">
			in</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			dataiter</span></span>
			<span class="BLOCK">
			<span class="NEWLINE_WS">
			
        </span>
			<span class="CALL">
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.step!" class="reference symbol svelte-1weczaz">
			step!</a>
			<span class="LPAREN">
			(</span>
			<span class="IDENTIFIER">
			learner</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			phase</span>
			<span class="COMMA">
			,</span>
			<span class="WHITESPACE">
			 </span>
			<span class="IDENTIFIER">
			batch</span>
			<span class="RPAREN">
			)</span></span>
			<span class="NEWLINE_WS">
			
        </span>
			<span class="IF">
			<span class="IF">
			if</span>
			<span class="CALL">
			<span class="WHITESPACE">
			 </span>
			<span class="DOT">
			<span class="DOT">
			<span class="IDENTIFIER">
			learner</span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			step</span></span></span>
			<span class="DOT">
			.</span>
			<span class="QUOTE">
			<span class="IDENTIFIER">
			loss</span></span></span>
			<span class="WHITESPACE">
			 </span>
			<span class="LESS">
			&lt;</span>
			<span class="WHITESPACE">
			 </span>
			<span class="FLOAT">
			0.1</span></span>
			<span class="BLOCK">
			<span class="NEWLINE_WS">
			
            </span>
			<span class="CALL">
			<span class="IDENTIFIER">
			throw</span>
			<span class="LPAREN">
			(</span>
			<span class="CALL">
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.CancelFittingException" class="reference symbol svelte-1weczaz">
			CancelFittingException</a>
			<span class="LPAREN">
			(</span>
			<span class="DQUOTE">
			&quot;</span>
			<span class="STRING">
			Low loss reached.</span>
			<span class="DQUOTE">
			&quot;</span>
			<span class="RPAREN">
			)</span></span>
			<span class="RPAREN">
			)</span></span>
			<span class="NEWLINE_WS">
			
        </span></span>
			<span class="END">
			end</span></span>
			<span class="NEWLINE_WS">
			
    </span></span>
			<span class="END">
			end</span></span>
			<span class="NEWLINE_WS">
			
</span></span>
			<span class="END">
			end</span></span></span></span></code></pre>
			<h2>
			Tips</h2>
			<p>
			Here are some additional tips for making it easier to implement complicated training loops.</p>
			<ul>
			<li>
			<p>
			You can pass (named) tuples of models to the 
			<span class="code"><code class="codeinline ">
			Learner</code></span>
			 constructor. For example, for generative adversarial training, you can pass in 
			<span class="code"><code class="codeinline ">
			(generator = ..., critic = ...)</code></span>
			 and then refer to them inside the 
			<span class="code"><code class="codeinline ">
			step!</code></span>
			 implementation, e.g. using 
			<span class="code"><code class="codeinline ">
			learner.model.generator</code></span>
			. The models’ parameters will have the same structure, i.e. 
			<span class="code"><code class="codeinline ">
			learner.params.generator</code></span>
			 corresponds to 
			<span class="code"><code class="codeinline ">
			params(learner.model.generator)</code></span>
			.</p></li>
			<li>
			<p>
			You can store any data you want in 
			<span class="code"><code class="codeinline ">
			state</code></span>
			.</p></li>
			<li>
			<p>
			When defining a custom phase, instead of subtyping 
			<span class="code"><code class="codeinline ">
			Phase</code></span>
			 you can subtype 
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.Phases.AbstractTrainingPhase" class="reference symbol svelte-1weczaz">
			<span class="code"><code class="codeinline ">
			AbstractTrainingPhase</code></span></a>
			 or 
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.Phases.AbstractValidationPhase" class="reference symbol svelte-1weczaz">
			<span class="code"><code class="codeinline ">
			AbstractValidationPhase</code></span></a>
			 so that some context-specific callbacks will work out of the box with your phase type. For example, 
			
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/references/FluxTraining.Scheduler" class="reference symbol svelte-1weczaz">
			<span class="code"><code class="codeinline ">
			Scheduler</code></span></a>
			 sets hyperparameter values only during 
			<span class="code"><code class="codeinline ">
			AbstractTrainingPhase</code></span>
			.</p></li></ul></div></div>

<div class="more"><div class="admonition"><div class="admonitiontitle">
<svg data-carbon-icon="Link20" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 32 32" fill="currentColor" width="20" height="20" class="icon" preserveAspectRatio="xMidYMid meet" aria-hidden focusable="false"><path d="M29.25,6.76a6,6,0,0,0-8.5,0l1.42,1.42a4,4,0,1,1,5.67,5.67l-8,8a4,4,0,1,1-5.67-5.66l1.41-1.42-1.41-1.42-1.42,1.42a6,6,0,0,0,0,8.5A6,6,0,0,0,17,25a6,6,0,0,0,4.27-1.76l8-8A6,6,0,0,0,29.25,6.76Z"></path><path d="M4.19,24.82a4,4,0,0,1,0-5.67l8-8a4,4,0,0,1,5.67,0A3.94,3.94,0,0,1,19,14a4,4,0,0,1-1.17,2.85L15.71,19l1.42,1.42,2.12-2.12a6,6,0,0,0-8.51-8.51l-8,8a6,6,0,0,0,0,8.51A6,6,0,0,0,7,28a6.07,6.07,0,0,0,4.28-1.76L9.86,24.82A4,4,0,0,1,4.19,24.82Z"></path>
    
  </svg> Backlinks</div>
	<div class="admonitionbody"><div class="backlinks svelte-ytmwmt"><p>The following pages link back here:</p>
				<p>
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/documents/docs/callbacks/custom.md" class="reference document svelte-1weczaz">Custom callbacks</a>, 
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/documents/docs/background/dataiterator.md" class="reference document svelte-1weczaz">Data iterators</a>, 
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/documents/README.md" class="reference document svelte-1weczaz">FluxTraining.jl</a>, 
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/documents/docs/background/model.md" class="reference document svelte-1weczaz">Models</a>, 
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/documents/CHANGELOG.md" class="reference document svelte-1weczaz">News</a>, 
	
		<a sveltekit:prefetch href="/FluxTraining.jl/dev/documents/docs/reference/training.md" class="reference document svelte-1weczaz">Training loop API reference</a></p>
				<p></p>
				<p></p></div></div>
</div></div></div>
</div>


		<script type="module" data-hydrate="1tqcgi">
		import { start } from "/FluxTraining.jl/internal/start-3a3c726e.js";
		start({
			target: document.querySelector('[data-hydrate="1tqcgi"]').parentNode,
			paths: {"base":"/FluxTraining.jl","assets":"/FluxTraining.jl"},
			session: {},
			route: true,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/FluxTraining.jl/internal/pages/__layout.svelte-5aa6b4c2.js"),
						import("/FluxTraining.jl/internal/pages/_version_/_...documentId_.svelte-62a99b76.js")
				],
				params: {version:"dev",documentId:"documents\u002Fdocs\u002Ftutorials\u002Ftraining.md"},
				routeId: "[version]/[...documentId]"
			}
		});
	</script><script type="application/json" sveltekit:data-type="data" sveltekit:data-url="/FluxTraining.jl/api/dev/attributes.json">{"status":200,"statusText":"","headers":{"content-type":"application/json; charset=utf-8"},"body":"{\"documents/CHANGELOG.md\":{\"tag\":\"document\",\"title\":\"News\"},\"references/FluxTraining.HyperParameter\":{\"tag\":\"documentation\",\"title\":\"HyperParameter\"},\"sourcefiles/FluxTraining/src/callbacks/scheduler.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/scheduler.jl\"},\"references/FluxTraining.savemodel\":{\"tag\":\"documentation\",\"title\":\"savemodel\"},\"references/FluxTraining.CheckModelLossStep\":{\"tag\":\"documentation\",\"title\":\"CheckModelLossStep\"},\"references/FluxTraining.CancelStepException\":{\"tag\":\"documentation\",\"title\":\"CancelStepException\"},\"references/FluxTraining.ConflictResolution\":{\"tag\":\"documentation\",\"title\":\"ConflictResolution\"},\"references/FluxTraining.replacecallback!\":{\"tag\":\"documentation\",\"title\":\"replacecallback!\"},\"documents/docs/tutorials/hyperparameters.md\":{\"tag\":\"document\",\"title\":\"Hyperparameter scheduling\"},\"sourcefiles/FluxTraining/src/callbacks/metrics.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/metrics.jl\"},\"references/FluxTraining.##InlineTest-01b48f5c342f65df7fcd07f28f0d2cacbb09f0a0.tests\":{\"tag\":\"documentation\",\"title\":\"tests\"},\"references/FluxTraining.print_epoch_table\":{\"tag\":\"documentation\",\"title\":\"print_epoch_table\"},\"references/FluxTraining.log_to\":{\"tag\":\"documentation\",\"title\":\"log_to\"},\"references/FluxTraining.@pack_History!\":{\"tag\":\"documentation\",\"title\":\"@pack_History!\"},\"references/FluxTraining.AbstractCallback\":{\"tag\":\"documentation\",\"title\":\"AbstractCallback\"},\"references/FluxTraining.getindexperm\":{\"tag\":\"documentation\",\"title\":\"getindexperm\"},\"sourcefiles/FluxTraining/src/callbacks/custom.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/custom.jl\"},\"references/FluxTraining.Phases.ValidationPhase\":{\"tag\":\"documentation\",\"title\":\"ValidationPhase\"},\"references/FluxTraining.iterpairs\":{\"tag\":\"documentation\",\"title\":\"iterpairs\"},\"references/FluxTraining.Callback\":{\"tag\":\"documentation\",\"title\":\"Callback\"},\"references/FluxTraining.StopOnNaNLoss\":{\"tag\":\"documentation\",\"title\":\"StopOnNaNLoss\"},\"references/FluxTraining.Protected\":{\"tag\":\"documentation\",\"title\":\"Protected\"},\"references/FluxTraining.Events.StepBegin\":{\"tag\":\"documentation\",\"title\":\"StepBegin\"},\"documents/LICENSE.md\":{\"tag\":\"document\",\"title\":\"LICENSE\"},\"references/FluxTraining.AbstractMetric\":{\"tag\":\"documentation\",\"title\":\"AbstractMetric\"},\"documents/docs/tutorials/mnist.ipynb\":{\"tag\":\"document\",\"title\":\"Training an image classifier\"},\"references/FluxTraining.@pack_History\":{\"tag\":\"documentation\",\"title\":\"@pack_History\"},\"references/FluxTraining.edgesrunafter\":{\"tag\":\"documentation\",\"title\":\"edgesrunafter\"},\"references/FluxTraining.LinearRunner\":{\"tag\":\"documentation\",\"title\":\"LinearRunner\"},\"references/FluxTraining.protect\":{\"tag\":\"documentation\",\"title\":\"protect\"},\"references/FluxTraining.formataccess\":{\"tag\":\"documentation\",\"title\":\"formataccess\"},\"references/FluxTraining.resolveconflict\":{\"tag\":\"documentation\",\"title\":\"resolveconflict\"},\"documents/docs/callbacks/reference.md\":{\"tag\":\"document\",\"title\":\"Callback reference\"},\"references/FluxTraining.Loggables\":{\"tag\":\"documentation\",\"title\":\"Loggables\"},\"references/FluxTraining.setlearningrate!\":{\"tag\":\"documentation\",\"title\":\"setlearningrate!\"},\"references/FluxTraining.stepvalue\":{\"tag\":\"documentation\",\"title\":\"stepvalue\"},\"sourcefiles/FluxTraining/src/training.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/training.jl\"},\"sourcefiles/FluxTraining/src/callbacks/hyperparameters.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/hyperparameters.jl\"},\"references/FluxTraining.@unpack_History\":{\"tag\":\"documentation\",\"title\":\"@unpack_History\"},\"references/FluxTraining.ProtectedException\":{\"tag\":\"documentation\",\"title\":\"ProtectedException\"},\"references/FluxTraining.FrequencyThrottle\":{\"tag\":\"documentation\",\"title\":\"FrequencyThrottle\"},\"references/FluxTraining.RunFirst\":{\"tag\":\"documentation\",\"title\":\"RunFirst\"},\"references/FluxTraining.Events.StepEnd\":{\"tag\":\"documentation\",\"title\":\"StepEnd\"},\"references/FluxTraining.SanityCheck\":{\"tag\":\"documentation\",\"title\":\"SanityCheck\"},\"references/FluxTraining.ToDevice\":{\"tag\":\"documentation\",\"title\":\"ToDevice\"},\"references/FluxTraining._on\":{\"tag\":\"documentation\",\"title\":\"_on\"},\"references/FluxTraining.Loggables.Audio\":{\"tag\":\"documentation\",\"title\":\"Audio\"},\"documents/docs/imagenette_demo.ipynb\":{\"tag\":\"document\",\"title\":\"imagenette_demo\"},\"sourcefiles/FluxTraining/src/callbacks/protect.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/protect.jl\"},\"references/FluxTraining.Loggables.Image\":{\"tag\":\"documentation\",\"title\":\"Image\"},\"references/FluxTraining.CustomCallback\":{\"tag\":\"documentation\",\"title\":\"CustomCallback\"},\"sourcefiles/FluxTraining/src/callbacks/logging/logger.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/logging/logger.jl\"},\"references/FluxTraining._dataiters\":{\"tag\":\"documentation\",\"title\":\"_dataiters\"},\"references/FluxTraining.ToGPU\":{\"tag\":\"documentation\",\"title\":\"ToGPU\"},\"sourcefiles/FluxTraining/src/functional/metrics.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/functional/metrics.jl\"},\"references/FluxTraining.##InlineTest-01b48f5c342f65df7fcd07f28f0d2cacbb09f0a0.TESTSET_MACROS\":{\"tag\":\"documentation\",\"title\":\"TESTSET_MACROS\"},\"references/FluxTraining.on\":{\"tag\":\"documentation\",\"title\":\"on\"},\"references/FluxTraining.accuracy\":{\"tag\":\"documentation\",\"title\":\"accuracy\"},\"sourcefiles/FluxTraining/src/callbackutils.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbackutils.jl\"},\"references/FluxTraining.Check\":{\"tag\":\"documentation\",\"title\":\"Check\"},\"references/FluxTraining.throttle\":{\"tag\":\"documentation\",\"title\":\"throttle\"},\"references/FluxTraining.Callbacks\":{\"tag\":\"documentation\",\"title\":\"Callbacks\"},\"references/FluxTraining.LearningRate\":{\"tag\":\"documentation\",\"title\":\"LearningRate\"},\"references/FluxTraining.Metric\":{\"tag\":\"documentation\",\"title\":\"Metric\"},\"references/FluxTraining.FitException\":{\"tag\":\"documentation\",\"title\":\"FitException\"},\"sourcefiles/FluxTraining/src/callbacks/graph.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/graph.jl\"},\"documents/docs/background/lossfunction.md\":{\"tag\":\"document\",\"title\":\"Loss functions\"},\"sourcefiles/FluxTraining/src/FluxTraining.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/FluxTraining.jl\"},\"sourcefiles/FluxTraining/src/callbacks/execution.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/execution.jl\"},\"references/FluxTraining.setupoptimstate\":{\"tag\":\"documentation\",\"title\":\"setupoptimstate\"},\"references/FluxTraining._combinename\":{\"tag\":\"documentation\",\"title\":\"_combinename\"},\"references/FluxTraining.testbatch\":{\"tag\":\"documentation\",\"title\":\"testbatch\"},\"references/FluxTraining.Phases.AbstractTrainingPhase\":{\"tag\":\"documentation\",\"title\":\"AbstractTrainingPhase\"},\"references/FluxTraining.stateaccess\":{\"tag\":\"documentation\",\"title\":\"stateaccess\"},\"documents/README.md\":{\"tag\":\"document\",\"title\":\"FluxTraining.jl\"},\"references/FluxTraining.GarbageCollect\":{\"tag\":\"documentation\",\"title\":\"GarbageCollect\"},\"sourcefiles/FluxTraining/src/callbacks/logging/Loggables.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/logging/Loggables.jl\"},\"references/FluxTraining.runtests\":{\"tag\":\"documentation\",\"title\":\"runtests\"},\"references/FluxTraining.Loggables.Graph\":{\"tag\":\"documentation\",\"title\":\"Graph\"},\"references/FluxTraining.LogVisualization\":{\"tag\":\"documentation\",\"title\":\"LogVisualization\"},\"references/FluxTraining.Events\":{\"tag\":\"documentation\",\"title\":\"Events\"},\"references/FluxTraining.NoConflict\":{\"tag\":\"documentation\",\"title\":\"NoConflict\"},\"references/FluxTraining.defaultcallbacks\":{\"tag\":\"documentation\",\"title\":\"defaultcallbacks\"},\"references/FluxTraining.Events.Event\":{\"tag\":\"documentation\",\"title\":\"Event\"},\"references/FluxTraining.Learner\":{\"tag\":\"documentation\",\"title\":\"Learner\"},\"references/FluxTraining.setindexperm!\":{\"tag\":\"documentation\",\"title\":\"setindexperm!\"},\"references/FluxTraining.CancelFittingException\":{\"tag\":\"documentation\",\"title\":\"CancelFittingException\"},\"references/FluxTraining.metricname\":{\"tag\":\"documentation\",\"title\":\"metricname\"},\"references/FluxTraining.ES\":{\"tag\":\"documentation\",\"title\":\"ES\"},\"references/FluxTraining.runafter\":{\"tag\":\"documentation\",\"title\":\"runafter\"},\"references/FluxTraining.MetricsPrinter\":{\"tag\":\"documentation\",\"title\":\"MetricsPrinter\"},\"references/FluxTraining.hasconflict\":{\"tag\":\"documentation\",\"title\":\"hasconflict\"},\"references/FluxTraining._update!\":{\"tag\":\"documentation\",\"title\":\"_update!\"},\"references/FluxTraining.runchecks\":{\"tag\":\"documentation\",\"title\":\"runchecks\"},\"references/FluxTraining.TimeThrottle\":{\"tag\":\"documentation\",\"title\":\"TimeThrottle\"},\"sourcefiles/FluxTraining/src/callbacks/sanitycheck.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/sanitycheck.jl\"},\"references/FluxTraining.ConditionalCallback\":{\"tag\":\"documentation\",\"title\":\"ConditionalCallback\"},\"references/FluxTraining.LogHyperParams\":{\"tag\":\"documentation\",\"title\":\"LogHyperParams\"},\"references/FluxTraining.History\":{\"tag\":\"documentation\",\"title\":\"History\"},\"references/FluxTraining.Scheduler\":{\"tag\":\"documentation\",\"title\":\"Scheduler\"},\"references/FluxTraining.Phases.TrainingPhase\":{\"tag\":\"documentation\",\"title\":\"TrainingPhase\"},\"documents/docs/background/model.md\":{\"tag\":\"document\",\"title\":\"Models\"},\"references/FluxTraining.Checkpointer\":{\"tag\":\"documentation\",\"title\":\"Checkpointer\"},\"references/FluxTraining.Events.BackwardEnd\":{\"tag\":\"documentation\",\"title\":\"BackwardEnd\"},\"references/FluxTraining.Loggables.Histogram\":{\"tag\":\"documentation\",\"title\":\"Histogram\"},\"references/FluxTraining.CheckIteratesTuples\":{\"tag\":\"documentation\",\"title\":\"CheckIteratesTuples\"},\"references/FluxTraining.phasedataiter\":{\"tag\":\"documentation\",\"title\":\"phasedataiter\"},\"references/FluxTraining.EarlyStopping\":{\"tag\":\"documentation\",\"title\":\"EarlyStopping\"},\"references/FluxTraining.sethyperparameter!\":{\"tag\":\"documentation\",\"title\":\"sethyperparameter!\"},\"references/FluxTraining.Write\":{\"tag\":\"documentation\",\"title\":\"Write\"},\"references/FluxTraining.Events.EpochEnd\":{\"tag\":\"documentation\",\"title\":\"EpochEnd\"},\"references/FluxTraining.callbackgraph\":{\"tag\":\"documentation\",\"title\":\"callbackgraph\"},\"references/FluxTraining.Phases\":{\"tag\":\"documentation\",\"title\":\"Phases\"},\"references/FluxTraining.TensorBoardBackend\":{\"tag\":\"documentation\",\"title\":\"TensorBoardBackend\"},\"documents/docs/background/optimizer.md\":{\"tag\":\"document\",\"title\":\"Optimizers\"},\"references/FluxTraining.testlearner\":{\"tag\":\"documentation\",\"title\":\"testlearner\"},\"references/FluxTraining.epochvalue\":{\"tag\":\"documentation\",\"title\":\"epochvalue\"},\"documents/docs/getting_started.md\":{\"tag\":\"document\",\"title\":\"Getting started\"},\"references/FluxTraining.garbagecollect\":{\"tag\":\"documentation\",\"title\":\"garbagecollect\"},\"documents/docs/custom_training.ipynb\":{\"tag\":\"document\",\"title\":\"Custom training loops\"},\"references/FluxTraining.epoch!\":{\"tag\":\"documentation\",\"title\":\"epoch!\"},\"references/FluxTraining.SmoothLoss\":{\"tag\":\"documentation\",\"title\":\"SmoothLoss\"},\"references/FluxTraining.Phases.Phase\":{\"tag\":\"documentation\",\"title\":\"Phase\"},\"references/FluxTraining.setcallbacks!\":{\"tag\":\"documentation\",\"title\":\"setcallbacks!\"},\"references/FluxTraining.Unresolvable\":{\"tag\":\"documentation\",\"title\":\"Unresolvable\"},\"references/FluxTraining\":{\"tag\":\"documentation\",\"title\":\"FluxTraining\"},\"references/FluxTraining.testbatches\":{\"tag\":\"documentation\",\"title\":\"testbatches\"},\"documents/docs/overview.md\":{\"tag\":\"document\",\"title\":\"Getting started\"},\"references/FluxTraining.accesses\":{\"tag\":\"documentation\",\"title\":\"accesses\"},\"documents/docs/callbacks/tipstricks.md\":{\"tag\":\"document\",\"title\":\"Tips & tricks\"},\"references/FluxTraining.Phases.AbstractValidationPhase\":{\"tag\":\"documentation\",\"title\":\"AbstractValidationPhase\"},\"sourcefiles/FluxTraining/src/callbacks/recorder.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/recorder.jl\"},\"references/FluxTraining.NotDefined\":{\"tag\":\"documentation\",\"title\":\"NotDefined\"},\"references/FluxTraining.findconflicts\":{\"tag\":\"documentation\",\"title\":\"findconflicts\"},\"references/FluxTraining.Loggables.Text\":{\"tag\":\"documentation\",\"title\":\"Text\"},\"references/FluxTraining.PropDict\":{\"tag\":\"documentation\",\"title\":\"PropDict\"},\"documents/docs/callbacks/usage.md\":{\"tag\":\"document\",\"title\":\"How to use callbacks\"},\"references/FluxTraining.Events.LossBegin\":{\"tag\":\"documentation\",\"title\":\"LossBegin\"},\"references/FluxTraining.Recorder\":{\"tag\":\"documentation\",\"title\":\"Recorder\"},\"references/FluxTraining.LogMetrics\":{\"tag\":\"documentation\",\"title\":\"LogMetrics\"},\"references/FluxTraining.fit!\":{\"tag\":\"documentation\",\"title\":\"fit!\"},\"references/FluxTraining.SanityCheckException\":{\"tag\":\"documentation\",\"title\":\"SanityCheckException\"},\"references/FluxTraining.UnsafeCallback\":{\"tag\":\"documentation\",\"title\":\"UnsafeCallback\"},\"sourcefiles/FluxTraining/src/callbacks/callbacks.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/callbacks.jl\"},\"references/FluxTraining.CancelEpochException\":{\"tag\":\"documentation\",\"title\":\"CancelEpochException\"},\"references/FluxTraining.Permission\":{\"tag\":\"documentation\",\"title\":\"Permission\"},\"sourcefiles/FluxTraining/src/testutils.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/testutils.jl\"},\"references/FluxTraining.runstep\":{\"tag\":\"documentation\",\"title\":\"runstep\"},\"references/FluxTraining.removecallback!\":{\"tag\":\"documentation\",\"title\":\"removecallback!\"},\"references/FluxTraining.CallbackRunner\":{\"tag\":\"documentation\",\"title\":\"CallbackRunner\"},\"references/FluxTraining.addcallback!\":{\"tag\":\"documentation\",\"title\":\"addcallback!\"},\"references/FluxTraining._gradient\":{\"tag\":\"documentation\",\"title\":\"_gradient\"},\"references/FluxTraining.CheckDataIteratorTrain\":{\"tag\":\"documentation\",\"title\":\"CheckDataIteratorTrain\"},\"references/FluxTraining.reset!\":{\"tag\":\"documentation\",\"title\":\"reset!\"},\"sourcefiles/FluxTraining/src/callbacks/callback.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/callback.jl\"},\"references/FluxTraining.Events.BackwardBegin\":{\"tag\":\"documentation\",\"title\":\"BackwardBegin\"},\"sourcefiles/FluxTraining/src/learner.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/learner.jl\"},\"references/FluxTraining.Loss\":{\"tag\":\"documentation\",\"title\":\"Loss\"},\"sourcefiles/FluxTraining/src/callbacks/phases.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/phases.jl\"},\"references/FluxTraining.runepoch\":{\"tag\":\"documentation\",\"title\":\"runepoch\"},\"sourcefiles/FluxTraining/src/callbacks/conditional.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/conditional.jl\"},\"documents/docs/features.md\":{\"tag\":\"document\",\"title\":\"Features\"},\"references/FluxTraining.LogHistograms\":{\"tag\":\"documentation\",\"title\":\"LogHistograms\"},\"references/FluxTraining.shouldrun\":{\"tag\":\"documentation\",\"title\":\"shouldrun\"},\"sourcefiles/FluxTraining/src/callbacks/events.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/events.jl\"},\"references/FluxTraining.init!\":{\"tag\":\"documentation\",\"title\":\"init!\"},\"references/FluxTraining.##InlineTest-01b48f5c342f65df7fcd07f28f0d2cacbb09f0a0.__init__\":{\"tag\":\"documentation\",\"title\":\"__init__\"},\"references/FluxTraining.setfieldperm!\":{\"tag\":\"documentation\",\"title\":\"setfieldperm!\"},\"references/FluxTraining.getfieldperm\":{\"tag\":\"documentation\",\"title\":\"getfieldperm\"},\"references/FluxTraining.CHECKS\":{\"tag\":\"documentation\",\"title\":\"CHECKS\"},\"documents/docs/reference/training.md\":{\"tag\":\"document\",\"title\":\"Training loop API reference\"},\"references/FluxTraining.Loggables.File\":{\"tag\":\"documentation\",\"title\":\"File\"},\"references/FluxTraining.Metrics\":{\"tag\":\"documentation\",\"title\":\"Metrics\"},\"references/FluxTraining.log_parameters\":{\"tag\":\"documentation\",\"title\":\"log_parameters\"},\"references/FluxTraining.model!\":{\"tag\":\"documentation\",\"title\":\"model!\"},\"references/FluxTraining.Events.EpochBegin\":{\"tag\":\"documentation\",\"title\":\"EpochBegin\"},\"references/FluxTraining.CallbackCondition\":{\"tag\":\"documentation\",\"title\":\"CallbackCondition\"},\"sourcefiles/FluxTraining/src/callbacks/logging/checkpointer.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/logging/checkpointer.jl\"},\"references/FluxTraining.onecycle\":{\"tag\":\"documentation\",\"title\":\"onecycle\"},\"references/FluxTraining.loadmodel\":{\"tag\":\"documentation\",\"title\":\"loadmodel\"},\"sourcefiles/FluxTraining/src/callbacks/earlystopping.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/earlystopping.jl\"},\"references/FluxTraining.Loggables.Loggable\":{\"tag\":\"documentation\",\"title\":\"Loggable\"},\"references/FluxTraining.Read\":{\"tag\":\"documentation\",\"title\":\"Read\"},\"references/FluxTraining.step!\":{\"tag\":\"documentation\",\"title\":\"step!\"},\"references/FluxTraining.ProgressPrinter\":{\"tag\":\"documentation\",\"title\":\"ProgressPrinter\"},\"references/FluxTraining.getcallback\":{\"tag\":\"documentation\",\"title\":\"getcallback\"},\"references/FluxTraining.handle\":{\"tag\":\"documentation\",\"title\":\"handle\"},\"documents/docs/tutorials/training.md\":{\"tag\":\"document\",\"title\":\"Training loop\"},\"references/FluxTraining._resolveconflict\":{\"tag\":\"documentation\",\"title\":\"_resolveconflict\"},\"references/FluxTraining.SafeCallback\":{\"tag\":\"documentation\",\"title\":\"SafeCallback\"},\"documents/docs/callbacks/custom.md\":{\"tag\":\"document\",\"title\":\"Custom callbacks\"},\"sourcefiles/FluxTraining/src/callbacks/logging/tensorboard.jl\":{\"tag\":\"sourcefile\",\"title\":\"FluxTraining/src/callbacks/logging/tensorboard.jl\"},\"references/FluxTraining.CheckDataIteratorValid\":{\"tag\":\"documentation\",\"title\":\"CheckDataIteratorValid\"},\"references/FluxTraining.errorwriteconflict\":{\"tag\":\"documentation\",\"title\":\"errorwriteconflict\"},\"references/FluxTraining.Loggables.Value\":{\"tag\":\"documentation\",\"title\":\"Value\"},\"references/FluxTraining.TestModel\":{\"tag\":\"documentation\",\"title\":\"TestModel\"},\"references/FluxTraining.LoggerBackend\":{\"tag\":\"documentation\",\"title\":\"LoggerBackend\"},\"documents/docs/background/dataiterator.md\":{\"tag\":\"document\",\"title\":\"Data iterators\"}}"}</script>
	<script type="application/json" sveltekit:data-type="data" sveltekit:data-url="/FluxTraining.jl/api/dev/config.json">{"status":200,"statusText":"","headers":{"content-type":"application/json; charset=utf-8"},"body":"{\"linktree\":{\"Overview\":\"documents/README.md\",\"Getting started\":\"documents/docs/getting_started.md\",\"Features\":\"documents/docs/features.md\",\"Tutorials\":{\"Train an image classifier\":\"documents/docs/tutorials/mnist.ipynb\",\"Write a custom callback\":\"documents/docs/callbacks/custom.md\"},\"How to\":{\"Use callbacks\":\"documents/docs/callbacks/usage.md\",\"Tips & Tricks\":\"documents/docs/callbacks/tipstricks.md\"},\"Reference\":{\"Module\":\"references/FluxTraining\",\"List of callbacks\":\"documents/docs/callbacks/reference.md\",\"Training loop API\":\"documents/docs/reference/training.md\"},\"Backround\":{\"Hyperparameter scheduling\":\"documents/docs/tutorials/hyperparameters.md\",\"Custom training loops\":\"documents/docs/tutorials/training.md\"}},\"columnWidth\":650,\"title\":\"FluxTraining.jl\",\"url\":\"https://github.com/FluxML/FluxTraining.jl\",\"defaultDocument\":\"documents/README.md\"}"}</script>
	<script type="application/json" sveltekit:data-type="data" sveltekit:data-url="/FluxTraining.jl/api/dev/searchindex.json">{"status":200,"statusText":"","headers":{"content-type":"application/json; charset=utf-8"},"body":"{\"version\":\"2.3.9\",\"fields\":[\"title\",\"body\"],\"fieldVectors\":[[\"title/documents/CHANGELOG.md\",[0,4.934]],[\"body/documents/CHANGELOG.md\",[]],[\"title/references/FluxTraining.HyperParameter\",[1,4.404]],[\"body/references/FluxTraining.HyperParameter\",[]],[\"title/references/FluxTraining.savemodel\",[2,4.934]],[\"body/references/FluxTraining.savemodel\",[]],[\"title/references/FluxTraining.CheckModelLossStep\",[3,4.934]],[\"body/references/FluxTraining.CheckModelLossStep\",[]],[\"title/references/FluxTraining.CancelStepException\",[4,4.934]],[\"body/references/FluxTraining.CancelStepException\",[]],[\"title/references/FluxTraining.ConflictResolution\",[5,4.934]],[\"body/references/FluxTraining.ConflictResolution\",[]],[\"title/references/FluxTraining.replacecallback!\",[6,4.934]],[\"body/references/FluxTraining.replacecallback!\",[]],[\"title/documents/docs/tutorials/hyperparameters.md\",[1,3.176,7,3.176]],[\"body/documents/docs/tutorials/hyperparameters.md\",[]],[\"title/references/FluxTraining.##InlineTest-01b48f5c342f65df7fcd07f28f0d2cacbb09f0a0.tests\",[8,4.934]],[\"body/references/FluxTraining.##InlineTest-01b48f5c342f65df7fcd07f28f0d2cacbb09f0a0.tests\",[]],[\"title/references/FluxTraining.print_epoch_table\",[9,4.934]],[\"body/references/FluxTraining.print_epoch_table\",[]],[\"title/references/FluxTraining.log_to\",[10,4.934]],[\"body/references/FluxTraining.log_to\",[]],[\"title/references/FluxTraining.@pack_History!\",[11,4.404]],[\"body/references/FluxTraining.@pack_History!\",[]],[\"title/references/FluxTraining.AbstractCallback\",[12,4.934]],[\"body/references/FluxTraining.AbstractCallback\",[]],[\"title/references/FluxTraining.getindexperm\",[13,4.934]],[\"body/references/FluxTraining.getindexperm\",[]],[\"title/references/FluxTraining.Phases.ValidationPhase\",[14,4.934]],[\"body/references/FluxTraining.Phases.ValidationPhase\",[]],[\"title/references/FluxTraining.iterpairs\",[15,4.934]],[\"body/references/FluxTraining.iterpairs\",[]],[\"title/references/FluxTraining.Callback\",[16,3.586]],[\"body/references/FluxTraining.Callback\",[]],[\"title/references/FluxTraining.StopOnNaNLoss\",[17,4.934]],[\"body/references/FluxTraining.StopOnNaNLoss\",[]],[\"title/references/FluxTraining.Protected\",[18,4.404]],[\"body/references/FluxTraining.Protected\",[]],[\"title/references/FluxTraining.Events.StepBegin\",[19,4.934]],[\"body/references/FluxTraining.Events.StepBegin\",[]],[\"title/documents/LICENSE.md\",[20,4.934]],[\"body/documents/LICENSE.md\",[]],[\"title/references/FluxTraining.AbstractMetric\",[21,4.934]],[\"body/references/FluxTraining.AbstractMetric\",[]],[\"title/documents/docs/tutorials/mnist.ipynb\",[22,2.139,23,2.484,24,2.783]],[\"body/documents/docs/tutorials/mnist.ipynb\",[]],[\"title/references/FluxTraining.@pack_History\",[11,4.404]],[\"body/references/FluxTraining.@pack_History\",[]],[\"title/references/FluxTraining.edgesrunafter\",[25,4.934]],[\"body/references/FluxTraining.edgesrunafter\",[]],[\"title/references/FluxTraining.LinearRunner\",[26,4.934]],[\"body/references/FluxTraining.LinearRunner\",[]],[\"title/references/FluxTraining.protect\",[18,4.404]],[\"body/references/FluxTraining.protect\",[]],[\"title/references/FluxTraining.formataccess\",[27,4.934]],[\"body/references/FluxTraining.formataccess\",[]],[\"title/references/FluxTraining.resolveconflict\",[28,4.934]],[\"body/references/FluxTraining.resolveconflict\",[]],[\"title/documents/docs/callbacks/reference.md\",[16,2.586,29,3.176]],[\"body/documents/docs/callbacks/reference.md\",[]],[\"title/references/FluxTraining.Loggables\",[30,4.404]],[\"body/references/FluxTraining.Loggables\",[]],[\"title/references/FluxTraining.setlearningrate!\",[31,4.934]],[\"body/references/FluxTraining.setlearningrate!\",[]],[\"title/references/FluxTraining.stepvalue\",[32,4.934]],[\"body/references/FluxTraining.stepvalue\",[]],[\"title/references/FluxTraining.@unpack_History\",[33,4.934]],[\"body/references/FluxTraining.@unpack_History\",[]],[\"title/references/FluxTraining.ProtectedException\",[34,4.934]],[\"body/references/FluxTraining.ProtectedException\",[]],[\"title/references/FluxTraining.FrequencyThrottle\",[35,4.934]],[\"body/references/FluxTraining.FrequencyThrottle\",[]],[\"title/references/FluxTraining.RunFirst\",[36,4.934]],[\"body/references/FluxTraining.RunFirst\",[]],[\"title/references/FluxTraining.Events.StepEnd\",[37,4.934]],[\"body/references/FluxTraining.Events.StepEnd\",[]],[\"title/references/FluxTraining.SanityCheck\",[38,4.934]],[\"body/references/FluxTraining.SanityCheck\",[]],[\"title/references/FluxTraining.ToDevice\",[39,4.934]],[\"body/references/FluxTraining.ToDevice\",[]],[\"title/references/FluxTraining._on\",[40,4.934]],[\"body/references/FluxTraining._on\",[]],[\"title/references/FluxTraining.Loggables.Audio\",[41,4.934]],[\"body/references/FluxTraining.Loggables.Audio\",[]],[\"title/documents/docs/imagenette_demo.ipynb\",[42,4.934]],[\"body/documents/docs/imagenette_demo.ipynb\",[]],[\"title/references/FluxTraining.Loggables.Image\",[23,4.404]],[\"body/references/FluxTraining.Loggables.Image\",[]],[\"title/references/FluxTraining.CustomCallback\",[43,4.934]],[\"body/references/FluxTraining.CustomCallback\",[]],[\"title/references/FluxTraining._dataiters\",[44,4.934]],[\"body/references/FluxTraining._dataiters\",[]],[\"title/references/FluxTraining.ToGPU\",[45,4.934]],[\"body/references/FluxTraining.ToGPU\",[]],[\"title/references/FluxTraining.##InlineTest-01b48f5c342f65df7fcd07f28f0d2cacbb09f0a0.TESTSET_MACROS\",[46,4.934]],[\"body/references/FluxTraining.##InlineTest-01b48f5c342f65df7fcd07f28f0d2cacbb09f0a0.TESTSET_MACROS\",[]],[\"title/references/FluxTraining.on\",[]],[\"body/references/FluxTraining.on\",[]],[\"title/references/FluxTraining.accuracy\",[47,4.934]],[\"body/references/FluxTraining.accuracy\",[]],[\"title/references/FluxTraining.Check\",[48,4.404]],[\"body/references/FluxTraining.Check\",[]],[\"title/references/FluxTraining.throttle\",[49,4.934]],[\"body/references/FluxTraining.throttle\",[]],[\"title/references/FluxTraining.Callbacks\",[16,3.586]],[\"body/references/FluxTraining.Callbacks\",[]],[\"title/references/FluxTraining.LearningRate\",[50,4.934]],[\"body/references/FluxTraining.LearningRate\",[]],[\"title/references/FluxTraining.Metric\",[51,4.404]],[\"body/references/FluxTraining.Metric\",[]],[\"title/references/FluxTraining.FitException\",[52,4.934]],[\"body/references/FluxTraining.FitException\",[]],[\"title/documents/docs/background/lossfunction.md\",[53,3.176,54,3.558]],[\"body/documents/docs/background/lossfunction.md\",[]],[\"title/references/FluxTraining.setupoptimstate\",[55,4.934]],[\"body/references/FluxTraining.setupoptimstate\",[]],[\"title/references/FluxTraining._combinename\",[56,4.934]],[\"body/references/FluxTraining._combinename\",[]],[\"title/references/FluxTraining.testbatch\",[57,4.404]],[\"body/references/FluxTraining.testbatch\",[]],[\"title/references/FluxTraining.Phases.AbstractTrainingPhase\",[58,4.934]],[\"body/references/FluxTraining.Phases.AbstractTrainingPhase\",[]],[\"title/references/FluxTraining.stateaccess\",[59,4.934]],[\"body/references/FluxTraining.stateaccess\",[]],[\"title/documents/README.md\",[60,4.934]],[\"body/documents/README.md\",[]],[\"title/references/FluxTraining.GarbageCollect\",[61,4.404]],[\"body/references/FluxTraining.GarbageCollect\",[]],[\"title/references/FluxTraining.runtests\",[62,4.934]],[\"body/references/FluxTraining.runtests\",[]],[\"title/references/FluxTraining.Loggables.Graph\",[63,4.934]],[\"body/references/FluxTraining.Loggables.Graph\",[]],[\"title/references/FluxTraining.LogVisualization\",[64,4.934]],[\"body/references/FluxTraining.LogVisualization\",[]],[\"title/references/FluxTraining.Events\",[65,4.404]],[\"body/references/FluxTraining.Events\",[]],[\"title/references/FluxTraining.NoConflict\",[66,4.934]],[\"body/references/FluxTraining.NoConflict\",[]],[\"title/references/FluxTraining.defaultcallbacks\",[67,4.934]],[\"body/references/FluxTraining.defaultcallbacks\",[]],[\"title/references/FluxTraining.Events.Event\",[65,4.404]],[\"body/references/FluxTraining.Events.Event\",[]],[\"title/references/FluxTraining.Learner\",[68,4.934]],[\"body/references/FluxTraining.Learner\",[]],[\"title/references/FluxTraining.setindexperm!\",[69,4.934]],[\"body/references/FluxTraining.setindexperm!\",[]],[\"title/references/FluxTraining.CancelFittingException\",[70,4.934]],[\"body/references/FluxTraining.CancelFittingException\",[]],[\"title/references/FluxTraining.metricname\",[71,4.934]],[\"body/references/FluxTraining.metricname\",[]],[\"title/references/FluxTraining.ES\",[72,4.934]],[\"body/references/FluxTraining.ES\",[]],[\"title/references/FluxTraining.runafter\",[73,4.934]],[\"body/references/FluxTraining.runafter\",[]],[\"title/references/FluxTraining.MetricsPrinter\",[74,4.934]],[\"body/references/FluxTraining.MetricsPrinter\",[]],[\"title/references/FluxTraining.hasconflict\",[75,4.934]],[\"body/references/FluxTraining.hasconflict\",[]],[\"title/references/FluxTraining._update!\",[76,4.934]],[\"body/references/FluxTraining._update!\",[]],[\"title/references/FluxTraining.runchecks\",[77,4.934]],[\"body/references/FluxTraining.runchecks\",[]],[\"title/references/FluxTraining.TimeThrottle\",[78,4.934]],[\"body/references/FluxTraining.TimeThrottle\",[]],[\"title/references/FluxTraining.ConditionalCallback\",[79,4.934]],[\"body/references/FluxTraining.ConditionalCallback\",[]],[\"title/references/FluxTraining.LogHyperParams\",[80,4.934]],[\"body/references/FluxTraining.LogHyperParams\",[]],[\"title/references/FluxTraining.History\",[81,4.934]],[\"body/references/FluxTraining.History\",[]],[\"title/references/FluxTraining.Scheduler\",[7,4.404]],[\"body/references/FluxTraining.Scheduler\",[]],[\"title/references/FluxTraining.Phases.TrainingPhase\",[82,4.934]],[\"body/references/FluxTraining.Phases.TrainingPhase\",[]],[\"title/documents/docs/background/model.md\",[83,4.404]],[\"body/documents/docs/background/model.md\",[]],[\"title/references/FluxTraining.Checkpointer\",[84,4.934]],[\"body/references/FluxTraining.Checkpointer\",[]],[\"title/references/FluxTraining.Events.BackwardEnd\",[85,4.934]],[\"body/references/FluxTraining.Events.BackwardEnd\",[]],[\"title/references/FluxTraining.Loggables.Histogram\",[86,4.934]],[\"body/references/FluxTraining.Loggables.Histogram\",[]],[\"title/references/FluxTraining.CheckIteratesTuples\",[87,4.934]],[\"body/references/FluxTraining.CheckIteratesTuples\",[]],[\"title/references/FluxTraining.phasedataiter\",[88,4.934]],[\"body/references/FluxTraining.phasedataiter\",[]],[\"title/references/FluxTraining.EarlyStopping\",[89,4.934]],[\"body/references/FluxTraining.EarlyStopping\",[]],[\"title/references/FluxTraining.sethyperparameter!\",[90,4.934]],[\"body/references/FluxTraining.sethyperparameter!\",[]],[\"title/references/FluxTraining.Write\",[91,4.934]],[\"body/references/FluxTraining.Write\",[]],[\"title/references/FluxTraining.Events.EpochEnd\",[92,4.934]],[\"body/references/FluxTraining.Events.EpochEnd\",[]],[\"title/references/FluxTraining.callbackgraph\",[93,4.934]],[\"body/references/FluxTraining.callbackgraph\",[]],[\"title/references/FluxTraining.Phases\",[94,4.404]],[\"body/references/FluxTraining.Phases\",[]],[\"title/references/FluxTraining.TensorBoardBackend\",[95,4.934]],[\"body/references/FluxTraining.TensorBoardBackend\",[]],[\"title/documents/docs/background/optimizer.md\",[96,4.934]],[\"body/documents/docs/background/optimizer.md\",[]],[\"title/references/FluxTraining.testlearner\",[97,4.934]],[\"body/references/FluxTraining.testlearner\",[]],[\"title/references/FluxTraining.epochvalue\",[98,4.934]],[\"body/references/FluxTraining.epochvalue\",[]],[\"title/documents/docs/getting_started.md\",[99,3.176,100,3.176]],[\"body/documents/docs/getting_started.md\",[]],[\"title/references/FluxTraining.garbagecollect\",[61,4.404]],[\"body/references/FluxTraining.garbagecollect\",[]],[\"title/documents/docs/custom_training.ipynb\",[22,2.139,101,2.484,102,2.287]],[\"body/documents/docs/custom_training.ipynb\",[]],[\"title/references/FluxTraining.epoch!\",[103,4.934]],[\"body/references/FluxTraining.epoch!\",[]],[\"title/references/FluxTraining.SmoothLoss\",[104,4.934]],[\"body/references/FluxTraining.SmoothLoss\",[]],[\"title/references/FluxTraining.Phases.Phase\",[94,4.404]],[\"body/references/FluxTraining.Phases.Phase\",[]],[\"title/references/FluxTraining.setcallbacks!\",[105,4.934]],[\"body/references/FluxTraining.setcallbacks!\",[]],[\"title/references/FluxTraining.Unresolvable\",[106,4.934]],[\"body/references/FluxTraining.Unresolvable\",[]],[\"title/references/FluxTraining\",[107,4.934]],[\"body/references/FluxTraining\",[]],[\"title/references/FluxTraining.testbatches\",[57,4.404]],[\"body/references/FluxTraining.testbatches\",[]],[\"title/documents/docs/overview.md\",[99,3.176,100,3.176]],[\"body/documents/docs/overview.md\",[]],[\"title/references/FluxTraining.accesses\",[108,4.934]],[\"body/references/FluxTraining.accesses\",[]],[\"title/documents/docs/callbacks/tipstricks.md\",[109,2.783,110,2.783,111,2.783]],[\"body/documents/docs/callbacks/tipstricks.md\",[]],[\"title/references/FluxTraining.Phases.AbstractValidationPhase\",[112,4.934]],[\"body/references/FluxTraining.Phases.AbstractValidationPhase\",[]],[\"title/references/FluxTraining.NotDefined\",[113,4.934]],[\"body/references/FluxTraining.NotDefined\",[]],[\"title/references/FluxTraining.findconflicts\",[114,4.934]],[\"body/references/FluxTraining.findconflicts\",[]],[\"title/references/FluxTraining.Loggables.Text\",[115,4.934]],[\"body/references/FluxTraining.Loggables.Text\",[]],[\"title/references/FluxTraining.PropDict\",[116,4.934]],[\"body/references/FluxTraining.PropDict\",[]],[\"title/documents/docs/callbacks/usage.md\",[16,2.586,117,3.558]],[\"body/documents/docs/callbacks/usage.md\",[]],[\"title/references/FluxTraining.Events.LossBegin\",[118,4.934]],[\"body/references/FluxTraining.Events.LossBegin\",[]],[\"title/references/FluxTraining.Recorder\",[119,4.934]],[\"body/references/FluxTraining.Recorder\",[]],[\"title/references/FluxTraining.LogMetrics\",[120,4.934]],[\"body/references/FluxTraining.LogMetrics\",[]],[\"title/references/FluxTraining.fit!\",[121,4.934]],[\"body/references/FluxTraining.fit!\",[]],[\"title/references/FluxTraining.SanityCheckException\",[122,4.934]],[\"body/references/FluxTraining.SanityCheckException\",[]],[\"title/references/FluxTraining.UnsafeCallback\",[123,4.934]],[\"body/references/FluxTraining.UnsafeCallback\",[]],[\"title/references/FluxTraining.CancelEpochException\",[124,4.934]],[\"body/references/FluxTraining.CancelEpochException\",[]],[\"title/references/FluxTraining.Permission\",[125,4.934]],[\"body/references/FluxTraining.Permission\",[]],[\"title/references/FluxTraining.runstep\",[126,4.934]],[\"body/references/FluxTraining.runstep\",[]],[\"title/references/FluxTraining.removecallback!\",[127,4.934]],[\"body/references/FluxTraining.removecallback!\",[]],[\"title/references/FluxTraining.CallbackRunner\",[128,4.934]],[\"body/references/FluxTraining.CallbackRunner\",[]],[\"title/references/FluxTraining.addcallback!\",[129,4.934]],[\"body/references/FluxTraining.addcallback!\",[]],[\"title/references/FluxTraining._gradient\",[130,4.934]],[\"body/references/FluxTraining._gradient\",[]],[\"title/references/FluxTraining.CheckDataIteratorTrain\",[131,4.934]],[\"body/references/FluxTraining.CheckDataIteratorTrain\",[]],[\"title/references/FluxTraining.reset!\",[132,4.934]],[\"body/references/FluxTraining.reset!\",[]],[\"title/references/FluxTraining.Events.BackwardBegin\",[133,4.934]],[\"body/references/FluxTraining.Events.BackwardBegin\",[]],[\"title/references/FluxTraining.Loss\",[53,4.404]],[\"body/references/FluxTraining.Loss\",[]],[\"title/references/FluxTraining.runepoch\",[134,4.934]],[\"body/references/FluxTraining.runepoch\",[]],[\"title/documents/docs/features.md\",[135,4.934]],[\"body/documents/docs/features.md\",[]],[\"title/references/FluxTraining.LogHistograms\",[136,4.934]],[\"body/references/FluxTraining.LogHistograms\",[]],[\"title/references/FluxTraining.shouldrun\",[137,4.934]],[\"body/references/FluxTraining.shouldrun\",[]],[\"title/references/FluxTraining.init!\",[138,4.934]],[\"body/references/FluxTraining.init!\",[]],[\"title/references/FluxTraining.##InlineTest-01b48f5c342f65df7fcd07f28f0d2cacbb09f0a0.__init__\",[139,4.934]],[\"body/references/FluxTraining.##InlineTest-01b48f5c342f65df7fcd07f28f0d2cacbb09f0a0.__init__\",[]],[\"title/references/FluxTraining.setfieldperm!\",[140,4.934]],[\"body/references/FluxTraining.setfieldperm!\",[]],[\"title/references/FluxTraining.getfieldperm\",[141,4.934]],[\"body/references/FluxTraining.getfieldperm\",[]],[\"title/references/FluxTraining.CHECKS\",[48,4.404]],[\"body/references/FluxTraining.CHECKS\",[]],[\"title/documents/docs/reference/training.md\",[22,1.756,29,2.039,102,1.877,142,2.284]],[\"body/documents/docs/reference/training.md\",[]],[\"title/references/FluxTraining.Loggables.File\",[143,4.934]],[\"body/references/FluxTraining.Loggables.File\",[]],[\"title/references/FluxTraining.Metrics\",[51,4.404]],[\"body/references/FluxTraining.Metrics\",[]],[\"title/references/FluxTraining.log_parameters\",[144,4.934]],[\"body/references/FluxTraining.log_parameters\",[]],[\"title/references/FluxTraining.model!\",[83,4.404]],[\"body/references/FluxTraining.model!\",[]],[\"title/references/FluxTraining.Events.EpochBegin\",[145,4.934]],[\"body/references/FluxTraining.Events.EpochBegin\",[]],[\"title/references/FluxTraining.CallbackCondition\",[146,4.934]],[\"body/references/FluxTraining.CallbackCondition\",[]],[\"title/references/FluxTraining.onecycle\",[147,4.934]],[\"body/references/FluxTraining.onecycle\",[]],[\"title/references/FluxTraining.loadmodel\",[148,4.934]],[\"body/references/FluxTraining.loadmodel\",[]],[\"title/references/FluxTraining.Loggables.Loggable\",[30,4.404]],[\"body/references/FluxTraining.Loggables.Loggable\",[]],[\"title/references/FluxTraining.Read\",[149,4.934]],[\"body/references/FluxTraining.Read\",[]],[\"title/references/FluxTraining.step!\",[150,4.934]],[\"body/references/FluxTraining.step!\",[]],[\"title/references/FluxTraining.ProgressPrinter\",[151,4.934]],[\"body/references/FluxTraining.ProgressPrinter\",[]],[\"title/references/FluxTraining.getcallback\",[152,4.934]],[\"body/references/FluxTraining.getcallback\",[]],[\"title/references/FluxTraining.handle\",[153,4.934]],[\"body/references/FluxTraining.handle\",[]],[\"title/documents/docs/tutorials/training.md\",[22,2.736,102,2.924]],[\"body/documents/docs/tutorials/training.md\",[]],[\"title/references/FluxTraining._resolveconflict\",[154,4.934]],[\"body/references/FluxTraining._resolveconflict\",[]],[\"title/references/FluxTraining.SafeCallback\",[155,4.934]],[\"body/references/FluxTraining.SafeCallback\",[]],[\"title/documents/docs/callbacks/custom.md\",[16,2.586,101,3.176]],[\"body/documents/docs/callbacks/custom.md\",[]],[\"title/references/FluxTraining.CheckDataIteratorValid\",[156,4.934]],[\"body/references/FluxTraining.CheckDataIteratorValid\",[]],[\"title/references/FluxTraining.errorwriteconflict\",[157,4.934]],[\"body/references/FluxTraining.errorwriteconflict\",[]],[\"title/references/FluxTraining.Loggables.Value\",[158,4.934]],[\"body/references/FluxTraining.Loggables.Value\",[]],[\"title/references/FluxTraining.TestModel\",[159,4.934]],[\"body/references/FluxTraining.TestModel\",[]],[\"title/references/FluxTraining.LoggerBackend\",[160,4.934]],[\"body/references/FluxTraining.LoggerBackend\",[]],[\"title/documents/docs/background/dataiterator.md\",[161,3.558,162,3.558]],[\"body/documents/docs/background/dataiterator.md\",[]]],\"invertedIndex\":[[\"\",{\"_index\":110,\"title\":{\"documents/docs/callbacks/tipstricks.md\":{}},\"body\":{}}],[\"__init__\",{\"_index\":139,\"title\":{\"references/FluxTraining.##InlineTest-01b48f5c342f65df7fcd07f28f0d2cacbb09f0a0.__init__\":{}},\"body\":{}}],[\"_combinenam\",{\"_index\":56,\"title\":{\"references/FluxTraining._combinename\":{}},\"body\":{}}],[\"_datait\",{\"_index\":44,\"title\":{\"references/FluxTraining._dataiters\":{}},\"body\":{}}],[\"_gradient\",{\"_index\":130,\"title\":{\"references/FluxTraining._gradient\":{}},\"body\":{}}],[\"_on\",{\"_index\":40,\"title\":{\"references/FluxTraining._on\":{}},\"body\":{}}],[\"_resolveconflict\",{\"_index\":154,\"title\":{\"references/FluxTraining._resolveconflict\":{}},\"body\":{}}],[\"_updat\",{\"_index\":76,\"title\":{\"references/FluxTraining._update!\":{}},\"body\":{}}],[\"abstractcallback\",{\"_index\":12,\"title\":{\"references/FluxTraining.AbstractCallback\":{}},\"body\":{}}],[\"abstractmetr\",{\"_index\":21,\"title\":{\"references/FluxTraining.AbstractMetric\":{}},\"body\":{}}],[\"abstracttrainingphas\",{\"_index\":58,\"title\":{\"references/FluxTraining.Phases.AbstractTrainingPhase\":{}},\"body\":{}}],[\"abstractvalidationphas\",{\"_index\":112,\"title\":{\"references/FluxTraining.Phases.AbstractValidationPhase\":{}},\"body\":{}}],[\"access\",{\"_index\":108,\"title\":{\"references/FluxTraining.accesses\":{}},\"body\":{}}],[\"accuraci\",{\"_index\":47,\"title\":{\"references/FluxTraining.accuracy\":{}},\"body\":{}}],[\"addcallback\",{\"_index\":129,\"title\":{\"references/FluxTraining.addcallback!\":{}},\"body\":{}}],[\"api\",{\"_index\":142,\"title\":{\"documents/docs/reference/training.md\":{}},\"body\":{}}],[\"audio\",{\"_index\":41,\"title\":{\"references/FluxTraining.Loggables.Audio\":{}},\"body\":{}}],[\"backwardbegin\",{\"_index\":133,\"title\":{\"references/FluxTraining.Events.BackwardBegin\":{}},\"body\":{}}],[\"backwardend\",{\"_index\":85,\"title\":{\"references/FluxTraining.Events.BackwardEnd\":{}},\"body\":{}}],[\"callback\",{\"_index\":16,\"title\":{\"references/FluxTraining.Callback\":{},\"documents/docs/callbacks/reference.md\":{},\"references/FluxTraining.Callbacks\":{},\"documents/docs/callbacks/usage.md\":{},\"documents/docs/callbacks/custom.md\":{}},\"body\":{}}],[\"callbackcondit\",{\"_index\":146,\"title\":{\"references/FluxTraining.CallbackCondition\":{}},\"body\":{}}],[\"callbackgraph\",{\"_index\":93,\"title\":{\"references/FluxTraining.callbackgraph\":{}},\"body\":{}}],[\"callbackrunn\",{\"_index\":128,\"title\":{\"references/FluxTraining.CallbackRunner\":{}},\"body\":{}}],[\"cancelepochexcept\",{\"_index\":124,\"title\":{\"references/FluxTraining.CancelEpochException\":{}},\"body\":{}}],[\"cancelfittingexcept\",{\"_index\":70,\"title\":{\"references/FluxTraining.CancelFittingException\":{}},\"body\":{}}],[\"cancelstepexcept\",{\"_index\":4,\"title\":{\"references/FluxTraining.CancelStepException\":{}},\"body\":{}}],[\"check\",{\"_index\":48,\"title\":{\"references/FluxTraining.Check\":{},\"references/FluxTraining.CHECKS\":{}},\"body\":{}}],[\"checkdataiteratortrain\",{\"_index\":131,\"title\":{\"references/FluxTraining.CheckDataIteratorTrain\":{}},\"body\":{}}],[\"checkdataiteratorvalid\",{\"_index\":156,\"title\":{\"references/FluxTraining.CheckDataIteratorValid\":{}},\"body\":{}}],[\"checkiteratestupl\",{\"_index\":87,\"title\":{\"references/FluxTraining.CheckIteratesTuples\":{}},\"body\":{}}],[\"checkmodellossstep\",{\"_index\":3,\"title\":{\"references/FluxTraining.CheckModelLossStep\":{}},\"body\":{}}],[\"checkpoint\",{\"_index\":84,\"title\":{\"references/FluxTraining.Checkpointer\":{}},\"body\":{}}],[\"classifi\",{\"_index\":24,\"title\":{\"documents/docs/tutorials/mnist.ipynb\":{}},\"body\":{}}],[\"conditionalcallback\",{\"_index\":79,\"title\":{\"references/FluxTraining.ConditionalCallback\":{}},\"body\":{}}],[\"conflictresolut\",{\"_index\":5,\"title\":{\"references/FluxTraining.ConflictResolution\":{}},\"body\":{}}],[\"custom\",{\"_index\":101,\"title\":{\"documents/docs/custom_training.ipynb\":{},\"documents/docs/callbacks/custom.md\":{}},\"body\":{}}],[\"customcallback\",{\"_index\":43,\"title\":{\"references/FluxTraining.CustomCallback\":{}},\"body\":{}}],[\"data\",{\"_index\":161,\"title\":{\"documents/docs/background/dataiterator.md\":{}},\"body\":{}}],[\"defaultcallback\",{\"_index\":67,\"title\":{\"references/FluxTraining.defaultcallbacks\":{}},\"body\":{}}],[\"earlystop\",{\"_index\":89,\"title\":{\"references/FluxTraining.EarlyStopping\":{}},\"body\":{}}],[\"edgesrunaft\",{\"_index\":25,\"title\":{\"references/FluxTraining.edgesrunafter\":{}},\"body\":{}}],[\"epoch\",{\"_index\":103,\"title\":{\"references/FluxTraining.epoch!\":{}},\"body\":{}}],[\"epochbegin\",{\"_index\":145,\"title\":{\"references/FluxTraining.Events.EpochBegin\":{}},\"body\":{}}],[\"epochend\",{\"_index\":92,\"title\":{\"references/FluxTraining.Events.EpochEnd\":{}},\"body\":{}}],[\"epochvalu\",{\"_index\":98,\"title\":{\"references/FluxTraining.epochvalue\":{}},\"body\":{}}],[\"errorwriteconflict\",{\"_index\":157,\"title\":{\"references/FluxTraining.errorwriteconflict\":{}},\"body\":{}}],[\"es\",{\"_index\":72,\"title\":{\"references/FluxTraining.ES\":{}},\"body\":{}}],[\"event\",{\"_index\":65,\"title\":{\"references/FluxTraining.Events\":{},\"references/FluxTraining.Events.Event\":{}},\"body\":{}}],[\"featur\",{\"_index\":135,\"title\":{\"documents/docs/features.md\":{}},\"body\":{}}],[\"file\",{\"_index\":143,\"title\":{\"references/FluxTraining.Loggables.File\":{}},\"body\":{}}],[\"findconflict\",{\"_index\":114,\"title\":{\"references/FluxTraining.findconflicts\":{}},\"body\":{}}],[\"fit\",{\"_index\":121,\"title\":{\"references/FluxTraining.fit!\":{}},\"body\":{}}],[\"fitexcept\",{\"_index\":52,\"title\":{\"references/FluxTraining.FitException\":{}},\"body\":{}}],[\"fluxtrain\",{\"_index\":107,\"title\":{\"references/FluxTraining\":{}},\"body\":{}}],[\"fluxtraining.jl\",{\"_index\":60,\"title\":{\"documents/README.md\":{}},\"body\":{}}],[\"formataccess\",{\"_index\":27,\"title\":{\"references/FluxTraining.formataccess\":{}},\"body\":{}}],[\"frequencythrottl\",{\"_index\":35,\"title\":{\"references/FluxTraining.FrequencyThrottle\":{}},\"body\":{}}],[\"function\",{\"_index\":54,\"title\":{\"documents/docs/background/lossfunction.md\":{}},\"body\":{}}],[\"garbagecollect\",{\"_index\":61,\"title\":{\"references/FluxTraining.GarbageCollect\":{},\"references/FluxTraining.garbagecollect\":{}},\"body\":{}}],[\"get\",{\"_index\":99,\"title\":{\"documents/docs/getting_started.md\":{},\"documents/docs/overview.md\":{}},\"body\":{}}],[\"getcallback\",{\"_index\":152,\"title\":{\"references/FluxTraining.getcallback\":{}},\"body\":{}}],[\"getfieldperm\",{\"_index\":141,\"title\":{\"references/FluxTraining.getfieldperm\":{}},\"body\":{}}],[\"getindexperm\",{\"_index\":13,\"title\":{\"references/FluxTraining.getindexperm\":{}},\"body\":{}}],[\"graph\",{\"_index\":63,\"title\":{\"references/FluxTraining.Loggables.Graph\":{}},\"body\":{}}],[\"handl\",{\"_index\":153,\"title\":{\"references/FluxTraining.handle\":{}},\"body\":{}}],[\"hasconflict\",{\"_index\":75,\"title\":{\"references/FluxTraining.hasconflict\":{}},\"body\":{}}],[\"histogram\",{\"_index\":86,\"title\":{\"references/FluxTraining.Loggables.Histogram\":{}},\"body\":{}}],[\"histori\",{\"_index\":81,\"title\":{\"references/FluxTraining.History\":{}},\"body\":{}}],[\"hyperparamet\",{\"_index\":1,\"title\":{\"references/FluxTraining.HyperParameter\":{},\"documents/docs/tutorials/hyperparameters.md\":{}},\"body\":{}}],[\"imag\",{\"_index\":23,\"title\":{\"documents/docs/tutorials/mnist.ipynb\":{},\"references/FluxTraining.Loggables.Image\":{}},\"body\":{}}],[\"imagenette_demo\",{\"_index\":42,\"title\":{\"documents/docs/imagenette_demo.ipynb\":{}},\"body\":{}}],[\"init\",{\"_index\":138,\"title\":{\"references/FluxTraining.init!\":{}},\"body\":{}}],[\"iter\",{\"_index\":162,\"title\":{\"documents/docs/background/dataiterator.md\":{}},\"body\":{}}],[\"iterpair\",{\"_index\":15,\"title\":{\"references/FluxTraining.iterpairs\":{}},\"body\":{}}],[\"learner\",{\"_index\":68,\"title\":{\"references/FluxTraining.Learner\":{}},\"body\":{}}],[\"learningr\",{\"_index\":50,\"title\":{\"references/FluxTraining.LearningRate\":{}},\"body\":{}}],[\"licens\",{\"_index\":20,\"title\":{\"documents/LICENSE.md\":{}},\"body\":{}}],[\"linearrunn\",{\"_index\":26,\"title\":{\"references/FluxTraining.LinearRunner\":{}},\"body\":{}}],[\"loadmodel\",{\"_index\":148,\"title\":{\"references/FluxTraining.loadmodel\":{}},\"body\":{}}],[\"log_paramet\",{\"_index\":144,\"title\":{\"references/FluxTraining.log_parameters\":{}},\"body\":{}}],[\"log_to\",{\"_index\":10,\"title\":{\"references/FluxTraining.log_to\":{}},\"body\":{}}],[\"loggabl\",{\"_index\":30,\"title\":{\"references/FluxTraining.Loggables\":{},\"references/FluxTraining.Loggables.Loggable\":{}},\"body\":{}}],[\"loggerbackend\",{\"_index\":160,\"title\":{\"references/FluxTraining.LoggerBackend\":{}},\"body\":{}}],[\"loghistogram\",{\"_index\":136,\"title\":{\"references/FluxTraining.LogHistograms\":{}},\"body\":{}}],[\"loghyperparam\",{\"_index\":80,\"title\":{\"references/FluxTraining.LogHyperParams\":{}},\"body\":{}}],[\"logmetr\",{\"_index\":120,\"title\":{\"references/FluxTraining.LogMetrics\":{}},\"body\":{}}],[\"logvisu\",{\"_index\":64,\"title\":{\"references/FluxTraining.LogVisualization\":{}},\"body\":{}}],[\"loop\",{\"_index\":102,\"title\":{\"documents/docs/custom_training.ipynb\":{},\"documents/docs/reference/training.md\":{},\"documents/docs/tutorials/training.md\":{}},\"body\":{}}],[\"loss\",{\"_index\":53,\"title\":{\"documents/docs/background/lossfunction.md\":{},\"references/FluxTraining.Loss\":{}},\"body\":{}}],[\"lossbegin\",{\"_index\":118,\"title\":{\"references/FluxTraining.Events.LossBegin\":{}},\"body\":{}}],[\"metric\",{\"_index\":51,\"title\":{\"references/FluxTraining.Metric\":{},\"references/FluxTraining.Metrics\":{}},\"body\":{}}],[\"metricnam\",{\"_index\":71,\"title\":{\"references/FluxTraining.metricname\":{}},\"body\":{}}],[\"metricsprint\",{\"_index\":74,\"title\":{\"references/FluxTraining.MetricsPrinter\":{}},\"body\":{}}],[\"model\",{\"_index\":83,\"title\":{\"documents/docs/background/model.md\":{},\"references/FluxTraining.model!\":{}},\"body\":{}}],[\"new\",{\"_index\":0,\"title\":{\"documents/CHANGELOG.md\":{}},\"body\":{}}],[\"noconflict\",{\"_index\":66,\"title\":{\"references/FluxTraining.NoConflict\":{}},\"body\":{}}],[\"notdefin\",{\"_index\":113,\"title\":{\"references/FluxTraining.NotDefined\":{}},\"body\":{}}],[\"onecycl\",{\"_index\":147,\"title\":{\"references/FluxTraining.onecycle\":{}},\"body\":{}}],[\"optim\",{\"_index\":96,\"title\":{\"documents/docs/background/optimizer.md\":{}},\"body\":{}}],[\"pack_histori\",{\"_index\":11,\"title\":{\"references/FluxTraining.@pack_History!\":{},\"references/FluxTraining.@pack_History\":{}},\"body\":{}}],[\"permiss\",{\"_index\":125,\"title\":{\"references/FluxTraining.Permission\":{}},\"body\":{}}],[\"phase\",{\"_index\":94,\"title\":{\"references/FluxTraining.Phases\":{},\"references/FluxTraining.Phases.Phase\":{}},\"body\":{}}],[\"phasedatait\",{\"_index\":88,\"title\":{\"references/FluxTraining.phasedataiter\":{}},\"body\":{}}],[\"print_epoch_t\",{\"_index\":9,\"title\":{\"references/FluxTraining.print_epoch_table\":{}},\"body\":{}}],[\"progressprint\",{\"_index\":151,\"title\":{\"references/FluxTraining.ProgressPrinter\":{}},\"body\":{}}],[\"propdict\",{\"_index\":116,\"title\":{\"references/FluxTraining.PropDict\":{}},\"body\":{}}],[\"protect\",{\"_index\":18,\"title\":{\"references/FluxTraining.Protected\":{},\"references/FluxTraining.protect\":{}},\"body\":{}}],[\"protectedexcept\",{\"_index\":34,\"title\":{\"references/FluxTraining.ProtectedException\":{}},\"body\":{}}],[\"read\",{\"_index\":149,\"title\":{\"references/FluxTraining.Read\":{}},\"body\":{}}],[\"record\",{\"_index\":119,\"title\":{\"references/FluxTraining.Recorder\":{}},\"body\":{}}],[\"refer\",{\"_index\":29,\"title\":{\"documents/docs/callbacks/reference.md\":{},\"documents/docs/reference/training.md\":{}},\"body\":{}}],[\"removecallback\",{\"_index\":127,\"title\":{\"references/FluxTraining.removecallback!\":{}},\"body\":{}}],[\"replacecallback\",{\"_index\":6,\"title\":{\"references/FluxTraining.replacecallback!\":{}},\"body\":{}}],[\"reset\",{\"_index\":132,\"title\":{\"references/FluxTraining.reset!\":{}},\"body\":{}}],[\"resolveconflict\",{\"_index\":28,\"title\":{\"references/FluxTraining.resolveconflict\":{}},\"body\":{}}],[\"runaft\",{\"_index\":73,\"title\":{\"references/FluxTraining.runafter\":{}},\"body\":{}}],[\"runcheck\",{\"_index\":77,\"title\":{\"references/FluxTraining.runchecks\":{}},\"body\":{}}],[\"runepoch\",{\"_index\":134,\"title\":{\"references/FluxTraining.runepoch\":{}},\"body\":{}}],[\"runfirst\",{\"_index\":36,\"title\":{\"references/FluxTraining.RunFirst\":{}},\"body\":{}}],[\"runstep\",{\"_index\":126,\"title\":{\"references/FluxTraining.runstep\":{}},\"body\":{}}],[\"runtest\",{\"_index\":62,\"title\":{\"references/FluxTraining.runtests\":{}},\"body\":{}}],[\"safecallback\",{\"_index\":155,\"title\":{\"references/FluxTraining.SafeCallback\":{}},\"body\":{}}],[\"sanitycheck\",{\"_index\":38,\"title\":{\"references/FluxTraining.SanityCheck\":{}},\"body\":{}}],[\"sanitycheckexcept\",{\"_index\":122,\"title\":{\"references/FluxTraining.SanityCheckException\":{}},\"body\":{}}],[\"savemodel\",{\"_index\":2,\"title\":{\"references/FluxTraining.savemodel\":{}},\"body\":{}}],[\"schedul\",{\"_index\":7,\"title\":{\"documents/docs/tutorials/hyperparameters.md\":{},\"references/FluxTraining.Scheduler\":{}},\"body\":{}}],[\"setcallback\",{\"_index\":105,\"title\":{\"references/FluxTraining.setcallbacks!\":{}},\"body\":{}}],[\"setfieldperm\",{\"_index\":140,\"title\":{\"references/FluxTraining.setfieldperm!\":{}},\"body\":{}}],[\"sethyperparamet\",{\"_index\":90,\"title\":{\"references/FluxTraining.sethyperparameter!\":{}},\"body\":{}}],[\"setindexperm\",{\"_index\":69,\"title\":{\"references/FluxTraining.setindexperm!\":{}},\"body\":{}}],[\"setlearningr\",{\"_index\":31,\"title\":{\"references/FluxTraining.setlearningrate!\":{}},\"body\":{}}],[\"setupoptimst\",{\"_index\":55,\"title\":{\"references/FluxTraining.setupoptimstate\":{}},\"body\":{}}],[\"shouldrun\",{\"_index\":137,\"title\":{\"references/FluxTraining.shouldrun\":{}},\"body\":{}}],[\"smoothloss\",{\"_index\":104,\"title\":{\"references/FluxTraining.SmoothLoss\":{}},\"body\":{}}],[\"start\",{\"_index\":100,\"title\":{\"documents/docs/getting_started.md\":{},\"documents/docs/overview.md\":{}},\"body\":{}}],[\"stateaccess\",{\"_index\":59,\"title\":{\"references/FluxTraining.stateaccess\":{}},\"body\":{}}],[\"step\",{\"_index\":150,\"title\":{\"references/FluxTraining.step!\":{}},\"body\":{}}],[\"stepbegin\",{\"_index\":19,\"title\":{\"references/FluxTraining.Events.StepBegin\":{}},\"body\":{}}],[\"stepend\",{\"_index\":37,\"title\":{\"references/FluxTraining.Events.StepEnd\":{}},\"body\":{}}],[\"stepvalu\",{\"_index\":32,\"title\":{\"references/FluxTraining.stepvalue\":{}},\"body\":{}}],[\"stoponnanloss\",{\"_index\":17,\"title\":{\"references/FluxTraining.StopOnNaNLoss\":{}},\"body\":{}}],[\"tensorboardbackend\",{\"_index\":95,\"title\":{\"references/FluxTraining.TensorBoardBackend\":{}},\"body\":{}}],[\"test\",{\"_index\":8,\"title\":{\"references/FluxTraining.##InlineTest-01b48f5c342f65df7fcd07f28f0d2cacbb09f0a0.tests\":{}},\"body\":{}}],[\"testbatch\",{\"_index\":57,\"title\":{\"references/FluxTraining.testbatch\":{},\"references/FluxTraining.testbatches\":{}},\"body\":{}}],[\"testlearn\",{\"_index\":97,\"title\":{\"references/FluxTraining.testlearner\":{}},\"body\":{}}],[\"testmodel\",{\"_index\":159,\"title\":{\"references/FluxTraining.TestModel\":{}},\"body\":{}}],[\"testset_macro\",{\"_index\":46,\"title\":{\"references/FluxTraining.##InlineTest-01b48f5c342f65df7fcd07f28f0d2cacbb09f0a0.TESTSET_MACROS\":{}},\"body\":{}}],[\"text\",{\"_index\":115,\"title\":{\"references/FluxTraining.Loggables.Text\":{}},\"body\":{}}],[\"throttl\",{\"_index\":49,\"title\":{\"references/FluxTraining.throttle\":{}},\"body\":{}}],[\"timethrottl\",{\"_index\":78,\"title\":{\"references/FluxTraining.TimeThrottle\":{}},\"body\":{}}],[\"tip\",{\"_index\":109,\"title\":{\"documents/docs/callbacks/tipstricks.md\":{}},\"body\":{}}],[\"todevic\",{\"_index\":39,\"title\":{\"references/FluxTraining.ToDevice\":{}},\"body\":{}}],[\"togpu\",{\"_index\":45,\"title\":{\"references/FluxTraining.ToGPU\":{}},\"body\":{}}],[\"train\",{\"_index\":22,\"title\":{\"documents/docs/tutorials/mnist.ipynb\":{},\"documents/docs/custom_training.ipynb\":{},\"documents/docs/reference/training.md\":{},\"documents/docs/tutorials/training.md\":{}},\"body\":{}}],[\"trainingphas\",{\"_index\":82,\"title\":{\"references/FluxTraining.Phases.TrainingPhase\":{}},\"body\":{}}],[\"trick\",{\"_index\":111,\"title\":{\"documents/docs/callbacks/tipstricks.md\":{}},\"body\":{}}],[\"unpack_histori\",{\"_index\":33,\"title\":{\"references/FluxTraining.@unpack_History\":{}},\"body\":{}}],[\"unresolv\",{\"_index\":106,\"title\":{\"references/FluxTraining.Unresolvable\":{}},\"body\":{}}],[\"unsafecallback\",{\"_index\":123,\"title\":{\"references/FluxTraining.UnsafeCallback\":{}},\"body\":{}}],[\"us\",{\"_index\":117,\"title\":{\"documents/docs/callbacks/usage.md\":{}},\"body\":{}}],[\"validationphas\",{\"_index\":14,\"title\":{\"references/FluxTraining.Phases.ValidationPhase\":{}},\"body\":{}}],[\"valu\",{\"_index\":158,\"title\":{\"references/FluxTraining.Loggables.Value\":{}},\"body\":{}}],[\"write\",{\"_index\":91,\"title\":{\"references/FluxTraining.Write\":{}},\"body\":{}}]],\"pipeline\":[\"stemmer\"]}"}</script>
	<script type="application/json" sveltekit:data-type="data" sveltekit:data-url="/FluxTraining.jl/api/dev/documents/docs/tutorials/training.md.json">{"status":200,"statusText":"","headers":{"content-type":"application/json; charset=utf-8"},"body":"{\"attributes\":{\"backlinks\":[{\"tag\":\"document\",\"title\":\"News\",\"docid\":\"documents/CHANGELOG.md\"},{\"tag\":\"document\",\"title\":\"Training loop API reference\",\"docid\":\"documents/docs/reference/training.md\"},{\"tag\":\"document\",\"title\":\"FluxTraining.jl\",\"docid\":\"documents/README.md\"},{\"tag\":\"document\",\"title\":\"Custom callbacks\",\"docid\":\"documents/docs/callbacks/custom.md\"},{\"tag\":\"document\",\"title\":\"Models\",\"docid\":\"documents/docs/background/model.md\"},{\"tag\":\"document\",\"title\":\"Data iterators\",\"docid\":\"documents/docs/background/dataiterator.md\"}],\"path\":\"/home/runner/.julia/packages/FluxTraining/YVIq2/docs/tutorials/training.md\",\"title\":\"Training loop\"},\"tag\":\"document\",\"children\":[{\"attributes\":{},\"tag\":\"md\",\"children\":[{\"attributes\":{},\"tag\":\"h1\",\"children\":[\"Training loop\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[\"FluxTraining.jl comes with a training loop for standard supervised learning problems, but for different tasks like self-supervised learning, being able to write custom training logic is essential. The package’s training loop API requires little boilerplate to convert a regular Flux.jl training loop while making it compatible with existing callbacks.\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"h2\",\"children\":[\"Supervised training, step\",\"-\",\"by\",\"-\",\"step\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[\"We’ll explore the API step-by-step by converting a basic training loop and then discuss ways in which more complex training loops can be implemented using the same approach. The central piece of a training loop is the logic for a single training step, and in many cases, that will be all you need to implement. Below is the definition of a basic vanilla Flux.jl training step. It takes a batch of data, calculates the loss, gradients and finally updates the parameters of the model.\"],\"type\":\"node\"},{\"attributes\":{\"lang\":\"julia\"},\"tag\":\"codeblock\",\"children\":[{\"attributes\":{},\"tag\":\"julia\",\"children\":[{\"attributes\":{},\"tag\":\"FUNCTION\",\"children\":[{\"attributes\":{},\"tag\":\"FUNCTION\",\"children\":[\"function\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.step!\"},\"tag\":\"reference\",\"children\":[\"step!\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"model\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"batch\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"params\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"optimizer\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"lossfn\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"BLOCK\",\"children\":[{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"batch\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"grads\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"gradient\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"params\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[\"do\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"ANON_FUNC\",\"children\":[{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n        \"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"BLOCK\",\"children\":[{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ŷs\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"model\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n        \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"loss\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"lossfn\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ŷs\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n        \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RETURN\",\"children\":[{\"attributes\":{},\"tag\":\"RETURN\",\"children\":[\"return\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"loss\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"END\",\"children\":[\"end\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"update!\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"optimizer\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"params\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"grads\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"END\",\"children\":[\"end\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[\"To make a training step work with FluxTraining.jl and its callbacks, we need to\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"ul\",\"children\":[{\"attributes\":{},\"tag\":\"li\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"store data for a step so that callbacks can access it (e.g. \",{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.Metrics\"},\"tag\":\"reference\",\"children\":[{\"attributes\":{},\"tag\":\"code\",\"children\":[\"Metrics\"],\"type\":\"node\"}],\"type\":\"node\"},\" uses \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"ys\"],\"type\":\"node\"},\" and \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"ŷs\"],\"type\":\"node\"},\" to evaluate metrics for each step); and\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"li\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"dispatch events so the callbacks are triggered\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[\"We first need to create a \",{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.Phases.Phase\"},\"tag\":\"reference\",\"children\":[{\"attributes\":{},\"tag\":\"code\",\"children\":[\"Phase\"],\"type\":\"node\"}],\"type\":\"node\"},\" and implement a method for \",{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.step!\"},\"tag\":\"reference\",\"children\":[{\"attributes\":{},\"tag\":\"code\",\"children\":[\"FluxTraining.step!\"],\"type\":\"node\"}],\"type\":\"node\"},\" that dispatches on the phase type. \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"Phase\"],\"type\":\"node\"},\"s are used to define different training behaviors using the same API and to define callback functionality that is only run during certain phases. For example, \",{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.Scheduler\"},\"tag\":\"reference\",\"children\":[{\"attributes\":{},\"tag\":\"code\",\"children\":[\"Scheduler\"],\"type\":\"node\"}],\"type\":\"node\"},\" only runs during \",{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.Phases.AbstractTrainingPhase\"},\"tag\":\"reference\",\"children\":[{\"attributes\":{},\"tag\":\"code\",\"children\":[\"AbstractTrainingPhase\"],\"type\":\"node\"}],\"type\":\"node\"},\"s but not during \",{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.Phases.ValidationPhase\"},\"tag\":\"reference\",\"children\":[{\"attributes\":{},\"tag\":\"code\",\"children\":[\"ValidationPhase\"],\"type\":\"node\"}],\"type\":\"node\"},\". Let’s implement such a phase and method, moving the arguments inside a \",{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.Learner\"},\"tag\":\"reference\",\"children\":[{\"attributes\":{},\"tag\":\"code\",\"children\":[\"Learner\"],\"type\":\"node\"}],\"type\":\"node\"},\" in the process.\"],\"type\":\"node\"},{\"attributes\":{\"lang\":\"julia\"},\"tag\":\"codeblock\",\"children\":[{\"attributes\":{},\"tag\":\"julia\",\"children\":[\"struct MyTrainingPhase \u003C: FluxTraining.AbstractTrainingPhase\\n\\nfunction FluxTraining.step!(learner, phase::MyTrainingPhase, batch)\\n    xs, ys = batch\\n    grads = gradient(learner.params) do\\n        ŷs = learner.model(xs)\\n        loss = learner.lossfn(ŷs, ys)\\n        return loss\\n    end\\n    update!(learner.optimizer, learner.params, grads)\\nend\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[\"Now we can already train a model using this implementation, for example using \",{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.epoch!\"},\"tag\":\"reference\",\"children\":[{\"attributes\":{},\"tag\":\"code\",\"children\":[\"epoch!\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"code\",\"children\":[\"(learner, MyTrainingPhase(), dataiter)\"],\"type\":\"node\"},\". However, no callbacks would be called, since we haven’t yet put in any logic that dispatches events or stores the step state. We can do both by using the helper function \",{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.runstep\"},\"tag\":\"reference\",\"children\":[{\"attributes\":{},\"tag\":\"code\",\"children\":[\"runstep\"],\"type\":\"node\"}],\"type\":\"node\"},\" which takes care of runnning our step logic, dispatching a \",{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.Events.StepBegin\"},\"tag\":\"reference\",\"children\":[{\"attributes\":{},\"tag\":\"code\",\"children\":[\"StepBegin\"],\"type\":\"node\"}],\"type\":\"node\"},\" and \",{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.Events.StepEnd\"},\"tag\":\"reference\",\"children\":[{\"attributes\":{},\"tag\":\"code\",\"children\":[\"StepEnd\"],\"type\":\"node\"}],\"type\":\"node\"},\" event before and after and handling control flow exceptions like \",{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.CancelStepException\"},\"tag\":\"reference\",\"children\":[{\"attributes\":{},\"tag\":\"code\",\"children\":[\"CancelStepException\"],\"type\":\"node\"}],\"type\":\"node\"},\". Additionally, \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"runstep\"],\"type\":\"node\"},\" gives us a function \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"handle\"],\"type\":\"node\"},\" which we can use to dispatch events inside the step, and \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"state\"],\"type\":\"node\"},\" a container for storing step state. Let’s use \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"runstep\"],\"type\":\"node\"},\" and store the variables of interest inside \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"state\"],\"type\":\"node\"},\":\"],\"type\":\"node\"},{\"attributes\":{\"lang\":\"julia\"},\"tag\":\"codeblock\",\"children\":[{\"attributes\":{},\"tag\":\"julia\",\"children\":[{\"attributes\":{},\"tag\":\"FUNCTION\",\"children\":[{\"attributes\":{},\"tag\":\"FUNCTION\",\"children\":[\"function\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.step!\"},\"tag\":\"reference\",\"children\":[\"step!\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DECLARATION\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"phase\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DECLARATION\",\"children\":[\"::\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"MyTrainingPhase\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"batch\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"BLOCK\",\"children\":[{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"batch\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.runstep\"},\"tag\":\"reference\",\"children\":[\"runstep\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"phase\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[\"do\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"ANON_FUNC\",\"children\":[{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.handle\"},\"tag\":\"reference\",\"children\":[\"handle\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"state\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"BLOCK\",\"children\":[{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n        \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"state\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"grads\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"gradient\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"params\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[\"do\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"ANON_FUNC\",\"children\":[{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n            \"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"BLOCK\",\"children\":[{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"state\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ŷs\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"model\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"state\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n            \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"state\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"loss\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"lossfn\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"state\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ŷs\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"state\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n            \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RETURN\",\"children\":[{\"attributes\":{},\"tag\":\"RETURN\",\"children\":[\"return\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"loss\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n        \"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"END\",\"children\":[\"end\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n        \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"update!\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"optimizer\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"params\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"grads\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"END\",\"children\":[\"end\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"END\",\"children\":[\"end\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[\"Now callbacks like \",{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.Metrics\"},\"tag\":\"reference\",\"children\":[{\"attributes\":{},\"tag\":\"code\",\"children\":[\"Metrics\"],\"type\":\"node\"}],\"type\":\"node\"},\" can access variables like \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"ys\"],\"type\":\"node\"},\" through \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"learner.step\"],\"type\":\"node\"},\" (which is set to the last \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"state\"],\"type\":\"node\"},\"). Finally, we can use \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"handle\"],\"type\":\"node\"},\" to dispatch additional events:\"],\"type\":\"node\"},{\"attributes\":{\"lang\":\"julia\"},\"tag\":\"codeblock\",\"children\":[{\"attributes\":{},\"tag\":\"julia\",\"children\":[{\"attributes\":{},\"tag\":\"USING\",\"children\":[{\"attributes\":{},\"tag\":\"COLON\",\"children\":[{\"attributes\":{},\"tag\":\"USING\",\"children\":[\"using\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining\"},\"tag\":\"reference\",\"children\":[\"FluxTraining\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.Events\"},\"tag\":\"reference\",\"children\":[\"Events\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COLON\",\"children\":[\":\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.Events.LossBegin\"},\"tag\":\"reference\",\"children\":[\"LossBegin\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.Events.BackwardBegin\"},\"tag\":\"reference\",\"children\":[\"BackwardBegin\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.Events.BackwardEnd\"},\"tag\":\"reference\",\"children\":[\"BackwardEnd\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"FUNCTION\",\"children\":[{\"attributes\":{},\"tag\":\"FUNCTION\",\"children\":[\"function\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.step!\"},\"tag\":\"reference\",\"children\":[\"step!\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DECLARATION\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"phase\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DECLARATION\",\"children\":[\"::\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"MyTrainingPhase\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"batch\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"BLOCK\",\"children\":[{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"batch\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.runstep\"},\"tag\":\"reference\",\"children\":[\"runstep\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"phase\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[\"do\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"ANON_FUNC\",\"children\":[{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.handle\"},\"tag\":\"reference\",\"children\":[\"handle\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"state\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"BLOCK\",\"children\":[{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n        \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"state\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"grads\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"gradient\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"params\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[\"do\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"ANON_FUNC\",\"children\":[{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n            \"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"BLOCK\",\"children\":[{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"state\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ŷs\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"model\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"state\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n            \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.handle\"},\"tag\":\"reference\",\"children\":[\"handle\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.Events.LossBegin\"},\"tag\":\"reference\",\"children\":[\"LossBegin\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n            \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"state\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"loss\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"lossfn\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"state\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ŷs\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"state\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n            \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.handle\"},\"tag\":\"reference\",\"children\":[\"handle\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.Events.BackwardBegin\"},\"tag\":\"reference\",\"children\":[\"BackwardBegin\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n            \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RETURN\",\"children\":[{\"attributes\":{},\"tag\":\"RETURN\",\"children\":[\"return\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"loss\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n        \"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"END\",\"children\":[\"end\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n        \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.handle\"},\"tag\":\"reference\",\"children\":[\"handle\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.Events.BackwardEnd\"},\"tag\":\"reference\",\"children\":[\"BackwardEnd\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n        \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"update!\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"optimizer\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"params\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"grads\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"END\",\"children\":[\"end\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"END\",\"children\":[\"end\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[\"The result is the full implementation of FluxTraining.jl’s own \",{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.Phases.TrainingPhase\"},\"tag\":\"reference\",\"children\":[{\"attributes\":{},\"tag\":\"code\",\"children\":[\"TrainingPhase\"],\"type\":\"node\"}],\"type\":\"node\"},\"! Now we can use \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"epoch!\"],\"type\":\"node\"},\" to train a \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"Learner\"],\"type\":\"node\"},\" with full support for \",{\"attributes\":{\"reftype\":\"document\",\"href\":\"../callbacks/reference.md\",\"title\":\"\",\"document_id\":\"documents/docs/callbacks/reference.md\"},\"tag\":\"reference\",\"children\":[\"all callbacks\"],\"type\":\"node\"},\":\"],\"type\":\"node\"},{\"attributes\":{\"lang\":\"julia\"},\"tag\":\"codeblock\",\"children\":[{\"attributes\":{},\"tag\":\"julia\",\"children\":[{\"attributes\":{},\"tag\":\"FOR\",\"children\":[{\"attributes\":{},\"tag\":\"FOR\",\"children\":[\"for\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"i\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IN\",\"children\":[\"in\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"INTEGER\",\"children\":[\"1\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COLON\",\"children\":[\":\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"INTEGER\",\"children\":[\"10\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"BLOCK\",\"children\":[{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.epoch!\"},\"tag\":\"reference\",\"children\":[\"epoch!\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"MyTrainingPhase\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"dataiter\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"END\",\"children\":[\"end\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"h2\",\"children\":[\"Validation\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[\"The implementation of \",{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.Phases.ValidationPhase\"},\"tag\":\"reference\",\"children\":[{\"attributes\":{},\"tag\":\"code\",\"children\":[\"ValidationPhase\"],\"type\":\"node\"}],\"type\":\"node\"},\" is even simpler; it runs the forward pass and stores variables so that callbacks like \",{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.Metrics\"},\"tag\":\"reference\",\"children\":[{\"attributes\":{},\"tag\":\"code\",\"children\":[\"Metrics\"],\"type\":\"node\"}],\"type\":\"node\"},\" can access them.\"],\"type\":\"node\"},{\"attributes\":{\"lang\":\"julia\"},\"tag\":\"codeblock\",\"children\":[{\"attributes\":{},\"tag\":\"julia\",\"children\":[{\"attributes\":{},\"tag\":\"STRUCT\",\"children\":[{\"attributes\":{},\"tag\":\"FALSE\",\"children\":[\"\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"STRUCT\",\"children\":[\"struct\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"ISSUBTYPE\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.Phases.ValidationPhase\"},\"tag\":\"reference\",\"children\":[\"ValidationPhase\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"ISSUBTYPE\",\"children\":[\"\u003C:\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.Phases.AbstractValidationPhase\"},\"tag\":\"reference\",\"children\":[\"AbstractValidationPhase\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"BLOCK\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"END\",\"children\":[\"end\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"FUNCTION\",\"children\":[{\"attributes\":{},\"tag\":\"FUNCTION\",\"children\":[\"function\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.step!\"},\"tag\":\"reference\",\"children\":[\"step!\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DECLARATION\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"phase\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DECLARATION\",\"children\":[\"::\"],\"type\":\"node\"},{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.Phases.ValidationPhase\"},\"tag\":\"reference\",\"children\":[\"ValidationPhase\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"batch\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"BLOCK\",\"children\":[{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"batch\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.runstep\"},\"tag\":\"reference\",\"children\":[\"runstep\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"phase\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[\"do\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"ANON_FUNC\",\"children\":[{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"_\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"state\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"BLOCK\",\"children\":[{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n        \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"state\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ŷs\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"model\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"state\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"xs\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n        \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"state\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"loss\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"lossfn\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"state\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ŷs\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"state\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"ys\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"END\",\"children\":[\"end\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"END\",\"children\":[\"end\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"h2\",\"children\":[\"Epoch logic\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[\"We didn’t need to implement a custom \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"epoch!\"],\"type\":\"node\"},\" method for our phase since the default is fine here: it just iterates over every batch and calls \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"step!\"],\"type\":\"node\"},\". In fact, let’s have a look at how \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"epoch!\"],\"type\":\"node\"},\" is implemented:\"],\"type\":\"node\"},{\"attributes\":{\"lang\":\"julia\"},\"tag\":\"codeblock\",\"children\":[{\"attributes\":{},\"tag\":\"julia\",\"children\":[{\"attributes\":{},\"tag\":\"FUNCTION\",\"children\":[{\"attributes\":{},\"tag\":\"FUNCTION\",\"children\":[\"function\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.epoch!\"},\"tag\":\"reference\",\"children\":[\"epoch!\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DECLARATION\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"phase\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DECLARATION\",\"children\":[\"::\"],\"type\":\"node\"},{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.Phases.Phase\"},\"tag\":\"reference\",\"children\":[\"Phase\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"dataiter\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"BLOCK\",\"children\":[{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.runepoch\"},\"tag\":\"reference\",\"children\":[\"runepoch\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"phase\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[\"do\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"ANON_FUNC\",\"children\":[{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.handle\"},\"tag\":\"reference\",\"children\":[\"handle\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"BLOCK\",\"children\":[{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n        \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"FOR\",\"children\":[{\"attributes\":{},\"tag\":\"FOR\",\"children\":[\"for\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"batch\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IN\",\"children\":[\"in\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"dataiter\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"BLOCK\",\"children\":[{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n            \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.step!\"},\"tag\":\"reference\",\"children\":[\"step!\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"phase\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"batch\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n        \"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"END\",\"children\":[\"end\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"END\",\"children\":[\"end\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"END\",\"children\":[\"end\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[\"Here, \",{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.runepoch\"},\"tag\":\"reference\",\"children\":[{\"attributes\":{},\"tag\":\"code\",\"children\":[\"runepoch\"],\"type\":\"node\"}],\"type\":\"node\"},\", similarly to \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"runstep\"],\"type\":\"node\"},\", takes care of epoch start/stop events and control flow. If you want more control over your training loop, you can use it to write training loops that directly use \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"step!\"],\"type\":\"node\"},\":\"],\"type\":\"node\"},{\"attributes\":{\"lang\":\"julia\"},\"tag\":\"codeblock\",\"children\":[{\"attributes\":{},\"tag\":\"julia\",\"children\":[{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"phase\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[\"=\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"MyTrainingPhase\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"withepoch\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"phase\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DO\",\"children\":[\"do\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"ANON_FUNC\",\"children\":[{\"attributes\":{},\"tag\":\"TUPLE\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.handle\"},\"tag\":\"reference\",\"children\":[\"handle\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"BLOCK\",\"children\":[{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"FOR\",\"children\":[{\"attributes\":{},\"tag\":\"FOR\",\"children\":[\"for\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"EQ\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"batch\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IN\",\"children\":[\"in\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"dataiter\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"BLOCK\",\"children\":[{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n        \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.step!\"},\"tag\":\"reference\",\"children\":[\"step!\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"phase\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"COMMA\",\"children\":[\",\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"batch\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n        \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"IF\",\"children\":[{\"attributes\":{},\"tag\":\"IF\",\"children\":[\"if\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"DOT\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"learner\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"step\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DOT\",\"children\":[\".\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"QUOTE\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"loss\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LESS\",\"children\":[\"\u003C\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"WHITESPACE\",\"children\":[\" \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"FLOAT\",\"children\":[\"0.1\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"BLOCK\",\"children\":[{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n            \"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{},\"tag\":\"IDENTIFIER\",\"children\":[\"throw\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"CALL\",\"children\":[{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.CancelFittingException\"},\"tag\":\"reference\",\"children\":[\"CancelFittingException\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"LPAREN\",\"children\":[\"(\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DQUOTE\",\"children\":[\"\\\"\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"STRING\",\"children\":[\"Low loss reached.\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"DQUOTE\",\"children\":[\"\\\"\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"RPAREN\",\"children\":[\")\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n        \"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"END\",\"children\":[\"end\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n    \"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"END\",\"children\":[\"end\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"NEWLINE_WS\",\"children\":[\"\\n\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"END\",\"children\":[\"end\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"h2\",\"children\":[\"Tips\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"p\",\"children\":[\"Here are some additional tips for making it easier to implement complicated training loops.\"],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"ul\",\"children\":[{\"attributes\":{},\"tag\":\"li\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"You can pass (named) tuples of models to the \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"Learner\"],\"type\":\"node\"},\" constructor. For example, for generative adversarial training, you can pass in \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"(generator = ..., critic = ...)\"],\"type\":\"node\"},\" and then refer to them inside the \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"step!\"],\"type\":\"node\"},\" implementation, e.g. using \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"learner.model.generator\"],\"type\":\"node\"},\". The models’ parameters will have the same structure, i.e. \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"learner.params.generator\"],\"type\":\"node\"},\" corresponds to \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"params(learner.model.generator)\"],\"type\":\"node\"},\".\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"li\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"You can store any data you want in \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"state\"],\"type\":\"node\"},\".\"],\"type\":\"node\"}],\"type\":\"node\"},{\"attributes\":{},\"tag\":\"li\",\"children\":[{\"attributes\":{},\"tag\":\"p\",\"children\":[\"When defining a custom phase, instead of subtyping \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"Phase\"],\"type\":\"node\"},\" you can subtype \",{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.Phases.AbstractTrainingPhase\"},\"tag\":\"reference\",\"children\":[{\"attributes\":{},\"tag\":\"code\",\"children\":[\"AbstractTrainingPhase\"],\"type\":\"node\"}],\"type\":\"node\"},\" or \",{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.Phases.AbstractValidationPhase\"},\"tag\":\"reference\",\"children\":[{\"attributes\":{},\"tag\":\"code\",\"children\":[\"AbstractValidationPhase\"],\"type\":\"node\"}],\"type\":\"node\"},\" so that some context-specific callbacks will work out of the box with your phase type. For example, \",{\"attributes\":{\"reftype\":\"symbol\",\"document_id\":\"references/FluxTraining.Scheduler\"},\"tag\":\"reference\",\"children\":[{\"attributes\":{},\"tag\":\"code\",\"children\":[\"Scheduler\"],\"type\":\"node\"}],\"type\":\"node\"},\" sets hyperparameter values only during \",{\"attributes\":{},\"tag\":\"code\",\"children\":[\"AbstractTrainingPhase\"],\"type\":\"node\"},\".\"],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}],\"type\":\"node\"}"}</script></div>
</body>

</html>