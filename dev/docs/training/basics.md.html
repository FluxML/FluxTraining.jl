<HTML><head><title>Training loop</title><link href=../../template/ansi.css rel=stylesheet ></link><link href=../../template/hugobook.css rel=stylesheet ></link><meta content=Type=text/html; charset=utf-8 http-equiv=Content-Type ></meta></head><body><input onclick=toggleMenu() id=menu-control class=hidden toggle type=checkbox ></input><input id=toc-control type=checkbox class=hidden toggle ></input><main class=container flex ><aside id=menu-container class=book-menu ><nav class=book-menu-content ><h2 id=title >FluxTraining.jl</h2><div id=sidebar ><div class=doctree ><body><ul><li><p><a href=../../README.md.html title= >README</a></p></li><li><p><a href=../getting_started.md.html title= >Getting started</a></p></li><li><p><a href=../features.md.html title= >Features</a></p></li><li><p>Tutorials</p><ul><li><p><a href=../tutorials/mnist.ipynb.html title= >Training an image classifier</a></p></li><li><p><a href=../tutorials/hyperparameters.md.html title= >Hyperparameter scheduling</a></p></li><li><p><a href=../callbacks/custom.md.html title= >Writing a custom callback</a></p></li></ul></li><li><p>How to</p><ul><li><p><a href=../callbacks/usage.md.html title= >Use callbacks</a></p></li><li><p><a href=../callbacks/tipstricks.md.html title= >Tips &amp; tricks</a></p></li></ul></li><li><p>Reference</p><ul><li><p><a href=../../REFERENCE.html title= >Docstrings</a></p></li><li><p><a href=basics.md.html title= >Training loop</a></p></li><li><p><a href=../callbacks/reference.md.html title= >Callbacks</a></p></li></ul></li></ul></body></div></div></nav></aside><div class=book-page ><header class=book-header ></header><article><h1 id=training-loop >Training loop</h1><p>The training loop, of course, is the core component in <em>FluxTraining.jl</em>.</p><p>Once you have a <a href=../../REFERENCE/FluxTraining.Learner.html ><code>Learner</code></a>, the simplest way to start training is to run <a href=../../REFERENCE/FluxTraining.fit!.html ><code>fit!</code></a><code>(learner, n)</code>. This will train for <code>n</code> epochs of one training phase and one validation phase each.</p><p>Like the <a href=../callbacks/usage.md.html title= >callback system</a>, the training loop has an extensible interface based on multiple dispatch.</p><p>The key abstraction are <a href=../../REFERENCE/FluxTraining.Phases.Phases.Phase.html ><code>FluxTraining.Phases.Phase</code></a>s. In fact, the above <code>fit!(learner, n)</code> is just a shorthand for running <code>fit!(learner, [TrainingPhase(), ValidationPhase()])</code> <code>n</code> times.</p><p>Each phase implements its own training logic which is run when calling <code>fit!(learner, phase)</code>:</p><ul><li><p><a href=../../REFERENCE/FluxTraining.Phases.Phases.TrainingPhase.html ><code>FluxTraining.Phases.TrainingPhase</code></a> does what you expect it to: it uses the training data iterator (<code>learner.data.training</code>), iterates over the batches, computes the forward and backward pass for each batch and updates the model parameters.</p></li><li><p><a href=../../REFERENCE/FluxTraining.Phases.Phases.ValidationPhase.html ><code>FluxTraining.Phases.ValidationPhase</code></a> uses the validation data to compute the forward pass</p></li></ul><p>If this looks like a regular old training loop, youâ€™re right! What makes the training loop customizable is the callback system. During training, <a href=../../REFERENCE/FluxTraining.Events.Events.Event.html ><code>FluxTraining.Events.Event</code></a>s are thrown that <a href=../callbacks/custom.md.html title= >callbacks can hook into</a>.</p><p>For a rundown of events, see <a href=../../REFERENCE/FluxTraining.Events.html ><code>FluxTraining.Events</code></a>.</p><h2 id=extending >Extending</h2><p>Training and validation are currently the only two <a href=../../REFERENCE/FluxTraining.Phases.Phases.Phase.html ><code>FluxTraining.Phases.Phase</code></a>s implemented, but the interface can be extended by implementing <a href=../../REFERENCE/FluxTraining.fitepochphase!.html ><code>FluxTraining.fitepochphase!</code></a> and <a href=../../REFERENCE/FluxTraining.fitbatchphase!.html ><code>FluxTraining.fitbatchphase!</code></a>. An example use case is implementing GAN training.</p></article><footer class=book-footer ></footer></div><aside class=book-toc ><nav id=toc class=book-toc-content ><ul><li><a href=#training-loop >Training loop</a><ul><li><a href=#extending >Extending</a><ul></ul></li></ul></li></ul></nav></aside></main></body></HTML>