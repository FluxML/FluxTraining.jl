<HTML><head><title>Training loop API reference</title><link href=../../template/hugobook.css rel=stylesheet ></link><link href=../../template/ansi.css rel=stylesheet ></link><meta content=Type=text/html; charset=utf-8 http-equiv=Content-Type ></meta></head><body><input onclick=toggleMenu() id=menu-control class=hidden toggle type=checkbox ></input><input id=toc-control type=checkbox class=hidden toggle ></input><main class=container flex ><aside id=menu-container class=book-menu ><nav class=book-menu-content ><h2 id=title >FluxTraining.jl</h2><div id=sidebar ><div class=doctree ><body><ul><li><p><a href=../../README.md.html title= >README</a></p></li><li><p><a href=../getting_started.md.html title= >Getting started</a></p></li><li><p><a href=../features.md.html title= >Features</a></p></li><li><p>Tutorials</p><ul><li><p><a href=../tutorials/mnist.ipynb.html title= >Training an image classifier</a></p></li><li><p><a href=../tutorials/hyperparameters.md.html title= >Hyperparameter scheduling</a></p></li><li><p><a href=../callbacks/custom.md.html title= >Custom callbacks</a></p></li><li><p><a href=../tutorials/training.md.html title= >Custom training loops</a></p></li></ul></li><li><p>How to</p><ul><li><p><a href=../callbacks/usage.md.html title= >Use callbacks</a></p></li><li><p><a href=../callbacks/tipstricks.md.html title= >Tips &amp; tricks</a></p></li></ul></li><li><p>Reference</p><ul><li><p><a href=../../REFERENCE.html title= >Docstrings</a></p></li><li><p><a href=../callbacks/reference.md.html title= >Callbacks</a></p></li><li><p><a href=../../CHANGELOG.md.html title= >Changelog</a></p></li></ul></li></ul></body></div></div></nav></aside><div class=book-page ><header class=book-header ></header><article><h1 id=training-loop-api-reference >Training loop API reference</h1><p>The training loop API centers around the abstract type <a href=../../REFERENCE/FluxTraining.Phases.Phases.Phase.html ><code>FluxTraining.Phases.Phase</code></a> and the function <a href=../../REFERENCE/FluxTraining.step!.html ><code>step!</code></a>. To <a href=../tutorials/training.md.html title= >implement a custom training</a>, you need to</p><h2 id=usage >Usage</h2><ul><li><p>fit for <code>n</code> epochs of supervised training and validation using <a href=../../REFERENCE/FluxTraining.fit!.html ><code>fit!</code></a><code>(learner, n)</code></p></li><li><p>train for an epoch using <a href=../../REFERENCE/FluxTraining.epoch!.html ><code>epoch!</code></a><code>(learner, phase, dataiter)</code></p></li></ul><h2 id=extending >Extending</h2><ul><li><p>subtype <a href=../../REFERENCE/FluxTraining.Phases.Phases.Phase.html ><code>FluxTraining.Phases.Phase</code></a></p></li><li><p>implement <a href=../../REFERENCE/FluxTraining.step!.html ><code>step!</code></a></p></li></ul><p>You can optionally</p><ul><li><p>overwrite default <a href=../../REFERENCE/FluxTraining.epoch!.html ><code>epoch!</code></a> implementation</p></li><li><p>implement <a href=../../REFERENCE/FluxTraining.phasedataiter.html ><code>FluxTraining.phasedataiter</code></a> to define which data iterator should be used when <code>epoch!</code> is called without one.</p></li><li><p>create custom <a href=../../REFERENCE/FluxTraining.Callback.html ><code>FluxTraining.Callback</code></a> and <a href=../../REFERENCE/FluxTraining.Events.Events.Event.html ><code>FluxTraining.Events.Event</code></a>s with event handlers that dispatch on your <code>Phase</code> subtype.</p></li></ul><h3 id=control-flow >Control flow</h3><p>Inside callback handlers and <code>step!</code> implementations, you can throw <a href=../../REFERENCE/FluxTraining.CancelFittingException.html ><code>CancelFittingException</code></a> to stop the training and <a href=../../REFERENCE/FluxTraining.CancelEpochException.html ><code>CancelEpochException</code></a> and <a href=../../REFERENCE/FluxTraining.CancelStepException.html ><code>CancelStepException</code></a> to skip the current epoch or step.</p></article><footer class=book-footer ></footer></div><aside class=book-toc ><nav id=toc class=book-toc-content ><ul><li><a href=#training-loop-api-reference >Training loop API reference</a><ul><li><a href=#usage >Usage</a><ul></ul></li><li><a href=#extending >Extending</a><ul><li><a href=#control-flow >Control flow</a><ul></ul></li></ul></li></ul></li></ul></nav></aside></main></body></HTML>