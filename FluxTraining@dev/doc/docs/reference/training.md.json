{"attributes":{"backlinks":[{"tag":"document","title":"News","docid":"FluxTraining@dev/doc/CHANGELOG.md"}],"path":"/home/runner/.julia/packages/FluxTraining/HjEA2/docs/reference/training.md","title":"Training loop API reference"},"tag":"document","children":[{"attributes":{},"tag":"md","children":[{"attributes":{},"tag":"h1","children":["Training loop API reference"],"type":"node"},{"attributes":{},"tag":"p","children":["The training loop API centers around the abstract type ",{"attributes":{"href":"#","title":""},"tag":"a","children":[{"attributes":{},"tag":"code","children":["Phase"],"type":"node"}],"type":"node"}," and the function ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FluxTraining@dev/ref/FluxTraining.step!"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["step!"],"type":"node"}],"type":"node"},". To ",{"attributes":{"href":"../tutorials/training.md","title":"","document_id":"FluxTraining@dev/doc/docs/tutorials/training.md"},"tag":"reference","children":["implement a custom training"],"type":"node"},", you need to"],"type":"node"},{"attributes":{},"tag":"h2","children":["Usage"],"type":"node"},{"attributes":{},"tag":"ul","children":[{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":["fit for ",{"attributes":{},"tag":"code","children":["n"],"type":"node"}," epochs of supervised training and validation using ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FluxTraining@dev/ref/FluxTraining.fit!"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["fit!"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"code","children":["(learner, n)"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":["train for an epoch using ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FluxTraining@dev/ref/FluxTraining.epoch!"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["epoch!"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"code","children":["(learner, phase, dataiter)"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"h2","children":["Extending"],"type":"node"},{"attributes":{},"tag":"ul","children":[{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":["subtype ",{"attributes":{"href":"#","title":""},"tag":"a","children":[{"attributes":{},"tag":"code","children":["Phase"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":["implement ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FluxTraining@dev/ref/FluxTraining.step!"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["step!"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"p","children":["You can optionally"],"type":"node"},{"attributes":{},"tag":"ul","children":[{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":["overwrite default ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FluxTraining@dev/ref/FluxTraining.epoch!"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["epoch!"],"type":"node"}],"type":"node"}," implementation"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":["implement ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FluxTraining@dev/ref/FluxTraining.phasedataiter"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["phasedataiter"],"type":"node"}],"type":"node"}," to define which data iterator should be used when ",{"attributes":{},"tag":"code","children":["epoch!"],"type":"node"}," is called without one."],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":["create custom ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FluxTraining@dev/ref/FluxTraining.Callback"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["Callback"],"type":"node"}],"type":"node"}," and ",{"attributes":{"href":"#","title":""},"tag":"a","children":[{"attributes":{},"tag":"code","children":["Event"],"type":"node"}],"type":"node"},"s with event handlers that dispatch on your ",{"attributes":{},"tag":"code","children":["Phase"],"type":"node"}," subtype."],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"h3","children":["Control flow"],"type":"node"},{"attributes":{},"tag":"p","children":["Inside callback handlers and ",{"attributes":{},"tag":"code","children":["step!"],"type":"node"}," implementations, you can throw ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FluxTraining@dev/ref/FluxTraining.CancelFittingException"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["CancelFittingException"],"type":"node"}],"type":"node"}," to stop the training and ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FluxTraining@dev/ref/FluxTraining.CancelEpochException"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["CancelEpochException"],"type":"node"}],"type":"node"}," and ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FluxTraining@dev/ref/FluxTraining.CancelStepException"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["CancelStepException"],"type":"node"}],"type":"node"}," to skip the current epoch or step."],"type":"node"}],"type":"node"}],"type":"node"}