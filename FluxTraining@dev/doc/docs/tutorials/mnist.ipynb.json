{"attributes":{"backlinks":[{"tag":"document","title":"Getting started","docid":"FluxTraining@dev/doc/docs/overview.md"},{"tag":"document","title":"Data iterators","docid":"FluxTraining@dev/doc/docs/background/dataiterator.md"},{"tag":"document","title":"FluxTraining.jl","docid":"FluxTraining@dev/doc/README.md"}],"path":"/home/runner/.julia/packages/FluxTraining/Kiia3/docs/tutorials/mnist.ipynb","title":"Training an image classifier"},"tag":"document","children":[{"attributes":{"nbformat":[4,4],"kernelspec":{"display_name":"Julia 1.7.3","language":"julia","name":"julia-1.7"},"language_info":{"file_extension":".jl","mimetype":"application/julia","name":"julia","version":"1.7.3"}},"tag":"jupyter","children":[{"attributes":{"id":null},"tag":"md","children":[{"attributes":{},"tag":"h1","children":["Training an image classifier"],"type":"node"}],"type":"node"},{"attributes":{"id":null},"tag":"md","children":[{"attributes":{},"tag":"p","children":["Let's put ",{"attributes":{},"tag":"em","children":["FluxTraining.jl"],"type":"node"}," to train a model on the MNIST dataset."],"type":"node"},{"attributes":{},"tag":"p","children":["MNIST is simple enough that we can focus on the part where ",{"attributes":{},"tag":"em","children":["FluxTraining.jl"],"type":"node"}," comes in, the training. If you want to see examples of using FluxTraining.jl on larger datasets, see the documentation of ",{"attributes":{"href":"https://github.com/FluxML/FastAI.jl","title":""},"tag":"a","children":["FastAI.jl"],"type":"node"},"."],"type":"node"}],"type":"node"},{"attributes":{"id":null},"tag":"md","children":[{"attributes":{},"tag":"h2","children":["Setup"],"type":"node"}],"type":"node"},{"attributes":{"id":null},"tag":"md","children":[{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"em","children":["If you want to run this tutorial yourself, you can find the notebook file ",{"attributes":{"href":"https://github.com/lorenzoh/FluxTraining.jl/blob/master/docs/tutorials/mnist.ipynb","title":""},"tag":"a","children":["here"],"type":"node"}],"type":"node"},"."],"type":"node"}],"type":"node"},{"attributes":{"id":null},"tag":"md","children":[{"attributes":{},"tag":"p","children":["To make data loading and batching a bit easier, we'll install an additional dependency:"],"type":"node"}],"type":"node"},{"attributes":{"id":null},"tag":"md","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"toplevel","children":[{"attributes":{},"tag":"using","children":[{"attributes":{},"tag":"using","children":["using"],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["Pkg"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Identifier","children":["Pkg"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":"Identifier","children":["add"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"vect","children":[{"attributes":{},"tag":"[","children":["["],"type":"node"},{"attributes":{},"tag":"string","children":[{"attributes":{},"tag":"\"","children":["\""],"type":"node"},{"attributes":{},"tag":"String","children":["MLUtils"],"type":"node"},{"attributes":{},"tag":"\"","children":["\""],"type":"node"}],"type":"node"},{"attributes":{},"tag":"]","children":["]"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":null},"tag":"md","children":[{"attributes":{},"tag":"p","children":["Now we can import everything we'll need."],"type":"node"}],"type":"node"},{"attributes":{"id":null,"execution_count":9},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"using","children":[{"attributes":{},"tag":":","children":[{"attributes":{},"tag":"using","children":["using"],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["MLUtils"],"type":"node"}],"type":"node"},{"attributes":{},"tag":":","children":[":"],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["splitobs"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["unsqueeze"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"using","children":[{"attributes":{},"tag":":","children":[{"attributes":{},"tag":"using","children":["using"],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["MLDatasets"],"type":"node"}],"type":"node"},{"attributes":{},"tag":":","children":[":"],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["MNIST"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"using","children":[{"attributes":{},"tag":"using","children":["using"],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["Flux"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"using","children":[{"attributes":{},"tag":":","children":[{"attributes":{},"tag":"using","children":["using"],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["Flux"],"type":"node"}],"type":"node"},{"attributes":{},"tag":":","children":[":"],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["onehotbatch"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"using","children":[{"attributes":{},"tag":":","children":[{"attributes":{},"tag":"using","children":["using"],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["Flux"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"Identifier","children":["Data"],"type":"node"}],"type":"node"},{"attributes":{},"tag":":","children":[":"],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["DataLoader"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"using","children":[{"attributes":{},"tag":"using","children":["using"],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["FluxTraining"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":null},"tag":"md","children":[{"attributes":{},"tag":"h2","children":["Overview"],"type":"node"}],"type":"node"},{"attributes":{"id":null},"tag":"md","children":[{"attributes":{},"tag":"p","children":["There are 4 pieces that you always need to construct and train a ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FluxTraining@dev/ref/FluxTraining.Learner"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["Learner"],"type":"node"}],"type":"node"},":"],"type":"node"},{"attributes":{},"tag":"ul","children":[{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":["a model"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":["data"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":["an optimizer; and"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":["a loss function"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":null},"tag":"md","children":[{"attributes":{},"tag":"h2","children":["Building a ",{"attributes":{},"tag":"code","children":["Learner"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":null},"tag":"md","children":[{"attributes":{},"tag":"p","children":["Let's look at the ",{"attributes":{},"tag":"strong","children":["data"],"type":"node"}," first."],"type":"node"},{"attributes":{},"tag":"p","children":[{"attributes":{},"tag":"em","children":["FluxTraining.jl"],"type":"node"}," is agnostic of the data source. The only requirements are:"],"type":"node"},{"attributes":{},"tag":"ul","children":[{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":["it is iterable and each iteration returns a tuple ",{"attributes":{},"tag":"code","children":["(xs, ys)"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":["the model can take in ",{"attributes":{},"tag":"code","children":["xs"],"type":"node"},", i.e. ",{"attributes":{},"tag":"code","children":["model(xs)"],"type":"node"}," works; and"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"li","children":[{"attributes":{},"tag":"p","children":["the loss function can take model outputs and ",{"attributes":{},"tag":"code","children":["ys"],"type":"node"},", i.e. ",{"attributes":{},"tag":"code","children":["lossfn(model(xs), ys)"],"type":"node"}," returns a scalar"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":null},"tag":"md","children":[{"attributes":{},"tag":"p","children":["Glossing over the details as it's not the focus of this tutorial, here's the code for getting a data iterator of the MNIST dataset. We use ",{"attributes":{},"tag":"code","children":["DataLoaders.DataLoader"],"type":"node"}," to create an iterator of batches from our dataset."],"type":"node"}],"type":"node"},{"attributes":{"id":null,"execution_count":10},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["data"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"ref","children":[{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["MNIST"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":":","children":[":"],"type":"node"},{"attributes":{},"tag":"Identifier","children":["train"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"[","children":["["],"type":"node"},{"attributes":{},"tag":":","children":[":"],"type":"node"},{"attributes":{},"tag":"]","children":["]"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"const","children":[{"attributes":{},"tag":"const","children":["const"],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["LABELS"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["0"],"type":"node"},{"attributes":{},"tag":":","children":[":"],"type":"node"},{"attributes":{},"tag":"Integer","children":["9"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"Comment","children":["# unsqueeze to reshape from (28, 28, numobs) to (28, 28, 1, numobs)"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"function","children":[{"attributes":{},"tag":"function","children":["function"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["preprocess"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["data"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["targets"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"block","children":[{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"return","children":[{"attributes":{},"tag":"return","children":["return"],"type":"node"},{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["unsqueeze"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["data"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["3"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["onehotbatch"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["targets"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["LABELS"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"end","children":["end"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"Comment","children":["# traindata and testdata contain both inputs (pixel values) and targets (correct labels)"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["traindata"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"ref","children":[{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["MNIST"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["Float32"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":":","children":[":"],"type":"node"},{"attributes":{},"tag":"Identifier","children":["train"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"[","children":["["],"type":"node"},{"attributes":{},"tag":":","children":[":"],"type":"node"},{"attributes":{},"tag":"]","children":["]"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"|>","children":["|>"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["preprocess"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["testdata"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"ref","children":[{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["MNIST"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["Float32"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":":","children":[":"],"type":"node"},{"attributes":{},"tag":"Identifier","children":["test"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"[","children":["["],"type":"node"},{"attributes":{},"tag":":","children":[":"],"type":"node"},{"attributes":{},"tag":"]","children":["]"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"|>","children":["|>"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["preprocess"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"toplevel","children":[{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"Comment","children":["# create iterators"],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"Identifier","children":["trainiter"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["testiter"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["DataLoader"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["traindata"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["batchsize"],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Integer","children":["128"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["DataLoader"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["testdata"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["batchsize"],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Integer","children":["256"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":";","children":[";"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":null},"tag":"md","children":[{"attributes":{},"tag":"p","children":["Next, let's create a simple ",{"attributes":{},"tag":"em","children":["Flux.jl"],"type":"node"}," ",{"attributes":{},"tag":"strong","children":["model"],"type":"node"}," that we'll train to classify the MNIST digits."],"type":"node"}],"type":"node"},{"attributes":{"id":null,"execution_count":11},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["model"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["Chain"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["Conv"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Integer","children":["3"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["3"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Integer","children":["1"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=>","children":["=>"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["16"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["relu"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["pad"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["1"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["stride"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["2"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["Conv"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Integer","children":["3"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["3"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Integer","children":["16"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=>","children":["=>"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["32"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["relu"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["pad"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["1"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["GlobalMeanPool"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Identifier","children":["Flux"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":"Identifier","children":["flatten"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n    "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":"Identifier","children":["Dense"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Integer","children":["32"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["10"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"coderesult","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"Chain(\n  Conv((3, 3), 1 =&gt; 16, relu, pad=1, stride=2),  <span class=\"sgr90\"># 160 parameters</span>\n  Conv((3, 3), 16 =&gt; 32, relu, pad=1),  <span class=\"sgr90\"># 4_640 parameters</span>\n  GlobalMeanPool(),\n  Flux.flatten,\n  Dense(32 =&gt; 10),                      <span class=\"sgr90\"># 330 parameters</span>\n) <span class=\"sgr90\">                  # Total: 6 arrays, </span>5_130 parameters, 20.867 KiB."},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":null},"tag":"md","children":[{"attributes":{},"tag":"p","children":["We'll use ",{"attributes":{},"tag":"em","children":["categorical cross entropy"],"type":"node"}," as a ",{"attributes":{},"tag":"strong","children":["loss function"],"type":"node"}," and ",{"attributes":{},"tag":"em","children":["ADAM"],"type":"node"}," as an ",{"attributes":{},"tag":"strong","children":["optimizer"],"type":"node"},"."],"type":"node"}],"type":"node"},{"attributes":{"id":null,"execution_count":12},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["lossfn"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":".","children":[{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Identifier","children":["Flux"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":"Identifier","children":["Losses"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":"Identifier","children":["logitcrossentropy"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"toplevel","children":[{"attributes":{},"tag":"NewlineWs","children":["\n"],"type":"node"},{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["optimizer"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Identifier","children":["Flux"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{},"tag":"Identifier","children":["ADAM"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":";","children":[";"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":null},"tag":"md","children":[{"attributes":{},"tag":"p","children":["Now we're ready to create a ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FluxTraining@dev/ref/FluxTraining.Learner"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["Learner"],"type":"node"}],"type":"node"},". At this point you can also add any callbacks, like ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FluxTraining@dev/ref/FluxTraining.ToGPU"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["ToGPU"],"type":"node"}],"type":"node"}," to run the training on your GPU if you have one available. Some callbacks are also ",{"attributes":{"href":"../callbacks/reference.md","title":"","document_id":"FluxTraining@dev/doc/docs/callbacks/reference.md"},"tag":"reference","children":["included by default"],"type":"node"},"."],"type":"node"},{"attributes":{},"tag":"p","children":["Since we're classifying digits, we also use the ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FluxTraining@dev/ref/FluxTraining.Metrics"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["Metrics"],"type":"node"}],"type":"node"}," callback to track the accuracy of the model's predictions:"],"type":"node"}],"type":"node"},{"attributes":{"id":null,"execution_count":13},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"=","children":[{"attributes":{},"tag":"Identifier","children":["learner"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FluxTraining@dev/ref/FluxTraining.Learner"},"tag":"reference","children":["Learner"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["model"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["lossfn"],"type":"node"},{"attributes":{},"tag":"parameters","children":[{"attributes":{},"tag":";","children":[";"],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"kw","children":[{"attributes":{},"tag":"Identifier","children":["callbacks"],"type":"node"},{"attributes":{},"tag":"=","children":["="],"type":"node"},{"attributes":{},"tag":"vect","children":[{"attributes":{},"tag":"[","children":["["],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FluxTraining@dev/ref/FluxTraining.ToGPU"},"tag":"reference","children":["ToGPU"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"call","children":[{"attributes":{"reftype":"symbol","document_id":"FluxTraining@dev/ref/FluxTraining.Metrics"},"tag":"reference","children":["Metrics"],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{"reftype":"symbol","document_id":"FluxTraining@dev/ref/FluxTraining.accuracy"},"tag":"reference","children":["accuracy"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"]","children":["]"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["optimizer"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"coderesult","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"Learner()"},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":null},"tag":"md","children":[{"attributes":{},"tag":"h2","children":["Training"],"type":"node"}],"type":"node"},{"attributes":{"id":null},"tag":"md","children":[{"attributes":{},"tag":"p","children":["With a ",{"attributes":{},"tag":"code","children":["Learner"],"type":"node"}," in place, training is as simple as calling ",{"attributes":{"reftype":"symbol","href":"#","title":"","document_id":"FluxTraining@dev/ref/FluxTraining.fit!"},"tag":"reference","children":[{"attributes":{},"tag":"code","children":["fit!"],"type":"node"}],"type":"node"},{"attributes":{},"tag":"code","children":["(learner, nepochs, dataiters)"],"type":"node"},"."],"type":"node"}],"type":"node"},{"attributes":{"id":null,"execution_count":14},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[{"attributes":{},"tag":"call","children":[{"attributes":{},"tag":".","children":[{"attributes":{},"tag":"Identifier","children":["FluxTraining"],"type":"node"},{"attributes":{},"tag":".","children":["."],"type":"node"},{"attributes":{},"tag":"quote","children":[{"attributes":{"reftype":"symbol","document_id":"FluxTraining@dev/ref/FluxTraining.fit!"},"tag":"reference","children":["fit!"],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["learner"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Integer","children":["10"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"tuple","children":[{"attributes":{},"tag":"(","children":["("],"type":"node"},{"attributes":{},"tag":"Identifier","children":["trainiter"],"type":"node"},{"attributes":{},"tag":",","children":[","],"type":"node"},{"attributes":{},"tag":"Whitespace","children":[" "],"type":"node"},{"attributes":{},"tag":"Identifier","children":["testiter"],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"},{"attributes":{},"tag":")","children":[")"],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{},"tag":"codeoutput","children":[{"attributes":{},"tag":"codeblock","children":[{"mimes":{"text/html":"Epoch 1 TrainingPhase() ...\n┌───────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├───────────────┼───────┼─────────┼──────────┤\n│ TrainingPhase │   1.0 │ 1.92511 │  0.30643 │\n└───────────────┴───────┴─────────┴──────────┘\nEpoch 1 ValidationPhase() ...\n┌─────────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├─────────────────┼───────┼─────────┼──────────┤\n│ ValidationPhase │   1.0 │ 1.56384 │    0.429 │\n└─────────────────┴───────┴─────────┴──────────┘\nEpoch 2 TrainingPhase() ...\n┌───────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├───────────────┼───────┼─────────┼──────────┤\n│ TrainingPhase │   2.0 │ 1.40887 │  0.53872 │\n└───────────────┴───────┴─────────┴──────────┘\nEpoch 2 ValidationPhase() ...\n┌─────────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├─────────────────┼───────┼─────────┼──────────┤\n│ ValidationPhase │   2.0 │ 1.25592 │  0.57578 │\n└─────────────────┴───────┴─────────┴──────────┘\nEpoch 3 TrainingPhase() ...\n┌───────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├───────────────┼───────┼─────────┼──────────┤\n│ TrainingPhase │   3.0 │ 1.17799 │  0.64023 │\n└───────────────┴───────┴─────────┴──────────┘\nEpoch 3 ValidationPhase() ...\n┌─────────────────┬───────┬────────┬──────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">   Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├─────────────────┼───────┼────────┼──────────┤\n│ ValidationPhase │   3.0 │ 1.0728 │  0.63809 │\n└─────────────────┴───────┴────────┴──────────┘\nEpoch 4 TrainingPhase() ...\n┌───────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├───────────────┼───────┼─────────┼──────────┤\n│ TrainingPhase │   4.0 │ 1.02755 │  0.69311 │\n└───────────────┴───────┴─────────┴──────────┘\nEpoch 4 ValidationPhase() ...\n┌─────────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├─────────────────┼───────┼─────────┼──────────┤\n│ ValidationPhase │   4.0 │ 0.95165 │  0.67871 │\n└─────────────────┴───────┴─────────┴──────────┘\nEpoch 5 TrainingPhase() ...\n┌───────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├───────────────┼───────┼─────────┼──────────┤\n│ TrainingPhase │   5.0 │ 0.91992 │  0.72615 │\n└───────────────┴───────┴─────────┴──────────┘\nEpoch 5 ValidationPhase() ...\n┌─────────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├─────────────────┼───────┼─────────┼──────────┤\n│ ValidationPhase │   5.0 │ 0.86318 │  0.70791 │\n└─────────────────┴───────┴─────────┴──────────┘\nEpoch 6 TrainingPhase() ...\n┌───────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├───────────────┼───────┼─────────┼──────────┤\n│ TrainingPhase │   6.0 │ 0.83481 │  0.75419 │\n└───────────────┴───────┴─────────┴──────────┘\nEpoch 6 ValidationPhase() ...\n┌─────────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├─────────────────┼───────┼─────────┼──────────┤\n│ ValidationPhase │   6.0 │ 0.79026 │  0.73604 │\n└─────────────────┴───────┴─────────┴──────────┘\nEpoch 7 TrainingPhase() ...\n┌───────────────┬───────┬────────┬──────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">   Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├───────────────┼───────┼────────┼──────────┤\n│ TrainingPhase │   7.0 │ 0.7636 │  0.77762 │\n└───────────────┴───────┴────────┴──────────┘\nEpoch 7 ValidationPhase() ...\n┌─────────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├─────────────────┼───────┼─────────┼──────────┤\n│ ValidationPhase │   7.0 │ 0.72974 │  0.75869 │\n└─────────────────┴───────┴─────────┴──────────┘\nEpoch 8 TrainingPhase() ...\n┌───────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├───────────────┼───────┼─────────┼──────────┤\n│ TrainingPhase │   8.0 │ 0.70309 │  0.79626 │\n└───────────────┴───────┴─────────┴──────────┘\nEpoch 8 ValidationPhase() ...\n┌─────────────────┬───────┬────────┬──────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">   Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├─────────────────┼───────┼────────┼──────────┤\n│ ValidationPhase │   8.0 │ 0.6784 │  0.77363 │\n└─────────────────┴───────┴────────┴──────────┘\nEpoch 9 TrainingPhase() ...\n┌───────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├───────────────┼───────┼─────────┼──────────┤\n│ TrainingPhase │   9.0 │ 0.65131 │  0.81166 │\n└───────────────┴───────┴─────────┴──────────┘\nEpoch 9 ValidationPhase() ...\n┌─────────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├─────────────────┼───────┼─────────┼──────────┤\n│ ValidationPhase │   9.0 │ 0.63317 │  0.79014 │\n└─────────────────┴───────┴─────────┴──────────┘\nEpoch 10 TrainingPhase() ...\n┌───────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">         Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├───────────────┼───────┼─────────┼──────────┤\n│ TrainingPhase │  10.0 │ 0.60669 │  0.82449 │\n└───────────────┴───────┴─────────┴──────────┘\nEpoch 10 ValidationPhase() ...\n┌─────────────────┬───────┬─────────┬──────────┐\n│<span class=\"sgr1\">           Phase </span>│<span class=\"sgr1\"> Epoch </span>│<span class=\"sgr1\">    Loss </span>│<span class=\"sgr1\"> Accuracy </span>│\n├─────────────────┼───────┼─────────┼──────────┤\n│ ValidationPhase │  10.0 │ 0.59359 │  0.80527 │\n└─────────────────┴───────┴─────────┴──────────┘\n"},"type":"leaf"}],"type":"node"}],"type":"node"}],"type":"node"},{"attributes":{"id":null,"execution_count":null},"tag":"codecell","children":[{"attributes":{},"tag":"codeinput","children":[{"attributes":{"lang":"julia"},"tag":"codeblock","children":[{"attributes":{},"tag":"julia","children":[],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}],"type":"node"}